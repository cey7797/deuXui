<?xml version="1.0" encoding="utf-8"?>
<FDL version="1.5">
  <TypeDefinition url="..\..\..\default_typedef.xml"/>
  <Form id="ac02020_purc_p01" classname="ac02020_purc_p01" left="0" top="0" width="1038" height="855" titletext="전표관리" onload="ac02020_purc_p01_onload">
    <Layouts>
      <Layout>
        <Div id="div_search" taborder="0" left="0" top="0" right="15" height="42" scrollbars="none" cssclass="search">
          <Layouts>
            <Layout>
              <Static id="Static00" taborder="73" text="회계연도" cssclass="search" left="20" top="10" width="48" height="22"/>
              <Static id="Static01" taborder="74" text="회계단위" cssclass="search" left="186" top="10" width="48" height="22"/>
              <Combo id="S_ACNT_UNT" taborder="75" innerdataset="ds_acntUntCmb" codecolumn="cd" datacolumn="nm" left="240" top="11" width="124" height="21" class="essential" autoskip="false" enable="false"/>
              <Static id="Static12" taborder="76" text="H9" cssclass="tipGuide" visible="false" left="117" top="2" width="30" height="9"/>
              <Static id="Static11" taborder="77" text="H9" cssclass="tipGuide" visible="false" left="117" top="32" width="30" height="9"/>
              <Static id="Static02" taborder="78" text="H9" cssclass="tipGuide" visible="false" left="311" top="2" width="30" height="9"/>
              <Static id="Static03" taborder="79" text="H9" cssclass="tipGuide" visible="false" left="311" top="32" width="30" height="9"/>
              <Spin id="S_ACNT_YY" taborder="80" value="0" onspin="div_search_S_ACNT_YY_onspin" left="74" top="11" width="100" height="21" enable="false"/>
              <Static id="Static06" taborder="81" text="부서" cssclass="search" left="380" top="10" width="24" height="22"/>
              <Combo id="S_VOU_ORG_ID" taborder="82" innerdataset="ds_cmb_vou_org_id" codecolumn="deptCd" datacolumn="deptNmKor" left="411" top="10" width="159" height="22" class="essential" autoskip="false" enable="false"/>
              <Static id="Static07" taborder="83" text="기안번호" cssclass="search" left="586" top="10" width="48" height="22"/>
              <Edit id="S_VOU_NO" taborder="94" inputtype="number" maxlength="12" left="640" top="11" width="124" height="21" style="border:1 solid #ccccccff ;" enable="false"/>
            </Layout>
          </Layouts>
        </Div>
        <Static id="Static11" taborder="1" text="H15" cssclass="tipGuide" visible="false" left="0" top="42" width="1023" height="15"/>
        <Static id="Static33" taborder="2" text="W&#13;&#10;15" cssclass="tipGuide" visible="false" left="1023" top="0" width="15" height="855"/>
        <Static id="Static03" taborder="4" text="전표목록" cssclass="page_stitle" left="0" top="58" width="220" height="20"/>
        <Button id="btn_new" taborder="5" text="추가" cssclass="new" top="57" right="362" width="60" height="22" tooltiptype="hover" tooltiptext="추가" userBtnAuth="S" onclick="btn_new_onclick" tabstop="false"/>
        <Button id="btn_del" taborder="6" text="삭제" cssclass="del" top="57" right="300" width="60" height="22" tooltiptype="hover" tooltiptext="삭제" userBtnAuth="S" onclick="btn_del_onclick" tabstop="false"/>
        <Button id="btn_save" taborder="7" text="저장" cssclass="save" top="57" right="238" width="60" height="22" tooltiptype="hover" tooltiptext="저장" userBtnAuth="S" onclick="btn_save_onclick" tabstop="false"/>
        <Static id="Static00" taborder="8" text="H5" cssclass="tipGuide" visible="false" left="0" top="79" width="1023" height="5"/>
        <Static id="Static10" taborder="9" cssclass="detail_title" top="53" right="15" width="215" height="30" style="color:#666666ff;align:left;"/>
        <Button id="btn_ProcCd" taborder="10" text="처리" onclick="btn_ProcCd_onclick" top="57" right="20" width="60" height="22" tooltiptype="hover" tooltiptext="처리" style="background:URL('theme://images/btn_WF_SearchN.png') stretch 4,0;color:white;font:bold 9 Dotum;" userBtnAuth="R" tabstop="false"/>
        <Combo id="C_STA_CD" taborder="11" innerdataset="ds_cmb_c_sta_cd" codecolumn="comCd" datacolumn="comCdNm" top="58" right="85" width="140" height="21" class="essential"/>
        <Grid id="grd_main" taborder="12" useinputpanel="false" left="0" top="84" right="15" height="187" autoenter="select" autofittype="col" binddataset="ds_main" onexpandup="grd_main_onexpandup">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="35" band="left"/>
                <Column size="20" band="left"/>
                <Column size="30" band="left"/>
                <Column size="132"/>
                <Column size="99"/>
                <Column size="193"/>
                <Column size="131"/>
                <Column size="135"/>
                <Column size="135"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="40"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox"/>
                <Cell col="2" text="순번"/>
                <Cell col="3" text="진행상태"/>
                <Cell col="4" text="전표번호"/>
                <Cell col="5" text="전표제목"/>
                <Cell col="6" text="전표적요"/>
                <Cell col="7" text="영수란"/>
                <Cell col="8" text="전자결재표시금액"/>
                <Cell col="9" text="계약일자"/>
                <Cell col="10" text="전표확정자"/>
                <Cell col="11" text="전표확정일"/>
              </Band>
              <Band id="body">
                <Cell displaytype="image" text="bind:rowStatus" expr="expr:rowStatus==2?&quot;URL('theme://images/ico_i.png')&quot;:rowStatus==4?&quot;URL('theme://images/ico_u.png')&quot;:rowStatus==8?&quot;URL('theme://images/ico_d.png')&quot;:&quot;&quot;"/>
                <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                <Cell col="2" text="expr:currow + 1"/>
                <Cell col="3" displaytype="combo" style="align:left;" text="bind:staCd" combodataset="ds_cmb_sta_cd" combocodecol="comCd" combodatacol="comCdNm"/>
                <Cell col="4" text="bind:slipNo" mask="@@@@@@@@-@@@@"/>
                <Cell col="5" edittype="expr:staCd =='32' || staCd =='41' ? 'normal' : 'none'" style="align:left middle;" text="bind:slipDesc" editautoselect="true" editdisplay="expr:staCd =='32' || staCd =='41' ? 'display' : 'edit'"/>
                <Cell col="6" edittype="expr:staCd =='32' || staCd =='41' ? 'textarea' : 'none'" style="align:left middle;" text="bind:jukyo" editautoselect="true" editdisplay="expr:staCd =='32' || staCd =='41' ? 'display' : 'edit'" expandshow="expr:staCd =='32' || staCd =='41' ? 'show' : 'hide'" expandimage="URL('theme://images\ico_expand.png')"/>
                <Cell col="7" displaytype="normal" edittype="expr:staCd =='32' || staCd =='41' ? 'textarea' : 'none'" style="align:left middle;" text="bind:sdVendorDesc" wordwrap="none" editimemode="hangul" editscrollbar="none" editautoselect="true" editdisplay="expr:staCd =='32' || staCd =='41' ? 'display' : 'edit'" expandshow="expr:staCd =='32' || staCd =='41' ? 'show' : 'hide'" expandimage="URL('theme://images\ico_expand.png')"/>
                <Cell col="8" displaytype="normal" edittype="expr:staCd =='32' || staCd =='41' ? 'masknumber' : 'none'" style="align:left middle;" text="bind:elecAmt" wordwrap="none" editimemode="hangul" editscrollbar="none" editautoselect="true" editdisplay="expr:staCd =='32' || staCd =='41' ? 'display' : 'edit'" expandshow="hide" expandimage="URL('theme://images\ico_expand.png')"/>
                <Cell col="9" displaytype="date" edittype="expr:staCd =='32' || staCd =='41' ? 'date' : 'none'" text="bind:promiseDt"/>
                <Cell col="10" text="bind:slipCfmUserNm"/>
                <Cell col="11" text="bind:slipCfmDt" mask="####-##-##"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static06" taborder="13" text="H5" cssclass="tipGuide" visible="false" left="930" top="287" width="93" height="5"/>
        <Static id="sta_main" taborder="14" text="총 &lt;b v='true'&gt;[0]건&lt;/b&gt;" usedecorate="true" cssclass="inquiry_icon" top="272" right="15" width="86" height="20" style="border:0 none #808080ff ;align:right middle;"/>
        <Static id="Static04" taborder="15" text="H5" cssclass="tipGuide" visible="false" left="930" top="271" width="93" height="5"/>
        <Static id="Static25" taborder="16" text="h15" visible="false" left="0" top="292" right="15" height="15" style="linespace:0;background:#fa9999ff;color:#000000ff;align:center;font:Dotum,8;opacity:60;"/>
        <Static id="Static01" taborder="17" text="전표상세목록" cssclass="page_stitle" left="0" top="308" width="220" height="20"/>
        <Static id="Static02" taborder="18" text="H5" cssclass="tipGuide" visible="false" left="0" top="329" width="1023" height="5"/>
        <Grid id="grd_det" taborder="19" useinputpanel="false" left="0" top="334" right="15" height="187" autoenter="select" autofittype="col" binddataset="ds_det">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="35" band="left"/>
                <Column size="30" band="left"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
                <Column size="100"/>
              </Columns>
              <Rows>
                <Row size="24" band="head"/>
                <Row size="24"/>
              </Rows>
              <Band id="head">
                <Cell/>
                <Cell col="1" text="순번"/>
                <Cell col="2" text="예산부서"/>
                <Cell col="3" text="사업명"/>
                <Cell col="4" text="목명"/>
                <Cell col="5" text="세목명"/>
                <Cell col="6" text="예산액"/>
              </Band>
              <Band id="body">
                <Cell displaytype="image" text="bind:rowStatus" expr="expr:rowStatus==2?&quot;URL('theme://images/ico_i.png')&quot;:rowStatus==4?&quot;URL('theme://images/ico_u.png')&quot;:rowStatus==8?&quot;URL('theme://images/ico_d.png')&quot;:&quot;&quot;"/>
                <Cell col="1" text="expr:currow + 1"/>
                <Cell col="2" style="align:left;" text="bind:budgOrgNm"/>
                <Cell col="3" style="align:left;" text="bind:bizNm"/>
                <Cell col="4" style="align:left;" text="bind:mokNm"/>
                <Cell col="5" style="align:left;" text="bind:acntNm"/>
                <Cell col="6" displaytype="number" style="align:right;" text="bind:slipAmt"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
        <Static id="Static05" taborder="20" text="H5" cssclass="tipGuide" visible="false" left="930" top="537" width="93" height="5"/>
        <Static id="sta_det" taborder="21" text="총 &lt;b v='true'&gt;[0]건&lt;/b&gt;" usedecorate="true" cssclass="inquiry_icon" top="522" right="15" width="86" height="20" style="border:0 none #808080ff ;align:right middle;"/>
        <Static id="Static07" taborder="22" text="H5" cssclass="tipGuide" visible="false" left="930" top="521" width="93" height="5"/>
        <Static id="Static08" taborder="23" text="h15" visible="false" left="0" top="542" right="15" height="15" style="linespace:0;background:#fa9999ff;color:#000000ff;align:center;font:Dotum,8;opacity:60;"/>
        <Tab id="tab01" taborder="34" left="0%" top="557" right="1.45%" height="298" tabindex="0" scrollbars="autoboth" onchanged="tab01_onchanged" canchange="tab01_canchange">
          <Tabpages>
            <Tabpage id="tabpage1" text="증빙내역(경비)">
              <Layouts>
                <Layout>
                  <Static id="Static12" taborder="0" text="H5" cssclass="tipGuide" visible="false" left="0" top="0" width="1023" height="5"/>
                  <Button id="btn_newSub" taborder="1" text="추가" onclick="btn_newSub_onclick" cssclass="new" top="5" right="124" width="60" height="22" tooltiptype="hover" tooltiptext="추가" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_delSub" taborder="2" text="삭제" onclick="btn_delSub_onclick" cssclass="del" top="5" right="62" width="60" height="22" tooltiptype="hover" tooltiptext="삭제" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_saveSub" taborder="3" text="저장" onclick="btn_saveSub_onclick" cssclass="save" top="5" right="0" width="60" height="22" tooltiptype="hover" tooltiptext="저장" userBtnAuth="S" tabstop="false"/>
                  <Static id="Static09" taborder="4" text="증빙목록" cssclass="page_stitle" left="0" top="6" width="220" height="20"/>
                  <Static id="Static00" taborder="5" text="H5" cssclass="tipGuide" visible="false" left="0" top="27" width="1023" height="5"/>
                  <Grid id="grd_sub" taborder="6" binddataset="ds_ac_bill_evdc" autoenter="select" autoupdatetype="comboselect" useinputpanel="false" oncellclick="tab01_tabpage1_grid_ac_bill_evdc_oncellclick" onexpandup="tab01_tabpage1_grid_ac_bill_evdc_onexpandup" left="0" top="32" right="0" bottom="28">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="35"/>
                          <Column size="20"/>
                          <Column size="30"/>
                          <Column size="120"/>
                          <Column size="60"/>
                          <Column size="150"/>
                          <Column size="80"/>
                          <Column size="100"/>
                          <Column size="13"/>
                          <Column size="100"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="90"/>
                          <Column size="80"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="28" band="head"/>
                          <Row size="28"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background2: ;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" style="background2: ;"/>
                          <Cell col="2" style="background2: ;" text="순번"/>
                          <Cell col="3" style="background2: ;" text="*증빙구분"/>
                          <Cell col="4" style="background2: ;" text="전자여부"/>
                          <Cell col="5" style="background2: ;" text="*증빙내역"/>
                          <Cell col="6" style="background2: ;" text="거래처ID"/>
                          <Cell col="7" colspan="2" style="background2: ;" text="*거래처명"/>
                          <Cell col="9" style="background2: ;" text="*발행일자"/>
                          <Cell col="10" style="background2: ;" text="*증빙금액"/>
                          <Cell col="11" style="background2: ;" text="예산반영금액"/>
                          <Cell col="12" style="background2: ;" text="공급가"/>
                          <Cell col="13" style="background2: ;" text="부가세"/>
                          <Cell col="14" style="background2: ;" text="매입공제여부"/>
                          <Cell col="15" style="background2: ;" text="승인번호"/>
                          <Cell col="16" style="background2: ;" text="첨부파일"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" text="bind:rowStatus" expr="expr:rowStatus==2?&quot;URL('theme://images/ico_i.png')&quot;:rowStatus==4?&quot;URL('theme://images/ico_u.png')&quot;:rowStatus==8?&quot;URL('theme://images/ico_d.png')&quot;:&quot;&quot;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" style="align:center;" text="expr:currow + 1"/>
                          <Cell col="3" displaytype="combo" edittype="expr:rowStatus==2 ? 'combo' : 'none'" style="align:center;" text="bind:evdcDiv" combodataset="ds_grid_evdc_div" combocodecol="comCd" combodatacol="comCdNm" combodisplay="expr:rowStatus==2 ? 'display' : 'edit'"/>
                          <Cell col="4" displaytype="expr:evdcDiv == 10 ? &quot;checkbox&quot; : evdcDiv == 20 ? &quot;checkbox&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;none&quot; : evdcDiv == 50 ? &quot;none&quot; : evdcDiv == 90 ? &quot;none&quot; : &quot;none&quot;" edittype="expr:evdcDiv == 10 ? &quot;checkbox&quot; : evdcDiv == 20 ? &quot;checkbox&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;none&quot; : evdcDiv == 50 ? &quot;none&quot; : evdcDiv == 90 ? &quot;none&quot; : &quot;none&quot;" text="bind:elecYn"/>
                          <Cell col="5" displaytype="text" edittype="expr:evdcDiv == 30 ? &quot;normal&quot; : &quot;text&quot;" style="align:left;" text="bind:evdcDesc" editlimit="0" editautoselect="true" editdisplay="expr:evdcDiv == 30 ? &quot;edit&quot; : &quot;display&quot;" expandshow="expr:evdcDiv == 30 ? &quot;show&quot; : &quot;hide&quot;" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="6" displaytype="decoratetext" style="align:center;" text="bind:vendId" mask="###-##-#####"/>
                          <Cell col="7" displaytype="expr:evdcDiv == 10 ? &quot;normal&quot; : evdcDiv == 20 ? &quot;normal&quot; : evdcDiv == 30 ? &quot;text&quot; : evdcDiv == 40 ? &quot;text&quot; : evdcDiv == 50 ? &quot;text&quot; : evdcDiv == 90 ? &quot;text&quot; : &quot;normal&quot;" edittype="expr:evdcDiv == 10 ? &quot;none&quot; : evdcDiv == 20 ? &quot;none&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;text&quot; : evdcDiv == 50 ? &quot;text&quot; : evdcDiv == 90 ? &quot;text&quot; : &quot;none&quot;" style="align:left;" text="bind:vendNm" editlimit="0" editdisplay="expr:evdcDiv == 10 ? &quot;edit&quot; : evdcDiv == 20 ? &quot;edit&quot; : evdcDiv == 30 ? &quot;edit&quot; : evdcDiv == 40 ? &quot;display&quot; : evdcDiv == 50 ? &quot;display&quot; : evdcDiv == 90 ? &quot;display&quot; : &quot;edit&quot;"/>
                          <Cell col="8" edittype="expr:evdcDiv == 30 ? &quot;none&quot; : &quot;expand&quot;" expandshow="expr:evdcDiv == 30 ? &quot;hide&quot; : &quot;show&quot;" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="9" displaytype="date" edittype="expr:evdcDiv == 30 ? &quot;none&quot; : &quot;date&quot;" text="bind:issDt" calendardisplay="expr:evdcDiv == 30 ? &quot;edit&quot; : &quot;display&quot;" calendardisplaynulltype="nulltext"/>
                          <Cell col="10" displaytype="number" edittype="expr:evdcDiv == 30 ? &quot;none&quot; : &quot;masknumber&quot;" editfilter="integer" style="align:right;" text="bind:evdcAmt" mask="###,###,###,##0" editlimit="12" editautoselect="true" editdisplay="expr:evdcDiv == 30 ? &quot;edit&quot; : &quot;display&quot;" editlimitbymask="both"/>
                          <Cell col="11" displaytype="number" edittype="expr:evdcDiv == 30 ? &quot;none&quot; : &quot;masknumber&quot;" editfilter="integer" style="align:right;" text="bind:budgAmt" mask="###,###,###,##0" editlimit="12" editautoselect="true" editdisplay="expr:evdcDiv == 30 ? &quot;edit&quot; : &quot;display&quot;" editlimitbymask="both"/>
                          <Cell col="12" displaytype="number" edittype="expr:evdcDiv == 10 ? &quot;masknumber&quot; : evdcDiv == 20 ? &quot;none&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;none&quot; : evdcDiv == 50 ? &quot;none&quot; : evdcDiv == 90 ? &quot;none&quot; : &quot;none&quot;" editfilter="integer" style="align:right;" text="bind:splyAmt" mask="###,###,###,##0" editlimit="12" editautoselect="true" editdisplay="expr:evdcDiv == 10 ? &quot;display&quot; : evdcDiv == 20 ? &quot;edit&quot; : evdcDiv == 30 ? &quot;edit&quot; : evdcDiv == 40 ? &quot;edit&quot; : evdcDiv == 50 ? &quot;edit&quot; : evdcDiv == 90 ? &quot;edit&quot; : &quot;edit&quot;" editlimitbymask="both"/>
                          <Cell col="13" displaytype="number" editfilter="integer" style="align:right;" text="bind:vat" mask="###,###,###,##0" editlimit="12" editautoselect="true" editlimitbymask="both"/>
                          <Cell col="14" displaytype="expr:evdcDiv == 10 ? &quot;checkbox&quot; : evdcDiv == 20 ? &quot;none&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;none&quot; : evdcDiv == 50 ? &quot;none&quot; : evdcDiv == 90 ? &quot;none&quot; : &quot;none&quot;" edittype="expr:evdcDiv == 10 ? &quot;checkbox&quot; : evdcDiv == 20 ? &quot;none&quot; : evdcDiv == 30 ? &quot;none&quot; : evdcDiv == 40 ? &quot;none&quot; : evdcDiv == 50 ? &quot;none&quot; : evdcDiv == 90 ? &quot;none&quot; : &quot;none&quot;" text="bind:deductYn"/>
                          <Cell col="15" text="bind:approNo"/>
                          <Cell col="16" displaytype="normal" edittype="expand" text="bind:orgFileNm" expandshow="show" expandimage="URL('theme://images\ico_expand.png')"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(evdcAmt)')"/>
                          <Cell col="11" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(evdcAmt)')"/>
                          <Cell col="12" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(splyAmt)')"/>
                          <Cell col="13" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(vat)')"/>
                          <Cell col="14"/>
                          <Cell col="15"/>
                          <Cell col="16"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static14" taborder="7" text="H5" cssclass="tipGuide" visible="false" left="930" top="239" width="93" height="5"/>
                  <Static id="sta_sub" taborder="8" text="총 &lt;b v='true'&gt;[0]건&lt;/b&gt;" usedecorate="true" cssclass="inquiry_icon" top="240" right="0" width="86" height="20" style="border:0 none #808080ff ;align:right middle;"/>
                  <Static id="Static13" taborder="9" text="H5" cssclass="tipGuide" visible="false" left="930" top="255" width="93" height="5"/>
                  <Static id="Static01" taborder="10" text="H5" cssclass="tipGuide" visible="false" left="872" top="260" width="151" height="7"/>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage2" text="증빙내역(인건비)">
              <Layouts>
                <Layout>
                  <Static id="Static12" taborder="0" text="H5" cssclass="tipGuide" visible="false" left="0" top="0" width="1023" height="5"/>
                  <Static id="Static09" taborder="1" text="원천목록" cssclass="page_stitle" left="0" top="6" width="220" height="20"/>
                  <Static id="Static00" taborder="2" text="H5" cssclass="tipGuide" visible="false" left="0" top="27" width="1023" height="5"/>
                  <Button id="btn_tab02_New" taborder="3" text="추가" onclick="tab01_tabpage2_btn_tab02_New_onclick" cssclass="new" top="5" right="124" width="60" height="22" tooltiptype="hover" tooltiptext="추가" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_tab02_Del" taborder="4" text="삭제" onclick="tab01_tabpage2_btn_tab02_Del_onclick" cssclass="del" top="5" right="62" width="60" height="22" tooltiptype="hover" tooltiptext="삭제" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_tab02_Save" taborder="5" text="저장" onclick="tab01_tabpage2_btn_tab02_Save_onclick" cssclass="save" top="5" right="0" width="60" height="22" tooltiptype="hover" tooltiptext="저장" userBtnAuth="S" tabstop="false"/>
                  <Static id="Static04" taborder="7" text="H5" cssclass="tipGuide" visible="false" left="945" top="342" width="93" height="5"/>
                  <Static id="Static06" taborder="9" text="H5" cssclass="tipGuide" visible="false" left="945" top="358" width="93" height="5"/>
                  <Static id="Static01" taborder="10" text="H5" cssclass="tipGuide" visible="false" left="937" top="342" width="93" height="5"/>
                  <Static id="ds_ac_inc_evdc_cnt" taborder="11" text="총 &lt;b v='true'&gt;[0]건&lt;/b&gt;" usedecorate="true" cssclass="inquiry_icon" right="0" bottom="7" width="86" height="20" style="border:0 none #808080ff ;align:right middle;"/>
                  <Static id="Static02" taborder="12" text="H5" cssclass="tipGuide" visible="false" left="937" top="358" width="93" height="5"/>
                  <Static id="Static05" taborder="13" text="H5" cssclass="tipGuide" visible="false" left="930" top="255" width="93" height="5"/>
                  <Static id="Static07" taborder="14" text="H5" cssclass="tipGuide" visible="false" left="930" top="239" width="93" height="5"/>
                  <Static id="Static03" taborder="15" text="H5" cssclass="tipGuide" visible="false" left="792" top="260" width="151" height="7"/>
                  <Grid id="grid_ac_inc_evdc" taborder="16" binddataset="ds_ac_inc_evdc" autoenter="select" autoupdatetype="comboselect" useinputpanel="false" oncellclick="tab01_tabpage2_grid_ac_inc_evdc_oncellclick" onexpandup="tab01_tabpage2_grid_ac_inc_evdc_onexpandup" left="0" top="31" right="0" bottom="29">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="35"/>
                          <Column size="20"/>
                          <Column size="30"/>
                          <Column size="100"/>
                          <Column size="150"/>
                          <Column size="85"/>
                          <Column size="90"/>
                          <Column size="13"/>
                          <Column size="90"/>
                          <Column size="110"/>
                          <Column size="110"/>
                          <Column size="140"/>
                          <Column size="100"/>
                          <Column size="100"/>
                          <Column size="13"/>
                          <Column size="80"/>
                          <Column size="13"/>
                          <Column size="250"/>
                          <Column size="350"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="140"/>
                          <Column size="50"/>
                          <Column size="18"/>
                          <Column size="200"/>
                        </Columns>
                        <Rows>
                          <Row size="28" band="head"/>
                          <Row size="28"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background2: ;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" style="background2: ;"/>
                          <Cell col="2" style="background2: ;" text="순번"/>
                          <Cell col="3" style="background2: ;" text="*소득구분"/>
                          <Cell col="4" style="background2: ;" text="*증빙내역"/>
                          <Cell col="5" style="background2: ;" text="신고대상자ID"/>
                          <Cell col="6" colspan="2" style="background2: ;" text="*신고대상자명"/>
                          <Cell col="8" style="background2: ;" text="내외국인구분"/>
                          <Cell col="9" style="background2: ;" text="*주민등록번호"/>
                          <Cell col="10" style="background2: ;" text="외국인번호"/>
                          <Cell col="11" style="background2: ;" text="*증빙금액"/>
                          <Cell col="12" style="background2: ;" text="거주구분"/>
                          <Cell col="13" colspan="2" style="background2: ;" text="거주국가"/>
                          <Cell col="15" colspan="2" style="background2: ;" text="우편번호"/>
                          <Cell col="17" style="background2: ;" text="주소"/>
                          <Cell col="18" style="background2: ;" text="상세주소"/>
                          <Cell col="19" style="background2: ;" text="필요경비"/>
                          <Cell col="20" style="background2: ;" text="소득액"/>
                          <Cell col="21" style="background2: ;" text="소득세"/>
                          <Cell col="22" style="background2: ;" text="주민세"/>
                          <Cell col="23" colspan="2" style="background2: ;" text="소득세율"/>
                          <Cell col="25" style="background2: ;" text="첨부파일"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" text="bind:rowStatus" expr="expr:rowStatus==2?&quot;URL('theme://images/ico_i.png')&quot;:rowStatus==4?&quot;URL('theme://images/ico_u.png')&quot;:rowStatus==8?&quot;URL('theme://images/ico_d.png')&quot;:&quot;&quot;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" style="align:center;" text="expr:currow + 1"/>
                          <Cell col="3" displaytype="combo" edittype="expr:rowStatus==2 ? 'combo' : 'none'" style="align:center;" text="bind:incDiv" combodataset="ds_grid_inc_div" combocodecol="comCd" combodatacol="comCdNm" combodisplay="expr:rowStatus==2 ? 'display' : 'edit'"/>
                          <Cell col="4" displaytype="text" edittype="text" style="align:left;" text="bind:evdcDesc" editlimit="0" editdisplay="display"/>
                          <Cell col="5" style="align:center;" text="bind:reptUserId"/>
                          <Cell col="6" displaytype="text" edittype="text" style="align:center;" text="bind:reptUserNm" editlimit="0" editdisplay="display"/>
                          <Cell col="7" edittype="expand" expandshow="show" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="8" displaytype="combo" edittype="combo" style="align:center;" text="bind:foreignYn" editlimit="0" editdisplay="display" combodataset="ds_foreign" combocodecol="code" combodatacol="name" combodisplay="display"/>
                          <Cell col="9" displaytype="normal" edittype="expr:incDiv == 10 ? &quot;none&quot; : &quot;mask&quot;" editfilter="integer" style="align:center;" text="bind:resNo" mask="expr:incDiv == 10 ? &quot;######-#{######}&quot; : &quot;######-#######&quot;" editlimit="13" editdisplay="expr:incDiv == 10 ? &quot;edit&quot; : &quot;display&quot;" editlimitbymask="decimal"/>
                          <Cell col="10" displaytype="normal" edittype="expr:foreignYn == 1 ? &quot;normal&quot; : &quot;none&quot;" editfilter="none" style="align:center;" text="bind:foreignNo" editlimit="13" editdisplay="expr:foreignYn == 1 ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="decimal"/>
                          <Cell col="11" displaytype="number" edittype="masknumber" editfilter="integer" style="align:right;" text="bind:evdcAmt" mask="###,###,###,##0" editlimit="12" editdisplay="display" editlimitbymask="both"/>
                          <Cell col="12" displaytype="combo" edittype="expr:incDiv == 10 ? &quot;none&quot; : incDiv == 20 ? &quot;combo&quot; : incDiv == 30 ? &quot;combo&quot; : incDiv == 40 ? &quot;combo&quot; : &quot;none&quot;" style="align:center;" text="bind:resiDiv" combodataset="ds_grid_resi_div" combocodecol="comCd" combodatacol="comCdNm" combodisplay="expr:incDiv == 10 ? &quot;edit&quot; : incDiv == 20 ? &quot;display&quot; : incDiv == 30 ? &quot;display&quot; : incDiv == 40 ? &quot;display&quot; : &quot;edit&quot;"/>
                          <Cell col="13" displaytype="combo" style="align:center;" text="bind:resiCnty" combodataset="ds_grid_resi_cnty" combocodecol="comCd" combodatacol="comCdNm"/>
                          <Cell col="14" edittype="expr:incDiv == 10 ? &quot;none&quot; : incDiv == 20 ? &quot;expand&quot; : incDiv == 30 ? &quot;expand&quot; : incDiv == 40 ? &quot;expand&quot; : &quot;none&quot;" expandshow="expr:incDiv == 10 ? &quot;hide&quot; : incDiv == 20 ? &quot;show&quot; : incDiv == 30 ? &quot;show&quot; : incDiv == 40 ? &quot;show&quot; : &quot;hide&quot;" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="15" displaytype="normal" style="align:center;" text="bind:zipNo"/>
                          <Cell col="16" edittype="expand" expandshow="show" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="17" style="align:left;" text="bind:addr"/>
                          <Cell col="18" displaytype="text" edittype="text" style="align:left;" text="bind:addrDet" editlimit="0" editdisplay="display"/>
                          <Cell col="19" displaytype="number" edittype="expr:incDiv == 10 ? &quot;none&quot; : incDiv == 20 ? &quot;none&quot; : incDiv == 30 ? &quot;none&quot; : incDiv == 40 ? &quot;none&quot; : &quot;none&quot;" editfilter="integer" style="align:right;" text="bind:needExp" mask="###,###,###,##0" editlimit="12" editdisplay="expr:incDiv == 10 ? &quot;edit&quot; : incDiv == 20 ? &quot;edit&quot; : incDiv == 30 ? &quot;edit&quot; : incDiv == 40 ? &quot;edit&quot; : &quot;edit&quot;" editlimitbymask="both"/>
                          <Cell col="20" displaytype="number" editfilter="integer" style="align:right;" text="bind:incAmt" mask="###,###,###,##0" maskchar="_" editlimit="12" editdisplay="edit" editlimitbymask="both"/>
                          <Cell col="21" displaytype="number" edittype="expr:incDiv == 10 ? &quot;masknumber&quot; : incDiv == 20 ? resiDiv==20 ? &quot;masknumber&quot; : &quot;none&quot; : incDiv == 30 ? &quot;none&quot; : incDiv == 40 ? &quot;masknumber&quot; : &quot;none&quot;" editfilter="integer" style="align:right;" text="bind:incTax" mask="###,###,###,##0" editlimit="12" editdisplay="expr:incDiv == 10 ? &quot;display&quot; : incDiv == 20 ? resiDiv ==20?&quot;display&quot; : &quot;edit&quot; : incDiv == 30 ? &quot;edit&quot; : incDiv == 40 ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="both"/>
                          <Cell col="22" displaytype="number" edittype="expr:incDiv == 10 ? &quot;masknumber&quot; : incDiv == 20 ? resiDiv==20 ? &quot;masknumber&quot; : &quot;none&quot; : incDiv == 30 ? &quot;none&quot; : incDiv == 40 ? &quot;masknumber&quot; : &quot;none&quot;" editfilter="integer" style="align:right;" text="bind:resTax" mask="###,###,###,##0" editlimit="12" editdisplay="expr:incDiv == 10 ? &quot;display&quot; : incDiv == 20 ? resiDiv ==20?&quot;display&quot; : &quot;edit&quot; : incDiv == 30 ? &quot;edit&quot; : incDiv == 40 ? &quot;display&quot; : &quot;edit&quot;" editlimitbymask="both"/>
                          <Cell col="23" displaytype="number" editfilter="integer" style="align:right;" text="bind:incTaxRt" mask="expr:incDiv == 10 ? &quot;&quot; : incDiv == 20 ? &quot;#0.0#&quot; : incDiv == 30 ? &quot;&quot; : incDiv == 40 ? &quot;&quot; : &quot;&quot;" editlimit="2"/>
                          <Cell col="24" text="expr:incDiv == 10 ? &quot;&quot; : incDiv == 20 ? &quot;%&quot; : incDiv == 30 ? &quot;&quot; : incDiv == 40 ? &quot;&quot; : &quot;&quot;"/>
                          <Cell col="25" edittype="expand" text="bind:orgFileNm" expandshow="show" expandimage="URL('theme://images\ico_expand.png')"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10"/>
                          <Cell col="11" displaytype="number" style="align:right;background:white;background2:whitesmoke;" expr="expr:dataset.getSum('nexacro.toNumber(evdcAmt)')" mask="###,###,###,##0"/>
                          <Cell col="12"/>
                          <Cell col="13"/>
                          <Cell col="14"/>
                          <Cell col="15"/>
                          <Cell col="16"/>
                          <Cell col="17"/>
                          <Cell col="18"/>
                          <Cell col="19" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(needExp)')" mask="###,###,###,##0"/>
                          <Cell col="20" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(incAmt)')" mask="###,###,###,##0"/>
                          <Cell col="21" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(incTax)')" mask="###,###,###,##0"/>
                          <Cell col="22" displaytype="number" style="align:right;background:white;background2:white;" expr="expr:dataset.getSum('nexacro.toNumber(resTax)')" mask="###,###,###,##0"/>
                          <Cell col="23"/>
                          <Cell col="24"/>
                          <Cell col="25"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                </Layout>
              </Layouts>
            </Tabpage>
            <Tabpage id="tabpage3" text="계좌내역">
              <Layouts>
                <Layout>
                  <Static id="Static12" taborder="0" text="H5" cssclass="tipGuide" visible="false" left="0" top="0" width="1023" height="5"/>
                  <Static id="Static09" taborder="1" text="원천목록" cssclass="page_stitle" left="0" top="6" width="220" height="20"/>
                  <Static id="Static00" taborder="2" text="H5" cssclass="tipGuide" visible="false" left="0" top="27" width="1023" height="5"/>
                  <Button id="btn_tab03_New" taborder="3" text="추가" onclick="tab01_tabpage3_btn_tab03_New_onclick" cssclass="new" top="5" right="124" width="60" height="22" tooltiptype="hover" tooltiptext="추가" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_tab03_Del" taborder="4" text="삭제" onclick="tab01_tabpage3_btn_tab03_Del_onclick" cssclass="del" top="5" right="62" width="60" height="22" tooltiptype="hover" tooltiptext="삭제" userBtnAuth="S" tabstop="false"/>
                  <Button id="btn_tab03_Save" taborder="5" text="저장" onclick="tab01_tabpage3_btn_tab03_Save_onclick" cssclass="save" top="5" right="0" width="60" height="22" tooltiptype="hover" tooltiptext="저장" userBtnAuth="S" tabstop="false"/>
                  <Grid id="grid_ac_pymt" taborder="6" binddataset="ds_ac_pymt" autoenter="select" autoupdatetype="comboselect" useinputpanel="false" oncellclick="tab01_tabpage3_grid_ac_pymt_oncellclick" onexpandup="tab01_tabpage3_grid_ac_pymt_onexpandup" left="0" top="32" right="0" bottom="28">
                    <Formats>
                      <Format id="default">
                        <Columns>
                          <Column size="35"/>
                          <Column size="20"/>
                          <Column size="30"/>
                          <Column size="80"/>
                          <Column size="110"/>
                          <Column size="120"/>
                          <Column size="13"/>
                          <Column size="150"/>
                          <Column size="150"/>
                          <Column size="13"/>
                          <Column size="140"/>
                          <Column size="180"/>
                        </Columns>
                        <Rows>
                          <Row size="28" band="head"/>
                          <Row size="28"/>
                          <Row size="24" band="summ"/>
                        </Rows>
                        <Band id="head">
                          <Cell style="background2: ;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" style="background2: ;"/>
                          <Cell col="2" style="background2: ;" text="순번"/>
                          <Cell col="3" text="지급구분"/>
                          <Cell col="4" text="*계좌구분"/>
                          <Cell col="5" colspan="2" style="background2: ;" text="*은행코드"/>
                          <Cell col="7" style="background2: ;" text="*계좌번호"/>
                          <Cell col="8" colspan="2" style="background2: ;" text="*예금주"/>
                          <Cell col="10" style="background2: ;" text="*지급금액"/>
                          <Cell col="11" text="입금메시지"/>
                        </Band>
                        <Band id="body">
                          <Cell displaytype="image" text="bind:rowStatus" expr="expr:rowStatus==2?&quot;URL('theme://images/ico_i.png')&quot;:rowStatus==4?&quot;URL('theme://images/ico_u.png')&quot;:rowStatus==8?&quot;URL('theme://images/ico_d.png')&quot;:&quot;&quot;"/>
                          <Cell col="1" displaytype="checkbox" edittype="checkbox" text="bind:chk"/>
                          <Cell col="2" style="align:center;" text="expr:currow + 1"/>
                          <Cell col="3" displaytype="combo" edittype="expr:rowStatus==2 ? 'combo' : 'none'" text="bind:pymtDiv" combodataset="ds_pymtDiv" combocodecol="comCd" combodatacol="comCdNm"/>
                          <Cell col="4" displaytype="combo" edittype="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'combo' : 'none'" style="align:center;" text="bind:bacctDiv" combodataset="ds_grid_bacct_div" combocodecol="comCd" combodatacol="comCdNm" combodisplay="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'display' : 'edit'"/>
                          <Cell col="5" displaytype="combo" style="align:center;" text="bind:bankCd" combodataset="ds_grid_bank_cd" combocodecol="comCd" combodatacol="comCdNm"/>
                          <Cell col="6" edittype="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'expand' : 'none'" expandshow="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'show' : 'hide'" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="7" displaytype="normal" edittype="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'normal' : 'none'" editfilter="integer" style="align:left;" text="bind:acntNo" editlimit="20" editdisplay="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'display' : 'edit'" editlimitbymask="both"/>
                          <Cell col="8" displaytype="text" edittype="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'text' : 'none'" style="align:center;" text="bind:deposr" editlimit="100" editdisplay="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'display' : 'edit'" editlimitbymask="both"/>
                          <Cell col="9" edittype="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'expand' : 'none'" expandshow="expr:rowStatus==2 &amp;&amp; pymtDiv == 10 ? 'show' : 'hide'" expandimage="URL('theme://images\ico_expand.png')"/>
                          <Cell col="10" displaytype="number" edittype="masknumber" editfilter="integer" style="align:right;" text="bind:pymtAmt" mask="###,###,###,##0" editlimit="12" editdisplay="display" editlimitbymask="both"/>
                          <Cell col="11" edittype="expr:pymtDiv == 10 ? 'normal' : 'none'" text="bind:pymtMsg"/>
                        </Band>
                        <Band id="summary">
                          <Cell/>
                          <Cell col="1"/>
                          <Cell col="2"/>
                          <Cell col="3"/>
                          <Cell col="4"/>
                          <Cell col="5"/>
                          <Cell col="6"/>
                          <Cell col="7"/>
                          <Cell col="8"/>
                          <Cell col="9"/>
                          <Cell col="10" displaytype="number" style="align:right;background:white;background2:whitesmoke;" expr="expr:dataset.getSum('nexacro.toNumber(pymtAmt)')"/>
                          <Cell col="11"/>
                        </Band>
                      </Format>
                    </Formats>
                  </Grid>
                  <Static id="Static04" taborder="7" text="H5" cssclass="tipGuide" visible="false" left="929" top="239" width="93" height="5"/>
                  <Static id="ds_ac_pymt_cnt" taborder="8" text="총 &lt;b v='true'&gt;[0]건&lt;/b&gt;" usedecorate="true" cssclass="inquiry_icon" right="0" bottom="7" width="86" height="20" style="border:0 none #808080ff ;align:right middle;"/>
                  <Static id="Static06" taborder="9" text="H5" cssclass="tipGuide" visible="false" left="929" top="255" width="93" height="5"/>
                  <Static id="Static03" taborder="10" text="H5" cssclass="tipGuide" visible="false" left="792" top="260" width="151" height="7"/>
                </Layout>
              </Layouts>
            </Tabpage>
          </Tabpages>
        </Tab>
        <Button id="btn_refresh" taborder="35" top="57" right="600" width="60" height="22" tooltiptype="hover" userBtnAuth="S" cssclass="search" style="image:URL('theme://images/btn_WF_commonResetD.png');align:center middle;" onclick="btn_refresh_onclick" tooltiptext="화면을 갱신합니다." tabstop="false" visible="false"/>
        <Button id="btn_elecSearch" taborder="36" tabstop="false" text="결의서보기" cssclass="btn_WF_Common" top="57" right="424" height="22" visible="false" onclick="btn_elecSearch_onclick" width="73"/>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_cmd_acnt_yy"/>
      <Dataset id="ds_acntUntCmb"/>
      <Dataset id="ds_cmb_sta_cd"/>
      <Dataset id="ds_grid_dept"/>
      <Dataset id="ds_cmb_c_sta_cd">
        <ColumnInfo>
          <Column id="comCd" type="STRING" size="256"/>
          <Column id="comCdNm" type="STRING" size="256"/>
          <Column id="procCd" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="comCd">32</Col>
            <Col id="comCdNm">결의접수</Col>
            <Col id="procCd">Y</Col>
          </Row>
          <Row>
            <Col id="comCd">32</Col>
            <Col id="comCdNm">접수반려</Col>
            <Col id="procCd">N</Col>
          </Row>
          <Row>
            <Col id="comCdNm">회계전자결재신청</Col>
            <Col id="procCd">E</Col>
            <Col id="comCd">41</Col>
          </Row>
          <Row>
            <Col id="comCd">41</Col>
            <Col id="comCdNm">결의접수취소</Col>
            <Col id="procCd">C</Col>
          </Row>
          <Row>
            <Col id="comCdNm">결의반려취소</Col>
            <Col id="procCd">C</Col>
            <Col id="comCd">42</Col>
          </Row>
          <Row>
            <Col id="comCd">61</Col>
            <Col id="comCdNm"/>
            <Col id="procCd"/>
          </Row>
          <Row>
            <Col id="comCd">62</Col>
            <Col id="comCdNm">회계전자결재신청</Col>
            <Col id="procCd">E</Col>
          </Row>
          <Row>
            <Col id="comCd">62</Col>
            <Col id="comCdNm">결의접수취소</Col>
            <Col id="procCd">C</Col>
          </Row>
          <Row>
            <Col id="comCd">63</Col>
            <Col id="comCdNm"/>
            <Col id="procCd"/>
          </Row>
        </Rows>
      </Dataset>
      <Dataset id="ds_elecInput">
        <ColumnInfo>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="aplyOrgId" type="STRING" size="256"/>
          <Column id="chgSeq" type="STRING" size="256"/>
          <Column id="id" type="STRING" size="256"/>
          <Column id="formId" type="STRING" size="256"/>
          <Column id="title" type="STRING" size="256"/>
          <Column id="subjId" type="STRING" size="256"/>
          <Column id="subtitle" type="STRING" size="256"/>
          <Column id="body" type="STRING" size="256"/>
          <Column id="approvalDiv" type="STRING" size="256"/>
          <Column id="approvalUserid" type="STRING" size="256"/>
          <Column id="approvalDt" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
          <Column id="updDt" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="vouNo" type="STRING" size="256"/>
          <Column id="strElecId" type="STRING" size="256"/>
          <Column id="strAcntYy" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="procCd" type="STRING" size="256"/>
          <Column id="userIp" type="STRING" size="256"/>
          <Column id="userPgm" type="STRING" size="256"/>
          <Column id="cfmDt" type="STRING" size="256"/>
          <Column id="vouNoElec" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
          <Column id="slipNoDisp" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_elec"/>
      <Dataset id="ds_P_AC_STA_CD_PROC_result"/>
      <Dataset id="ds_P_AC_STA_CD_PROC">
        <ColumnInfo>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="vouNo" type="STRING" size="256"/>
          <Column id="msg" type="STRING" size="256"/>
          <Column id="procCd" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
          <Column id="userIp" type="STRING" size="256"/>
          <Column id="userPgm" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_cmb_sta_cd_grd"/>
      <Dataset id="ds_cmb_vou_org_id"/>
      <Dataset id="ds_main" onrowposchanged="ds_main_onrowposchanged"/>
      <Dataset id="ds_det" onrowposchanged="ds_det_onrowposchanged">
        <ColumnInfo>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
          <Column id="slipSeq" type="STRING" size="256"/>
          <Column id="abstr" type="STRING" size="256"/>
          <Column id="drcrCd" type="STRING" size="256"/>
          <Column id="budgOrgId" type="STRING" size="256"/>
          <Column id="budgOrgNm" type="STRING" size="256"/>
          <Column id="bizCd" type="STRING" size="256"/>
          <Column id="bizNm" type="STRING" size="256"/>
          <Column id="acntCd" type="STRING" size="256"/>
          <Column id="mokNm" type="STRING" size="256"/>
          <Column id="acntNm" type="STRING" size="256"/>
          <Column id="fincCd" type="STRING" size="256"/>
          <Column id="fincNm" type="STRING" size="256"/>
          <Column id="acntNo" type="STRING" size="256"/>
          <Column id="relvAcntCd" type="STRING" size="256"/>
          <Column id="relvAcntNm" type="STRING" size="256"/>
          <Column id="slipAmt" type="BIGDECIMAL" size="256"/>
          <Column id="slipCfmDt" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_sub"/>
      <Dataset id="ds_input">
        <ColumnInfo>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="vouNo" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
          <Column id="vouOrgId" type="STRING" size="256"/>
          <Column id="staCd" type="STRING" size="256"/>
          <Column id="aplyUserId" type="STRING" size="256"/>
          <Column id="aplyDt" type="STRING" size="256"/>
          <Column id="userId" type="STRING" size="256"/>
          <Column id="userIp" type="STRING" size="256"/>
          <Column id="userPgm" type="STRING" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="vouTtl" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_result"/>
      <Dataset id="ds_grid_evdc_div"/>
      <Dataset id="ds_ac_bill_evdc" oncolumnchanged="ds_ac_bill_evdc_oncolumnchanged" onvaluechanged="ds_ac_bill_evdc_onvaluechanged">
        <ColumnInfo>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="vouNo" type="STRING" size="256"/>
          <Column id="vouOrgId" type="STRING" size="256"/>
          <Column id="vouKnd" type="STRING" size="256"/>
          <Column id="vouTtl" type="STRING" size="256"/>
          <Column id="draftDesc" type="STRING" size="256"/>
          <Column id="staCd" type="STRING" size="256"/>
          <Column id="aplyUserId" type="STRING" size="256"/>
          <Column id="aplyUserIdNm" type="STRING" size="256"/>
          <Column id="aplyDt" type="STRING" size="256"/>
          <Column id="approUserId" type="STRING" size="256"/>
          <Column id="approUserIdNm" type="STRING" size="256"/>
          <Column id="approDt" type="STRING" size="256"/>
          <Column id="ctrlUserId" type="STRING" size="256"/>
          <Column id="ctrlUserIdNm" type="STRING" size="256"/>
          <Column id="ctrlDt" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
          <Column id="slipCfmDt" type="STRING" size="256"/>
          <Column id="recvUserId" type="STRING" size="256"/>
          <Column id="recvUserIdNm" type="STRING" size="256"/>
          <Column id="recvDt" type="STRING" size="256"/>
          <Column id="fileId" type="STRING" size="256"/>
          <Column id="linkId" type="STRING" size="256"/>
          <Column id="cardEnpc" type="STRING" size="256"/>
          <Column id="cdno" type="STRING" size="256"/>
          <Column id="apvlDt" type="STRING" size="256"/>
          <Column id="bicApvlSeq" type="STRING" size="256"/>
          <Column id="insertId" type="STRING" size="256"/>
          <Column id="insertIp" type="STRING" size="256"/>
          <Column id="insertPgm" type="STRING" size="256"/>
          <Column id="orgFileNm" type="STRING" size="256"/>
          <Column id="calcYn" type="STRING" size="256"/>
          <Column id="preExpYn" type="STRING" size="256"/>
          <Column id="slipSeq" type="STRING" size="256"/>
          <Column id="slipAmt" type="BIGDECIMAL" size="256"/>
          <Column id="evdcAmt" type="BIGDECIMAL" size="256"/>
          <Column id="chk" type="STRING" size="256"/>
          <Column id="vat" type="BIGDECIMAL" size="256"/>
          <Column id="splyAmt" type="BIGDECIMAL" size="256"/>
          <Column id="budgAmt" type="BIGDECIMAL" size="256"/>
          <Column id="vendId" type="STRING" size="256"/>
          <Column id="vendNm" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_dummy"/>
      <Dataset id="ds_msg">
        <ColumnInfo>
          <Column id="msg" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grid_inc_div"/>
      <Dataset id="ds_grid_resi_div"/>
      <Dataset id="ds_bill_inc_evdc_cnt"/>
      <Dataset id="ds_ac_rcpt_desc"/>
      <Dataset id="ds_grid_bank_cd"/>
      <Dataset id="ds_grid_bacct_div"/>
      <Dataset id="ds_gKey">
        <ColumnInfo>
          <Column id="strAcntYy" type="STRING" size="256"/>
          <Column id="strAcntUnt" type="STRING" size="256"/>
          <Column id="strVouNo" type="STRING" size="256"/>
          <Column id="strVouOrgId" type="STRING" size="256"/>
          <Column id="strVouKnd" type="STRING" size="256"/>
          <Column id="strStaCd" type="STRING" size="256"/>
          <Column id="strBalDiv" type="STRING" size="256"/>
          <Column id="strDrcrCd" type="STRING" size="256"/>
          <Column id="strFormFlag" type="STRING" size="256"/>
          <Column id="strLinkId" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grid_resi_cnty"/>
      <Dataset id="ds_ac_pymt" oncolumnchanged="ds_ac_pymt_oncolumnchanged" onvaluechanged="ds_ac_pymt_onvaluechanged"/>
      <Dataset id="ds_pymtDiv"/>
      <Dataset id="ds_ac_vou_det" onrowposchanged="ds_ac_vou_det_onrowposchanged"/>
      <Dataset id="ds_ac_inc_evdc" oncolumnchanged="ds_ac_inc_evdc_oncolumnchanged" onvaluechanged="ds_ac_inc_evdc_onvaluechanged">
        <ColumnInfo>
          <Column id="rowStatus" type="STRING" size="256"/>
          <Column id="acntUnt" type="STRING" size="256"/>
          <Column id="acntYy" type="STRING" size="256"/>
          <Column id="vouNo" type="STRING" size="256"/>
          <Column id="vouOrgId" type="STRING" size="256"/>
          <Column id="vouKnd" type="STRING" size="256"/>
          <Column id="vouTtl" type="STRING" size="256"/>
          <Column id="draftDesc" type="STRING" size="256"/>
          <Column id="staCd" type="STRING" size="256"/>
          <Column id="aplyUserId" type="STRING" size="256"/>
          <Column id="aplyUserIdNm" type="STRING" size="256"/>
          <Column id="aplyDt" type="STRING" size="256"/>
          <Column id="approUserId" type="STRING" size="256"/>
          <Column id="approUserIdNm" type="STRING" size="256"/>
          <Column id="approDt" type="STRING" size="256"/>
          <Column id="ctrlUserId" type="STRING" size="256"/>
          <Column id="ctrlUserIdNm" type="STRING" size="256"/>
          <Column id="ctrlDt" type="STRING" size="256"/>
          <Column id="slipNo" type="STRING" size="256"/>
          <Column id="slipCfmDt" type="STRING" size="256"/>
          <Column id="recvUserId" type="STRING" size="256"/>
          <Column id="recvUserIdNm" type="STRING" size="256"/>
          <Column id="recvDt" type="STRING" size="256"/>
          <Column id="fileId" type="STRING" size="256"/>
          <Column id="linkId" type="STRING" size="256"/>
          <Column id="insertId" type="STRING" size="256"/>
          <Column id="insertIp" type="STRING" size="256"/>
          <Column id="insertPgm" type="STRING" size="256"/>
          <Column id="orgFileNm" type="STRING" size="256"/>
          <Column id="calcYn" type="STRING" size="256"/>
          <Column id="preExpYn" type="STRING" size="256"/>
          <Column id="slipSeq" type="STRING" size="256"/>
          <Column id="slipAmt" type="BIGDECIMAL" size="256"/>
          <Column id="evdcAmt" type="BIGDECIMAL" size="256"/>
          <Column id="budgAmt" type="BIGDECIMAL" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_foreign">
        <ColumnInfo>
          <Column id="code" type="STRING" size="256"/>
          <Column id="name" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row>
            <Col id="code">0</Col>
            <Col id="name">내국인</Col>
          </Row>
          <Row>
            <Col id="code">1</Col>
            <Col id="name">외국인</Col>
          </Row>
        </Rows>
      </Dataset>
    </Objects>
    <Script type="xscript5.0"><![CDATA[// [프로젝트]	동의대학교 예산회계시스템 구축
// [시스템명]	행정
// [부시스템]	회계관리
// [프로그램]	기안관리 > 결의서접수 >  전표관리팝업
// [설명] 
//	         
// [작성자명]	라 병 수
// [작성일자]	2016-06-02
//////////////////////////////////[수정이력]//////////////////////////////////
// [수정일자] 
// [수 정 자] 
// [수정내용] 

include "commJs::commonUtils.xjs";
include "commJs::commonGrid.xjs";
include "commJs::admiCommon.xjs";

var F_ACNT_YY = this.parent.ACNT_YY;			//회계년도
var F_ACNT_UNT = this.parent.ACNT_UNT;			//회계단위
var F_VOU_NO = this.parent.VOU_NO;				//결의번호
var F_SLIP_NO = this.parent.SLIP_NO;			//전표번호
var F_VOU_ORG_ID = this.parent.VOU_ORG_ID;		//결의부서
var F_STA_CD = this.parent.STA_CD;				//진행상태	
var F_APLY_USER_ID = this.parent.APLY_USER_ID;	//신청자
var F_APLY_DT = this.parent.APLY_DT;			//신청일자	
var F_VOU_TTL = this.parent.VOU_TTL;			//신청일자
var sMemberNo = application.gds_user.getColumn(application.gds_user.rowposition, "memberNo");	//사용자ID
var sNm = application.gds_user.getColumn(application.gds_user.rowposition, "nm");				//사용자명
var sIpAddr = application.gds_user.getColumn(application.gds_user.rowposition, "ipAddr");		//사용자IP
this.ac02020_purc_p01_onload = function(obj:Form, e:nexacro.LoadEventInfo)
{
	var arrDataSet = Array(8);
		arrDataSet[0]  = "ds_cmb_sta_cd";  		//진행상태
		arrDataSet[1]  = "ds_cmb_sta_cd_grd";  		//진행상태
		arrDataSet[2]  = "ds_grid_evdc_div";	//증빙구분
		arrDataSet[3]  = "ds_grid_inc_div";		//소득구분
		arrDataSet[4]  = "ds_grid_resi_div";	//거주구분
		arrDataSet[5]  = "ds_grid_resi_cnty";	//국가코드
		arrDataSet[6]  = "ds_grid_bank_cd";		//은행코드
		arrDataSet[7]  = "ds_grid_bacct_div";	//계좌구분
		arrDataSet[8]  = "ds_pymtDiv";			//지급구분

	var arrGrpCd = Array(8);
		arrGrpCd[0]  = "AC002";
		arrGrpCd[1]  = "AC002";
		arrGrpCd[2]  = "AC003";
		arrGrpCd[3]  = "AC004";
		arrGrpCd[4]  = "AC005";
		arrGrpCd[5]  = "CS004";
		arrGrpCd[6]  = "CS005";
		arrGrpCd[7]  = "AC012";
		arrGrpCd[8]  = "AC015";

	// 사용여부	지정할 아큐먼트를 넘긴다.
	var arrUseYn =	Array(8);
		arrUseYn[0]  =	"Y";
		arrUseYn[1]  =	"Y";
		arrUseYn[2]  =	"Y";
		arrUseYn[3]  =	"Y";
		arrUseYn[4]  =	"Y";
		arrUseYn[5]  =	"Y";
		arrUseYn[6]  =	"Y";
		arrUseYn[7]  =	"Y";
		arrUseYn[8]  =	"Y";

	// T:전체,S:선택,X:없음 
	var arrModeFg =	Array(8);
		arrModeFg[0]  =	"X";
		arrModeFg[1]  =	"T";
		arrModeFg[2]  =	"X";
		arrModeFg[3]  =	"X";
		arrModeFg[4]  =	"X";
		arrModeFg[5]  =	"X";
		arrModeFg[6]  =	"X";
		arrModeFg[7]  =	"X";
		arrModeFg[8]  =	"X";

	// WHERE절 내용 "X":없음
	var arrWhere =	Array(8);
		arrWhere[0]  =	"X";
		arrWhere[1]  =	"COM_CD IN ('32', '41', '42', '61', '62', '63')";
		arrWhere[2]  =	"X";
		arrWhere[3]  =	"X";
		arrWhere[4]  =	"X";
		arrWhere[5]  =	"X";
		arrWhere[6]  =	"X";
		arrWhere[7]  =	"X";
		arrWhere[8]  =	"X";

		
	/* 메소드명     : ComboLoad
	 * 설명			 : 공통코드 테이블을 조회하여 콤보박스를 생성한다.
	 * 메소드인수1  : DataSet명의 배열
	 * 메소드인수2  : 그룹코드번호의 배열
	 * 메소드인수3  : 캠퍼스구분 배열 ("T":전체, "C":공통만, "S":서울, "K":경주)
	 * 메소드인수4  : 조건문의 배열 (1:사용, 0:사용안함)
	 * 메소드인수5  : 전체공란 첨부여부 "T": 전체, "S":선택, "X" : 데이터시작
	 * 메소드인수6  : WHERE절 내용 "X":없음
	 */

 	this.gfn_comboLoad(arrDataSet, arrGrpCd, arrUseYn, arrModeFg, arrWhere);
	
	//회계년도Combo
	this.cfn_acntYy("ds_cmd_acnt_yy");
	
	//회계단위Combo
	this.cfn_acntUntCombo("ds_acntUntCmb", "", "", "", "0", "ac02010");
		
	//결의부서Grid
	this.gfn_findDeptCombo("ds_cmb_vou_org_id");
}

//온로드 후처리
this.fn_postLoad = function()
{
    this.gfn_bindCmmnFunction();

	//this.div_search.S_STA_CD.set_index(0);
	if ( F_STA_CD == "51" ) {
		this.btn_new.set_enable(false);
		this.btn_del.set_enable(false);
		this.btn_save.set_enable(false);
		this.C_STA_CD.set_enable(false);
		this.btn_ProcCd.set_enable(false);
	}
	
	
	this.div_search.S_ACNT_YY.set_value(F_ACNT_YY);			//회계년도
	this.div_search.S_ACNT_UNT.set_value(F_ACNT_UNT);			//회계단위
	this.div_search.S_VOU_NO.set_value(F_VOU_NO);				//결의번호
	this.div_search.S_VOU_ORG_ID.set_value(F_VOU_ORG_ID);		//결의부서
	//this.div_search.S_STA_CD.set_value(F_STA_CD);				//진행상태
	
	//SearchDiv 진행상태 변경시 필터
	this.fn_c_sta_cd_filter();

	//자동조회
	this.fn_Search();
}

this.div_search_S_ACNT_YY_onspin = function(obj:Spin, e:nexacro.SpinEventInfo)
{
	//회계단위Combo
	this.cfn_acntUntCombo("ds_acntUntCmb", this.div_search.S_ACNT_YY.value, "", "", "0", "ac02010");
}

//SearchDiv 진행상태 변경시
// this.div_search_S_STA_CD_onitemchanged = function(obj:Combo, e:nexacro.ItemChangeEventInfo)
// {
// 	this.fn_c_sta_cd_filter();
// 	
// 	//자동조회
// 	this.fn_Search();
// }

//처리코드 콤보 필터
this.fn_c_sta_cd_filter = function()
{
	this.ds_cmb_c_sta_cd.filter("comCd == '" + this.ds_main.getColumn(this.ds_main.rowposition,"staCd") + "'");
	
	this.C_STA_CD.set_index(0);
	
	var strStaCd = this.ds_main.getColumn(this.ds_main.rowposition,"staCd");
	
	if (strStaCd == "32") {
		this.tab01.tabpage1.btn_newSub.set_enable(true);
		this.tab01.tabpage1.btn_delSub.set_enable(true);
		this.tab01.tabpage1.btn_saveSub.set_enable(true);
		
		this.tab01.tabpage2.btn_tab02_New.set_enable(true);
		this.tab01.tabpage2.btn_tab02_Del.set_enable(true);
		this.tab01.tabpage2.btn_tab02_Save.set_enable(true);
		
		this.tab01.tabpage3.btn_tab03_New.set_enable(true);
		this.tab01.tabpage3.btn_tab03_Del.set_enable(true);
		this.tab01.tabpage3.btn_tab03_Save.set_enable(true);
		
		
		this.tab01.tabpage1.grd_sub.set_readonly(false);			//그리드F
		this.tab01.tabpage1.grd_sub.set_enableevent(true);		//그리드F
		
		this.tab01.tabpage2.grid_ac_inc_evdc.set_readonly(false);			//그리드F
		this.tab01.tabpage2.grid_ac_inc_evdc.set_enableevent(true);		//그리드F
		
		this.tab01.tabpage3.grid_ac_pymt.set_readonly(false);			//그리드F
		this.tab01.tabpage3.grid_ac_pymt.set_enableevent(true);		//그리드F		
	} else {
		this.tab01.tabpage1.btn_newSub.set_enable(false);
		this.tab01.tabpage1.btn_delSub.set_enable(false);
		this.tab01.tabpage1.btn_saveSub.set_enable(false);
		
		this.tab01.tabpage2.btn_tab02_New.set_enable(false);
		this.tab01.tabpage2.btn_tab02_Del.set_enable(false);
		this.tab01.tabpage2.btn_tab02_Save.set_enable(false);
		
		this.tab01.tabpage3.btn_tab03_New.set_enable(false);
		this.tab01.tabpage3.btn_tab03_Del.set_enable(false);
		this.tab01.tabpage3.btn_tab03_Save.set_enable(false);
		
		this.tab01.tabpage1.grd_sub.set_readonly(true);			//그리드F
		this.tab01.tabpage1.grd_sub.set_enableevent(false);		//그리드F
		
		this.tab01.tabpage2.grid_ac_inc_evdc.set_readonly(true);			//그리드F
		this.tab01.tabpage2.grid_ac_inc_evdc.set_enableevent(false);		//그리드F
		
		this.tab01.tabpage3.grid_ac_pymt.set_readonly(true);			//그리드F
		this.tab01.tabpage3.grid_ac_pymt.set_enableevent(false);		//그리드F
	}
	
}

//조회 전 처리 함수
this.fn_preSearch = function()
{
	if(this.gfn_isNull(this.div_search.S_ACNT_YY.value) || this.gfn_nvl(new String(this.div_search.S_ACNT_YY.value).length, 0) != 4) {
		this.gfn_message("A", "회계연도가 없습니다.\n관리자에게 문의 바랍니다.");
		return false;
	}
	
	return true;
}

//조회 액션
this.fn_Search = function()
{	
	if(this.fn_preSearch()) {
		var strArg  = "acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_YY));
			strArg += " acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_UNT));	  
			strArg += " vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_VOU_NO));
			//strArg += " staCd=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.div_search.S_STA_CD.value));
		  		
		this.gfn_transaction("SEARCH",
							 "txComUrl::com/admi/ac02/selectAc02020_purc_p01_1.do",
							 "",
							 "ds_main=resultList",
							 strArg,
							 "fn_callBack");
	}
}


//조회 후 처리
this.fn_postSearch = function()
{
	this.fn_SearchDet();	
 	this.gfn_getDatasetCount(this.ds_main, this.sta_main);	
}

//조회 전 처리 함수
this.fn_preSearchDet = function()
{
	
	return true;
}

//조회 액션
this.fn_SearchDet = function()
{	
	if(this.fn_preSearchDet()) {
		var strArg  = "acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_main.getColumn(this.ds_main.rowposition,"acntYy")));
			strArg += " acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_main.getColumn(this.ds_main.rowposition,"acntUnt")));	  
			strArg += " slipNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_main.getColumn(this.ds_main.rowposition,"slipNo")));
		  		
		this.gfn_transaction("SEARCHDET",
							 "txComUrl::com/admi/ac02/selectAc02020_purc_p01_2.do",
							 "",
							 "ds_det=resultList",
							 strArg,
							 "fn_callBack");
	}
}


//조회 후 처리
this.fn_postSearchDet = function()
{
	this.fn_SearchSub();
 	this.gfn_getDatasetCount(this.ds_det, this.sta_det);
		
}

//조회 전 처리 함수
this.fn_preSearchSub = function()
{	
	return true;
}

//조회 액션
this.fn_SearchSub = function()
{		
	if(this.fn_preSearchSub()) {
		var strArg  = "acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_YY));
			strArg += " acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_UNT));	  
			strArg += " slipNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition,"slipNo")));
			strArg += " slipSeq=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition,"slipSeq")));
		  		
		this.gfn_transaction("SEARCHSUB",
							 "txComUrl::com/admi/ac02/selectAc02020_purc_p01_3.do",
							 "",
							 "ds_ac_bill_evdc=resultList",
							 strArg,
							 "fn_callBack");
	}
}


//조회 후 처리
this.fn_postSearchSub = function()
{
	
 	this.gfn_getDatasetCount(this.ds_sub, this.sta_sub);
		
}

/*____________________________________________________________________________________________________________
	
	서버 통신 후 callBack
______________________________________________________________________________________________________________*/

this.fn_callBack = function(trId, errCd, errMsg)
{
	if(errCd < 0)
	{
		this.gfn_message("A", errMsg);
 	}
 	else
 	{
		if(trId=="LOAD")
		{
			this.fn_postLoad();
 		}
 		else if(trId == "SEARCH")
 		{
 			this.fn_postSearch();
 		}
 		else if(trId == "SEARCHDET")
 		{
 			this.fn_postSearchDet();
 		}
 		else if(trId == "SEARCHSUB")
 		{
 			this.fn_postSearchSub();
 		}
 		
		else if(trId == "ACNTUNTCOMBO")
		{
			this.div_search.S_ACNT_UNT.set_index(0);
		}
		else if(trId == "P_AC_STA_CD_PROC")
		{
			this.fn_postP_AC_STA_CD_PROC();
		}
		else if(trId == "APPROVAL")
		{
			this.fn_postApproval();
		}
		else if(trId == "SLIP_CREATE")
 		{
			this.fn_post_slip_create();
		}
		else if(trId == "SAVE")
 		{
			this.fn_postSave();
		}
		else if(trId == "SAVESUB")
 		{
			this.fn_postSaveSub();
		}
		else if(trId == "TABPAGE2_TAB02_SEARCH")	//원천세
		{
			this.fn_tab01_tabpage2_tab02_postSearch();
		}
		else if(trId == "TABPAGE2_TAB02_DEL")	//원천세
		{
			this.fn_tab01_tabpage2_tab02_postDel();
		}
		else if(trId == "TABPAGE2_TAB02_SAVE")	//원천세
		{
			this.fn_tab01_tabpage2_tab02_postSave();
		}
		
		else if(trId == "TABPAGE3_TAB03_SEARCH")	//계좌내역(지급)
		{
			this.fn_tab01_tabpage3_tab03_postSearch();
		}
		else if(trId == "TABPAGE3_TAB03_DEL")	//계좌내역(지급)
		{
			this.fn_tab01_tabpage3_tab03_postDel();
		}
		else if(trId == "TABPAGE3_TAB03_SAVE")	//계좌내역(지급)
		{
			this.fn_tab01_tabpage3_tab03_postSave();
		}
 	}
}

/*********************************************************************
 * 함 수 명 	: fn_postApproval
 * 함수설명 	: DataSet을 저장 후 처리 함수.
 *********************************************************************/
this.fn_postApproval = function()
{
	if ( this.ds_elec.getColumn(0, "cdChk") == "1" ) {
		this.gfn_message("A", this.ds_elec.getColumn(0, "chkMsg"));
		return;
	}

	//trace(this.ds_elec.saveXML());
	system.execBrowser("https://gw.deu.ac.kr/frmLinkageTransfer1.aspx?linkkey="+this.ds_elec.getColumn(0,"id")+"&userid="+this.ds_elec.getColumn(0,"userId")+"");
	this.close();
	//this.reload();
}


this.btn_ProcCd_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//결의서 체크
	if(this.ds_main.rowcount <= 0)
	{
		this.gfn_message("A", "조회된(처리할) 결의서가 없습니다.");
		return false;
	}
	
	if( this.ds_main.getRowType(this.ds_main.rowposition) > 1 ) {
		this.gfn_message("A", "수정된 데이터가 있습니다. 저장후 처리하시기 바랍니다.");
		return false;
	}
	
	/*
				
		전자결재승인(접수대기)32 : Y : 결의접수41
		전자결재승인(접수대기)32 : N : 접수반려42
		결의접수41 : C : 결의접수취소
		접수반려42 : C : 결의반려취소
		
		32	결의접수			Y
		32	접수반려			N
		41	회계전자결재신청	E
		41	결의접수취소		C
		42	결의반려취소		C
		61	전자결재신청취소	EC
		62	회계전자결재신청	E
		62	결의접수취소		C
		63	없음				EN

		
	*/
	
	//처리코드	
	inProcCd = "";
	
	inProcCd = this.ds_cmb_c_sta_cd.getColumn(this.ds_cmb_c_sta_cd.findRow("comCdNm", this.C_STA_CD.text), "procCd");
	if ( this.gfn_isNull(inProcCd) ) {
		this.gfn_message("A", "처리할 작업이 없습니다.");
		return;
	}
	
	//confirm
	var bOK = this.gfn_message("C", this.C_STA_CD.text + " 을(를) 진행 하시겠습니까?");
        	
	if (bOK ==true)
	{
		//접수반려
		if(this.C_STA_CD.value == "32" && inProcCd == "N")
		{
			var strParam = {
							  autoClose:false
							, autoSearch:false
							};
		               
			this.cfn_comRclRsnPopup(strParam,"fn_RclRsn_popCallback");
		}
		else if((this.C_STA_CD.value == "41" || this.C_STA_CD.value == "62" ) && inProcCd == "E")
		{
		
			var strSdVendorDesc = this.ds_main.getColumn(this.ds_main.rowposition, "sdVendorDesc");
			
			if ( this.gfn_isNull(strSdVendorDesc) ) {
				this.gfn_message("A", "영수란을 입력하세요.");
				this.grd_main.setCellPos(6);
				this.grd_main.setFocus();
				return;
			}
		
			//전자결재로직으로
			this.ds_elecInput.addRow();
			this.ds_elecInput.setColumn(0,"rowStatus",2);
			this.ds_elecInput.setColumn(0,"chk",0);
			//this.ds_elecInput.setColumn(0,"id","A0412");//비지니스 로직에서 쿼리로 만들것
			this.ds_elecInput.setColumn(0,"formId","2016000008");//폼아이디 수입지출결의서접수 : 2016000008
			
			var title; 
// 			if(this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "11" || this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "12" ){
// 				title = "수 입 결 의 서";
			//}else if(this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "21" || this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "22" ){
				title = "지 출 결 의 서";
// 			}else if(this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "31" || this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "32" || this.ds_ac_vou.getColumn(this.ds_ac_vou.rowposition,"vouKnd") == "33" ){
// 				title = "대 체 결 의 서";
// 			}
			
			var msg = "결의제목 : "+F_VOU_TTL+"  /   결의번호 : "+this.ds_main.getColumn(this.ds_main.rowposition,"vouNo");
						
			this.ds_elecInput.setColumn(0,"title",title);//메인타이틀 정해지면 맞춰서 넘길것
			
			this.ds_elecInput.setColumn(0,"subjId",msg);//세부아이디(출장관련) 정해지면 맞춰서 넘길것
			this.ds_elecInput.setColumn(0,"subtitle","서브타이틀");//서브타이틀 정해지면 맞춰서 넘길것 
			this.ds_elecInput.setColumn(0,"userId",application.gds_user.getColumn(0,"memberNo"));
			this.ds_elecInput.setColumn(0,"strElecId","AFA"); //전자결재ID 구분자값(차후 변경될수있어 파라미터처리
		    this.ds_elecInput.setColumn(0,"strAcntYy",this.ds_main.getColumn(this.ds_main.rowposition,"acntYy")); // 전자결재ID 구분자 뒤에 연도 두자리 ex(15,16,17)
			this.ds_elecInput.setColumn(0,"acntUnt",this.ds_main.getColumn(this.ds_main.rowposition,"acntUnt"));
			this.ds_elecInput.setColumn(0,"acntYy",this.ds_main.getColumn(this.ds_main.rowposition,"acntYy"));
			this.ds_elecInput.setColumn(0,"slipNo",this.ds_main.getColumn(this.ds_main.rowposition,"slipNo"));
			this.ds_elecInput.setColumn(0,"vouNo",F_VOU_NO);
			this.ds_elecInput.setColumn(0,"vouNoElec"," 기안번호 : "+F_VOU_NO.substring(0,8) + "-" + F_VOU_NO.substring(8,12));
			
			var strSlipNo = this.ds_main.getColumn(this.ds_main.rowposition,"slipNo");
			this.ds_elecInput.setColumn(0,"slipNoDisp",strSlipNo.substring(0,8) + "-" + strSlipNo.substring(8,12));
			
			this.ds_elecInput.setColumn(0,"aplyDt",this.ds_main.getColumn(this.ds_main.rowposition,"aplyDt"));
		    this.ds_elecInput.setColumn(0,"aplyUserId",this.ds_main.getColumn(this.ds_main.rowposition,"aplyUserId"));
		    this.ds_elecInput.setColumn(0, "msg", this.ds_msg.getColumn(0, "msg"));
		    this.ds_elecInput.setColumn(0, "procCd", inProcCd);
			this.ds_elecInput.setColumn(0, "userId", sMemberNo);
			this.ds_elecInput.setColumn(0, "userIp", sIpAddr);
			this.ds_elecInput.setColumn(0, "userPgm", "ac02010_p01.xfdl");
			this.ds_elecInput.setColumn(0, "cfmDt", "");
			this.gfn_transaction("APPROVAL",
								 "txComUrl::com/admi/ac02/saveAc02020_01_Approval_puch.do",
								 "resultList=ds_elecInput:u",
								 "ds_elec=ds_elec",
								 "",
								 "fn_callBack");
		}
		else
		{
			//EXEC
			this.fn_P_AC_STA_CD_PROC(inProcCd);
		}
	}
	else
	{
		return false;
	}
}

this.fn_RclRsn_popCallback = function(strID, rtnVal)
{
	if(rtnVal == "close") {
		return;
	}
	
	this.ds_msg.clearData();
	this.ds_msg.addRow();

	//반려사유입력 팝업
	if(strID == "admi01010_p18") {	
		this.ds_msg.setColumn(0, "msg", rtnVal);
		
		//EXEC
		this.fn_P_AC_STA_CD_PROC(inProcCd);
	}
}










//진행상태 처리 SP 실행
this.fn_P_AC_STA_CD_PROC = function(inProcCd)
{
	/*	
	
	전자결재승인(접수대기)32 : Y : 결의접수41
	전자결재승인(접수대기)32 : N : 접수반려42
	결의접수41 : C : 결의접수취소
	접수반려42 : C : 결의반려취소
	
	*/
		
	var addRow = this.ds_P_AC_STA_CD_PROC.addRow();	
			
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "rowStatus", this.ds_main.getColumn(this.ds_main.rowposition, "rowStatus"));
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "acntYy", this.ds_main.getColumn(this.ds_main.rowposition, "acntYy"));
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "acntUnt", this.ds_main.getColumn(this.ds_main.rowposition, "acntUnt"));
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "slipNo", this.ds_main.getColumn(this.ds_main.rowposition, "slipNo"));
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "msg", this.ds_msg.getColumn(0, "msg"));
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "procCd", inProcCd);
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "userId", sMemberNo);
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "userIp", sIpAddr);
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "userPgm", "ac02020.xfdl");
	this.ds_P_AC_STA_CD_PROC.setColumn(addRow, "cfmDt", "");
	
	this.gfn_transaction("P_AC_STA_CD_PROC",
						 "txComUrl::com/admi/ac02/P_AC_STA_CD_PROC_PUCH.do",
						 "resultList=ds_P_AC_STA_CD_PROC:u",
						 "ds_P_AC_STA_CD_PROC_result=resultList",
						 "",
						 "fn_callBack");
}

//진행상태 처리 SP 후처리
this.fn_postP_AC_STA_CD_PROC = function()
{
	var OUT_CNT = "";
	var OUT_MSG = "";
	
	OUT_CNT = this.ds_P_AC_STA_CD_PROC_result.getColumn(0, "OUT_CNT");
	OUT_MSG = this.ds_P_AC_STA_CD_PROC_result.getColumn(0, "OUT_MSG");
	
	if(OUT_CNT == 0)
	{
		this.gfn_message("A", OUT_MSG);

		this.fn_Search();
		this.fn_SearchDet();
		this.fn_SearchSub();
	}
	else
	{
		this.gfn_message("A", OUT_MSG);

		return false;
	}
}


//전표마스터와 디테일 한번에 생성한다.
this.btn_new_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_slip_create();
}
//진행상태 처리 SP 실행
this.fn_slip_create= function()
{
	
	var addRow = this.ds_input.addRow();	
			
	this.ds_input.setColumn(addRow, "rowStatus", 2);
	this.ds_input.setColumn(addRow, "acntYy", F_ACNT_YY);
	this.ds_input.setColumn(addRow, "acntUnt", F_ACNT_UNT);
	this.ds_input.setColumn(addRow, "vouNo", F_VOU_NO);
	this.ds_input.setColumn(addRow, "slipNo", F_SLIP_NO);
	this.ds_input.setColumn(addRow, "vouOrgId", F_VOU_ORG_ID);
	this.ds_input.setColumn(addRow, "vouTtl", F_VOU_TTL);
	this.ds_input.setColumn(addRow, "staCd", F_STA_CD);
	this.ds_input.setColumn(addRow, "aplyUserId", F_APLY_USER_ID);
	this.ds_input.setColumn(addRow, "aplyDt", F_APLY_DT);
	this.ds_input.setColumn(addRow, "userId", sMemberNo);
	this.ds_input.setColumn(addRow, "userIp", sIpAddr);
	this.ds_input.setColumn(addRow, "userPgm", "ac02020_purc_p01.xfdl");
	
	this.gfn_transaction("SLIP_CREATE",
						 "txComUrl::com/admi/ac02/SP_SLIP_CREATE.do",
						 "resultList=ds_input:u",
						 "ds_result=resultList",
						 "",
						 "fn_callBack");
}

//진행상태 처리 SP 후처리
this.fn_post_slip_create = function()
{
	var OUT_CNT = "";
	var OUT_MSG = "";
	
	OUT_CNT = this.ds_result.getColumn(0, "OUT_CNT");
	OUT_MSG = this.ds_result.getColumn(0, "OUT_MSG");
	
	if(OUT_CNT == 0)
	{
		//this.gfn_message("A", OUT_MSG);

		this.fn_Search();
	}
	else
	{
		this.gfn_message("A", OUT_MSG);

		return false;
	}
}

this.btn_del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.ds_ac_bill_evdc.rowcount > 0){
		var strMsg = "하위 증빙목록을 먼저 삭제해주세요.";
		this.gfn_message("A",strMsg);
		return false;
	}
	
	var strMsg = "선택된 전표를 삭제하시면 전표상세목록도 지워집니다.\n";
		strMsg += "계속하시겠습니까?";
	if(!this.gfn_message("C", strMsg)) {
		return;
	}else{
		this.gfn_deleteRow(this.ds_main, "this.fn_save()","C");
	}
}

this.btn_save_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_save();
}

/*********************************************************************
 * 함 수 명 	: fn_save
 * 함수설명 	: DataSet을 저장한다.
 *********************************************************************/
this.fn_save = function()
{
	this.gfn_transaction("SAVE",
						 "txAdmUrl::com/admi/ac02/saveAc02020_purc_p01_1.do",
						 "resultList=ds_main:u",
						 "",
						 "",
						 "fn_callBack");
}

/*********************************************************************
 * 함 수 명 	: fn_postSave
 * 함수설명 	: DataSet을 저장 후 처리 함수.
 *********************************************************************/
this.fn_postSave = function()
{
	this.gfn_message("A", "저장이 완료되었습니다.");
	this.fn_Search();
	this.fn_SearchDet();
	this.fn_SearchSub();
}

this.btn_newSub_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_addRow(this.ds_ac_bill_evdc);

	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "rowStatus", 2);

	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "acntYy", this.ds_det.getColumn(this.ds_det.rowposition, "acntYy"));	//회계년도
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "acntUnt", this.ds_det.getColumn(this.ds_det.rowposition, "acntUnt"));	
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vouNo", this.ds_main.getColumn(this.ds_main.rowposition, "vouNo"));	
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vouSeq", this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq"));	
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "slipNo", this.ds_det.getColumn(this.ds_det.rowposition, "slipNo"));	
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "slipSeq", this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq"));	
	
	//증빙구분
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "evdcDiv", "10");	
	
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vendNm", this.ds_main.getColumn(this.ds_main.rowposition, "vendorNm"));
	this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vendId", this.ds_main.getColumn(this.ds_main.rowposition, "vendorId"));
	
	if(F_STA_CD == "51"){
		//선지출여부 - 전표확정 이후에 입력이 될때는 1(Y) 로 입력
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "preExpYn", "1");	
	}

}

this.btn_delSub_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.gfn_deleteRow(this.ds_ac_bill_evdc, "this.saveSub()");
}

this.btn_saveSub_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.saveSub();
}

this.fn_btn_pre_saveSub = function()
{
	if(!this.gfn_isUpdate(this.ds_ac_bill_evdc)){
		this.gfn_message("A", "변경된 데이터가 없습니다.");
		return false;
	}

 	//데이터 중복 체크
	if(!this.gfn_chkValidation("ds_ac_bill_evdc", "acntUnt$acntYy$vouNo$vouSeq$evdcSeq", "회계단위, 회계연도, 결의번호, 결의순번, 증빙순번")){
		return false;
	}
		
 	//필수값 입력 체크
	var colNm = "evdcDiv$evdcDesc$vendNm$evdcAmt$issDt";
	var korNm = "*증빙구분$*증빙내역$*거래처명$*증빙금액$*발행일자";
	var cmpNm = " $ ";

	var result = this.gfn_chkEssItem("ds_ac_bill_evdc", colNm, korNm, cmpNm);
	if (result[0] != "success") {
		this.gfn_message("A", result[0]);
		
		/*
		this.ds_ac_bill_evdc.set_rowposition(result[1]);
		if(result[3] != ""){
			this.objects[result[3]].setFocus();
		}
		*/
		
		return false;	
	}
	
	return true;
}

this.saveSub = function()
{
	if(this.fn_btn_pre_saveSub()) 
	{
		
		var amt1 = this.ds_det.getColumn(this.ds_det.rowposition,"slipAmt");
		var amt2 = this.ds_ac_bill_evdc.getCaseSum("rowStatus == 8","budgAmt");
		var amt3 = nexacro.toNumber(amt1)-nexacro.toNumber(amt2);
		
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition,"slipAmt",amt3);
		this.gfn_transaction("SAVESUB",
							  "txComUrl::com/admi/ac02/saveAc02010p01_t01_02_purc.do",
							  "resultList=ds_ac_bill_evdc:u",
							  "",
							  "",
							 "fn_callBack");
	}
}

/*********************************************************************
 * 함 수 명 	: fn_postSaveSub
 * 함수설명 	: DataSet을 저장 후 처리 함수.
 *********************************************************************/
this.fn_postSaveSub = function()
{
	this.gfn_message("A", "저장이 완료되었습니다.");
	this.fn_SearchDet();
}



this.ds_main_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	var strStaCd = this.ds_main.getColumn(this.ds_main.rowposition, "staCd");

	if ( strStaCd == "51" || strStaCd == "61" || strStaCd == "62" || strStaCd == "63" ) {
		this.btn_elecSearch.set_visible(true);
	} else {
		this.btn_elecSearch.set_visible(false);
	}

	this.fn_c_sta_cd_filter();
	this.fn_SearchDet();
}

this.ds_det_canrowposchange = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	if(this.gfn_isUpdate(this.ds_det)){
		var strMsg = "변경된 데이타가 존재합니다.\n";
			strMsg += "저장하시겠습니까?";
		if(!this.gfn_message("C", strMsg)) {
			return;
		}else{
			this.saveSub();
		}
	}
	
	
	
	
}

this.ds_det_onrowposchanged = function(obj:Dataset, e:nexacro.DSRowPosChangeEventInfo)
{
	//this.fn_SearchSub();
	this.tab01_onchanged();
}
this.tab01_tabpage1_grid_ac_bill_evdc_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	//거래처조회팝업
	if(e.cell == 8)
	{
		var strParam = {
						  vendCdNm:""
						, autoSearch:true
						, autoClose:true
						};
						   
			this.cfn_vendPopup(strParam,"fn_popCallback");
	}
	//첨부파일등록
	else if(e.cell == 16)
	{
		var strParam = {fileMasterNo:this.ds_ac_bill_evdc.getColumn(this.ds_ac_bill_evdc.rowposition, "fileId")
						};
		this.cfn_fileUpDownloadPop(strParam,"fn_filePopCallBack");
		
	}
	//법인카드 승인내역팝업
	else if(e.cell == 5) 
	{
		var strParam = {autoSearch:true,autoClose:false
		               ,depsAmt:this.ds_det.getColumn(this.ds_det.rowposition,"slipAmt")
		               ,mgtOrgId:""
		               };
		
		//입금내역연동 팝업 호출
		this.cfn_admiPopup24(strParam);
	}
}

/********************************************************************************
 * 함 수 명 	: fn_filePopCallBack
 * 함수설명 	: 계정내역팝업콜백(기존).
********************************************************************************/
this.fn_filePopCallBack = function(strID, rtnVal)
{

	this.ds_dummy.clear();
	this.ds_dummy.loadXML(rtnVal);

	if(rtnVal != "close"){
		if(!this.gfn_isNull(this.ds_ac_bill_evdc.getColumn(this.ds_ac_bill_evdc.rowposition,"fileId"))){

			if(this.ds_ac_bill_evdc.getColumn(this.ds_ac_bill_evdc.rowposition,"fileId") != this.ds_dummy.getColumn(0, "fileMasterNo")){
			
				this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition,"fileId",this.ds_dummy.getColumn(0, "fileMasterNo"));
				this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition,"orgFileNm",this.ds_dummy.getColumn(0, "filename"));
				//this.fn_tab01_tabpage1_tab01_Save_file();
			}
	 	}else{

	 		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition,"fileId",this.ds_dummy.getColumn(0, "fileMasterNo"));
			this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition,"orgFileNm",this.ds_dummy.getColumn(0, "filename"));
	 	}
	}
	
		
}

/*____________________________________________________________________________________________________________
	
	팝업 콜백
______________________________________________________________________________________________________________*/

this.fn_popCallback = function (strID, rtnVal)
{
	if(rtnVal == "close" || rtnVal == "" || rtnVal == "undefined" ) {
		return;
	}
	
	//Dataset을 return 할 경우
	this.ds_dummy.clear();
	this.ds_dummy.loadXML(rtnVal);
	
	//부서별예산조회팝업 호출
	if(strID == "admi01010_p15") 
	{	
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "bizCd", this.ds_dummy.getColumn(0, "bizCd")); //사업코드
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "bizCdNm", this.ds_dummy.getColumn(0, "bizCdNm")); //사업명
 		
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "acntCd", this.ds_dummy.getColumn(0, "acntCd")); //계정(세목)코드
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "acntCdMokNm", this.ds_dummy.getColumn(0, "acntCdMokNm")); //목명
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "acntCdNm", this.ds_dummy.getColumn(0, "acntCdNm")); //계정(세목)명
 		 		
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "aplyAmt", ""); //신청액
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "asgnAmtSum", this.ds_dummy.getColumn(0, "asgnAmtSum")); //배정예산
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "execAmtSum", this.ds_dummy.getColumn(0, "execAmtSum")); //집행액
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "budgBal", this.ds_dummy.getColumn(0, "budgBal")); //예산잔액
 		
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "asgnAmtSum", ""); //배정예산
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "execAmtSum", ""); //집행액
 		
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "cfmAmt", ""); //확정액
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "useOrgId", ""); //사용부서코드
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "useOrgIdNm", ""); //사용부서명
 		
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "fincCd", this.ds_dummy.getColumn(0, "fincCd")); //재원코드
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "fincCdNm", this.ds_dummy.getColumn(0, "fincCdNm")); //재원명
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "acntNo", this.ds_dummy.getColumn(0, "mgtAcntNo")); //계좌번호(관리계좌)
 		
 		//trace(this.ds_ac_vou_det.saveXML());
	}
	//조직도조회팝업 호출
	else if(strID == "admi01010_p07") 
	{	
 		this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "useOrgId", this.ds_dummy.getColumn(0, "deptCd")); //부서코드
 		//this.ds_ac_vou_det.setColumn(this.ds_ac_vou_det.rowposition, "useOrgIdNm", this.ds_dummy.getColumn(0, "deptNmKor")); //부서이름
	}
	//(증빙) 거래처조회 팝업
	else if(strID == "admi01010_p09") 
	{	
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vendId", this.ds_dummy.getColumn(0, "vendId")); //거래처ID
 		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vendNm", this.ds_dummy.getColumn(0, "vendNm")); //거래처명
	}
	//(증빙) 법인카드승인내역 팝업
	else if(strID == "admi01010_p24")
	{
		//this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "evdcDesc", this.ds_dummy.getColumn(0, "mcNm")); //증빙내역 / 거래처명
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vendNm", this.ds_dummy.getColumn(0, "mcNm")); //거래처명
		
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "evdcAmt", this.ds_dummy.getColumn(0, "apvlAmtDom")); //증빙금액
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "budgAmt", this.ds_dummy.getColumn(0, "calcRemainAmt")); //예산반영금액
		
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "splyAmt", this.ds_dummy.getColumn(0, "trnsAmtWc")); //공급가
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "vat", this.ds_dummy.getColumn(0, "stxat")); //부가세
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "issDt", this.ds_dummy.getColumn(0, "apvlDt")); //발행일자(승인일자)
		
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "cardEnpc", this.ds_dummy.getColumn(0, "cardEnpc")); //카드업체코드
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "cdno", this.ds_dummy.getColumn(0, "cdno")); //카드번호
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "apvlDt", this.ds_dummy.getColumn(0, "apvlDt")); //승인일자
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "bicApvlSeq", this.ds_dummy.getColumn(0, "bicApvlSeq")); //BIC승인일련번호
		this.ds_ac_bill_evdc.setColumn(this.ds_ac_bill_evdc.rowposition, "approNo", this.ds_dummy.getColumn(0, "aprno")); //승인번호		
	}
	//(원천세) 교직원조회 팝업
	else if(strID == "admi01010_p14") 
	{	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "reptUserId", this.ds_dummy.getColumn(0, "memberNo")); //신고대상자
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "reptUserNm", this.ds_dummy.getColumn(0, "nm")); //신고대상자명
 		
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "zipNo", this.ds_dummy.getColumn(0, "zipNo")); //우편번호
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "addr", this.ds_dummy.getColumn(0, "addr")); //주소
 		//this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "addrDet", this.ds_dummy.getColumn(0, "addrDet")); //상세주소
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resNo", this.ds_dummy.getColumn(0, "juminNo")); //주민등록번호
	}
	//(원천세) 기타소득자조회 팝업
	else if(strID == "admi01010_p16") 
	{	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "reptUserId", this.ds_dummy.getColumn(0, "")); //신고대상자
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "reptUserNm", this.ds_dummy.getColumn(0, "reptUserNm")); //신고대상자명
 		
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resNo", this.ds_dummy.getColumn(0, "resNo")); //주민등록번호
 		
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resiDiv", this.ds_dummy.getColumn(0, "resiDiv")); //거주구분
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resiCnty", this.ds_dummy.getColumn(0, "resiCnty")); //거주국가
 		
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "zipNo", this.ds_dummy.getColumn(0, "zipNo")); //우편번호
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "addr", this.ds_dummy.getColumn(0, "addr")); //주소
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "addrDet", this.ds_dummy.getColumn(0, "addrDet")); //상세주소
	}
	//(원천세) 첨부파일
// 	else if(strID == "") 
// 	{	
// 		
// 	}
	//(원천세) 국가조회 팝업
	else if(strID == "admi01010_p17") 
	{	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resiCnty", this.ds_dummy.getColumn(0, "comCd")); //국가코드
 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "resiCntyNm", this.ds_dummy.getColumn(0, "comCdNm")); //국가명
	}
	//(원천세) 우편번호(주소)조회 팝업
	else if(strID == "admi01010_p06") 
	{	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "zipNo", this.ds_dummy.getColumn(0, "zip")); //우편번호
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "addr", this.ds_dummy.getColumn(0, "addr")); //주소
	}
	//(계좌내역) 은행조회 팝업
	else if(strID == "admi01010_p13") 
	{	
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bankCd", this.ds_dummy.getColumn(0, "comCd")); //은행코드
	}
	
	
	
	
	//(계좌내역) 거래처계좌조회 팝업 :: 10:거래처
	else if(strID == "admi01010_p19") 
	{	
  		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bankCd", this.ds_dummy.getColumn(0, "bankCd")); //은행코드
  		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntNo", this.ds_dummy.getColumn(0, "acntNo")); //계좌번호
  		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "deposr", this.ds_dummy.getColumn(0, "deposr")); //예금주
	}
	//(계좌내역) 교직원계좌조회 팝업 :: 20:교직원
	else if(strID == "admi01010_p20") 
	{	
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bankCd", this.ds_dummy.getColumn(0, "bankCd")); //은행코드
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntNo", this.ds_dummy.getColumn(0, "acntNo")); //계좌번호
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "deposr", this.ds_dummy.getColumn(0, "deposr")); //예금주
	}
	//(계좌내역) 계좌조회 팝업 :: 30:자체계좌
	else if(strID == "admi01010_p27") 
	{	
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bankCd", this.ds_dummy.getColumn(0, "bankCd")); //은행코드
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntNo", this.ds_dummy.getColumn(0, "acntNo")); //계좌번호
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "deposr", this.ds_dummy.getColumn(0, "deposr")); //예금주
	}
	//(계좌내역) 기타계좌조회 팝업 :: 90:기타
	else if(strID == "admi01010_p21") 
	{	
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bankCd", this.ds_dummy.getColumn(0, "bankCd")); //은행코드
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntNo", this.ds_dummy.getColumn(0, "acntNo")); //계좌번호
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "deposr", this.ds_dummy.getColumn(0, "deposr")); //예금주
	}
}

this.ds_ac_bill_evdc_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "evdcDiv")
	{
		//증빙내역Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "evdcDesc", "");
		
		//거래처ID Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "vendId", "");
		
		//거래처명Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "vendNm", "");
		
		//증빙금액Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "evdcAmt", "");
		
		//예산반영금액Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "budgAmt", "");
		
		//공급가Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "splyAmt", "");
		
		//부가세Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "vat", "");
		
		//발행일자Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "issDt", "");
		
		//매입공제여부Cell
		if(e.newvalue == 10)	//세금계산서
		{
			this.ds_ac_bill_evdc.setColumn(e.row, "deductYn", "0");
		}
		else	//계산서, 법인카드, 현금영수증, 간이영수증, 기타
		{
			this.ds_ac_bill_evdc.setColumn(e.row, "deductYn", "");
		}
		
		//전자여부Cell
		if(e.newvalue == 10)	//세금계산서
		{
			this.ds_ac_bill_evdc.setColumn(e.row, "elecYn", "1");
		}
		else if(e.newvalue == 20)	//계산서
		{
			this.ds_ac_bill_evdc.setColumn(e.row, "elecYn", "0");
		}
		else	//법인카드, 현금영수증, 간이영수증, 기타
		{
			this.ds_ac_bill_evdc.setColumn(e.row, "elecYn", "");
		}
		
		//승인번호Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "approNo", "");
		
		//첨부파일Cell
		this.ds_ac_bill_evdc.setColumn(e.row, "fileNo", "");
	}
}

this.ds_ac_bill_evdc_onvaluechanged = function(obj:Dataset,  e:nexacro.DSColChangeEventInfo)
{
	if(obj.name = "ds_ac_bill_evdc")
	{			
		//증빙금액 변경시
		if(e.columnid == "evdcAmt")
		{	
			//증빙구분
			var sEvdcDiv = obj.getColumn(e.row, "evdcDiv");
			
			var amt1;
			var amt2;
			var amt3;
			var preAmt = this.ds_ac_bill_evdc.getCaseSum("rowStatus < 8","budgAmt");
			
			//증빙구분:세금계산서
			if(sEvdcDiv == 10)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//공급가
				var nSplyAmt = Math.round(nEvdcAmt / 1.1);
				
				//부가세
				var nVat = nEvdcAmt - nSplyAmt;
								
				obj.setColumn(e.row, "splyAmt", nSplyAmt);
				obj.setColumn(e.row, "vat", nVat);
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//예산반영금액
				
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",this.ds_ac_bill_evdc.getCaseSum("rowStatus < 8","budgAmt")); 
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_bill_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);

				//alert("amt1 : "+amt1+"  amt2 : "+amt2+"  amt3  : "+amt3+"  preAmt : "+preAmt);
				
				
				
			}
			//계산서
			else if(sEvdcDiv == 20)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				obj.setColumn(e.row, "splyAmt", nEvdcAmt);
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//예산반영금액
				
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_bill_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
			}
			//법인카드, 현금영수증, 간이영수증, 기타
			else
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//예산반영금액
				
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_bill_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
			}
			
		}
		//공급가 변경시
		else if(e.columnid == "splyAmt")
		{
			//증빙구분
			var sEvdcDiv = obj.getColumn(e.row, "evdcDiv");
			
			//세금계산서
			if(sEvdcDiv == 10)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//공급가
				var nSplyAmt = obj.getColumn(e.row, "splyAmt");
								
				//부가세
				var nVat = nEvdcAmt - nSplyAmt;

				obj.setColumn(e.row, "vat", nVat);
				
			}
			//계산서, 법인카드, 현금영수증, 간이영수증, 기타
			else
			{

			}
		}

	}
}

this.ds_ac_inc_evdc_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "incDiv")
	{
		//증빙내역Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "evdcDesc", "");
		
		//소득대상자ID Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "reptUserId", "");
		
		//소득대상자명Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "reptUserNm", "");
		
		//주민등록번호Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "resNo", "");
		
		//증빙금액Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "evdcAmt", "");
		
		//첨부파일Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "fileId", "");
					
		if ( e.newvalue == "10" ) {
			//거주구분Cell
			this.ds_ac_inc_evdc.setColumn(e.row, "resiDiv", "");

			//거주국가Cell
			this.ds_ac_inc_evdc.setColumn(e.row, "resiCnty", "");
		} else {
			//거주구분Cell
			this.ds_ac_inc_evdc.setColumn(e.row, "resiDiv", "10");

			//거주국가Cell
			this.ds_ac_inc_evdc.setColumn(e.row, "resiCnty", "410");		 
		}
		
		//우편번호Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "zipNo", "");
		
		//주소Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "addr", "");
		
		//상세주소Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "addrDet", "");
		
		//필요경비Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "needExp", "");
		
		//소득액Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "incAmt", "");
		
		//소득세Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "incTax", "");
		
		//주민세Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "resTax", "");
		
		//소득세율Cell
		if(e.newvalue == 20)
		{
			this.ds_ac_inc_evdc.setColumn(e.row, "incTaxRt", "20");
		}
		else
		{
			this.ds_ac_inc_evdc.setColumn(e.row, "incTaxRt", "");
		}
		
		//지급일자Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "pymtDt", "");
		
		//신고년월Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "reptYymm", "");
		
		//근무일수Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "wrkDdCnt", "");
		
		//근무단가Cell
		this.ds_ac_inc_evdc.setColumn(e.row, "wrkUntprc", "");
	}
}

//원천세 소득구분별 자동계산
this.ds_ac_inc_evdc_onvaluechanged = function(obj:Dataset,  e:nexacro.DSColChangeEventInfo)
{
	if(obj.name = "ds_ac_inc_evdc")
	{			
		//증빙금액 변경시
		if(e.columnid == "evdcAmt")
		{
			//소득구분
			var sIncDiv = obj.getColumn(e.row, "incDiv");
			
			var amt1;
			var amt2;
			var amt3;
			var preAmt = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
			
			//소득구분:기타수당
			if(sIncDiv == 10)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//증빙금액 > 소득액
				obj.setColumn(e.row, "incAmt", nEvdcAmt);
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//증빙금액 임시저장소
				
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);

			}
			//기타소득
			//기타소득일 경우 소득금액, 소득세, 주민세 자동 계산 로직 수정
			//- 증빙금액이 250000 초과 시 : 기존 계산 방법
			//- 증빙금액이 250000 이하 시(250000원 포함) : 필요경비, 소득금액 기존 로직, 
			//  소득세, 주민세는 0 으로 
			// 16.04.28 라병수
			else if(sIncDiv == 20)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				if(nEvdcAmt > 250000)
				{
					//필요경비
					var nNeedExp = Math.floor(obj.getColumn(e.row, "evdcAmt") * 0.8);
					
					//소득액
					var nIncAmt = nEvdcAmt - nNeedExp;
					
					//소득세
					var nIncTaxF = nIncAmt * 0.2;
					var nIncTax = Math.floor(nIncTaxF / 10) * 10;
									
					//주민세
					//var nResTax = nIncTax * 0.1;
					var nResTaxF = nIncTax * 0.1;
					var nResTax = Math.floor(nResTaxF / 10) * 10;
					
					obj.setColumn(e.row, "needExp", nNeedExp);
					obj.setColumn(e.row, "incAmt", nIncAmt);
					obj.setColumn(e.row, "incTax", nIncTax);
					obj.setColumn(e.row, "resTax", nResTax);
					obj.setColumn(e.row, "budgAmt", nEvdcAmt);//증빙금액 임시저장소
				
					//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
					//amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
					//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
					
					//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
				}else{
					
					// 증빙금액이 250000 이하 시(250000원 포함) : 필요경비, 소득금액 기존 로직, 소득세, 주민세는 0 으로 
					//필요경비
					var nNeedExp = Math.floor(obj.getColumn(e.row, "evdcAmt") * 0.8);
					
					//소득액
					var nIncAmt = nEvdcAmt - nNeedExp;
					
					obj.setColumn(e.row, "needExp", nNeedExp);
					obj.setColumn(e.row, "incAmt", nIncAmt);
					obj.setColumn(e.row, "incTax", 0);
					obj.setColumn(e.row, "resTax", 0);
					obj.setColumn(e.row, "budgAmt", nEvdcAmt);//증빙금액 임시저장소
				
					//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
					//amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
					//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
					
					//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
				}	
			}
			//사업소득
			else if(sIncDiv == 30)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//소득액
				var nIncAmt = nEvdcAmt;
				
				//소득세
				var nIncTaxF = nIncAmt * 0.03;
				var nIncTax = Math.floor(nIncTaxF / 10) * 10;
				
				//주민세
				//var nResTax = nIncTax * 0.1;
				var nResTaxF = nIncTax * 0.1;
				var nResTax = Math.floor(nResTaxF / 10) * 10;
				
				obj.setColumn(e.row, "incAmt", nIncAmt);
				obj.setColumn(e.row, "incTax", nIncTax);
				obj.setColumn(e.row, "resTax", nResTax);
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//증빙금액 임시저장소
				
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
			}
			//일용직
			else if(sIncDiv == 40)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//소득액
				var nIncAmt = nEvdcAmt;
					
				obj.setColumn(e.row, "incAmt", nIncAmt);
				obj.setColumn(e.row, "budgAmt", nEvdcAmt);//증빙금액 임시저장소
				
				//amt1 = this.ds_det.getColumn(this.ds_det.rowposition, "slipAmt");
				//amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus < 8","budgAmt");
				//amt3 = nexacro.toNumber(amt1)+nexacro.toNumber(amt2)-nexacro.toNumber(preAmt);
				
				//this.ds_det.setColumn(this.ds_det.rowposition, "slipAmt",amt3);
			}
		}
		//필요경비 변경시
		else if(e.columnid == "needExp")
		{
			//소득구분
			var sIncDiv = obj.getColumn(e.row, "incDiv");
			
			//기타소득
			if(sIncDiv == 20)
			{
				//증빙금액
				var nEvdcAmt = obj.getColumn(e.row, "evdcAmt");
				
				//필요경비
				var nNeedExp = obj.getColumn(e.row, "needExp");
				
				//소득액
				var nIncAmt = nEvdcAmt - nNeedExp;
				
				//소득세
				var nIncTax = nIncAmt * 0.2;
								
				//주민세
				//var nResTax = nIncTax * 0.1;
				var nResTaxF = nIncTax * 0.1;
				var nResTax = Math.floor(nResTaxF / 10) * 10;
				
				obj.setColumn(e.row, "incAmt", nIncAmt);
				obj.setColumn(e.row, "incTax", nIncTax);
				obj.setColumn(e.row, "resTax", nResTax);
			}
		}
	}
}


this.tab01_tabpage1_grid_ac_bill_evdc_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	this.tab01.tabpage1.grd_sub.dropdownCombo();
	this.tab01.tabpage1.grd_sub.dropdownCalendar();
}



//원천세 조회버튼 이벤트
this.tab01_tabpage2_btn_tab02_Search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_tab01_tabpage2_tab02_Search();
}

//원천세 조회 전처리
this.fn_tab01_tabpage2_tab02_preSearch = function()
{
	return true;
}

//원천세 조회 액션
this.fn_tab01_tabpage2_tab02_Search = function()
{
	if(this.fn_tab01_tabpage2_tab02_preSearch()) 
	{
		var strArg  = "acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntYy")));
			strArg += " acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntUnt")));
			strArg += " vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouNo")));
			strArg += " vouSeq=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouSeq")));
		
		this.gfn_transaction("TABPAGE2_TAB02_SEARCH",
							 "txComUrl::com/admi/ac02/selectAc02010p01_t01_03.do",
							 "",
							 "ds_ac_inc_evdc=resultList",
							 strArg,
							 "fn_callBack");
	}
}

//원천세 조회 후처리
this.fn_tab01_tabpage2_tab02_postSearch = function()
{
 	this.gfn_getDatasetCount(this.ds_ac_inc_evdc, this.tab01.tabpage2.ds_ac_inc_evdc_cnt);
}




//원천세 추가버튼 이벤트
this.tab01_tabpage2_btn_tab02_New_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_tab01_tabpage2_tab02_New();
}

//원천세 추가 전처리
this.fn_tab01_tabpage2_tab02_preNew = function()
{
// 	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	return true;
}

//원천세 추가 액션
this.fn_tab01_tabpage2_tab02_New = function()
{
	if(this.fn_tab01_tabpage2_tab02_preNew()) 
	{
		this.gfn_addRow(this.ds_ac_inc_evdc);

		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "rowStatus", 2);

		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "acntYy", this.ds_det.getColumn(this.ds_det.rowposition, "acntYy"));	//회계년도
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "acntUnt", this.ds_det.getColumn(this.ds_det.rowposition, "acntUnt"));	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "vouNo", this.ds_main.getColumn(this.ds_main.rowposition, "vouNo"));	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "vouSeq", this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq"));
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "slipNo", this.ds_det.getColumn(this.ds_det.rowposition, "slipNo"));	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "slipSeq", this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq"));	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "foreignYn", "0");	
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "incDiv", "10");	//소득구분
		
		if(F_STA_CD == "51"){
			//선지출여부 - 전표확정 이후에 입력이 될때는 1(Y) 로 입력
			this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition, "preExpYn", "1");	
		}
	}
}




//원천세 삭제버튼 이벤트
this.tab01_tabpage2_btn_tab02_Del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
// 	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	this.gfn_deleteRow(this.ds_ac_inc_evdc, "this.fn_tab01_tabpage2_tab02_Del()");
}

//원천세 삭제 전처리
this.fn_tab01_tabpage2_tab02_preDel = function()
{
	return true;
}

//원천세 삭제 액션
this.fn_tab01_tabpage2_tab02_Del = function()
{	
	if(this.fn_tab01_tabpage2_tab02_preDel()) 
	{
		
		var amt1 = this.ds_det.getColumn(this.ds_det.rowposition,"slipAmt");
		var amt2 = this.ds_ac_inc_evdc.getCaseSum("rowStatus == 8","evdcAmt");
		var amt3 = nexacro.toNumber(amt1)-nexacro.toNumber(amt2);
		
		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"slipAmt",amt3);
		this.gfn_transaction("TABPAGE2_TAB02_DEL",
							  "txComUrl::com/admi/ac02/saveAc02010p01_t01_03_purc.do",
							  "resultList=ds_ac_inc_evdc:u",
							  "",
							  "",
							 "fn_callBack");
	}
}

//원천세 삭제 후처리
this.fn_tab01_tabpage2_tab02_postDel = function()
{
	this.gfn_message("A", "삭제가 완료되었습니다.");
	
	//this.fn_tab01_tabpage2_tab02_Search();
	
	this.tab01.set_tabindex(1);
	this.fn_SearchDet();
	this.tab01_onchanged(); //이거
}




//원천세 저장버튼 이벤트
this.tab01_tabpage2_btn_tab02_Save_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	this.fn_tab01_tabpage2_tab02_Save();
}

//원천세 저장 전처리
this.fn_tab01_tabpage2_tab02_preSave = function()
{
	if(!this.gfn_isUpdate(this.ds_ac_inc_evdc)){
		this.gfn_message("A", "변경된 데이터가 없습니다.");
		return false;
	}

 	//데이터 중복 체크
	if(!this.gfn_chkValidation("ds_ac_inc_evdc", "acntUnt$acntYy$vouNo$vouSeq$evdcSeq", "회계단위, 회계연도, 결의번호, 결의순번, 증빙순번")){
		return false;
	}
		
 	//필수값 입력 체크
	//var colNm = "incDiv$evdcDesc$reptUserNm$resNo$evdcAmt$zipNo$addr$pymtDt$reptYymm";
	//var korNm = "*소득구분$*증빙내역$*신고대상자명$*주민등록번호$*증빙금액$*우편번호$*주소$*지급일자$*신고년월"; 필수값에서 신고년월 제거
	var colNm = "incDiv$evdcDesc$reptUserNm$evdcAmt";
	var korNm = "*소득구분$*증빙내역$*신고대상자명$*증빙금액";
	var cmpNm = " $ ";

	var result = this.gfn_chkEssItem("ds_ac_inc_evdc", colNm, korNm, cmpNm);
	if (result[0] != "success") {
		this.gfn_message("A", result[0]);
		
		/*
		this.ds_ac_inc_evdc.set_rowposition(result[1]);
		if(result[3] != ""){
			this.objects[result[3]].setFocus();
		}
		*/
		
		return false;	
	}
	
	for ( var i=0; i< this.ds_ac_inc_evdc.rowcount; i++ ) {
		if ( this.ds_ac_inc_evdc.getColumn(i, "incDiv") != "10"
			  && ( this.ds_ac_inc_evdc.getColumn(i, "addr") == "" || this.ds_ac_inc_evdc.getColumn(i, "addr") == null ) ) {
			this.gfn_message("A", "증빙구분이 [교내수당]이 아닐경우 주소는 필수 입력사항입니다.");  
			this.ds_ac_inc_evdc.set_rowposition(i);
			this.tab01.tabpage2.grid_ac_inc_evdc.setFocus();
			
			return false;
		}
		if ( this.gfn_isNull(this.ds_ac_inc_evdc.getColumn(i, "resNo")) && this.gfn_isNull(this.ds_ac_inc_evdc.getColumn(i, "foreignNo")) ) {
			this.gfn_message("A", "주민등록번호 또는 외국인번호를 입력하세요.");  
			this.ds_ac_inc_evdc.set_rowposition(i);
			this.tab01.tabpage2.grid_ac_inc_evdc.setFocus();
			
			return false;
		}
		if ( !this.gfn_isNull(this.ds_ac_inc_evdc.getColumn(i, "resNo")) ) {
			var strTemp = nexacro.trim(this.ds_ac_inc_evdc.getColumn(i, "resNo"));
			var strJumin = new String(strTemp);
			if( strJumin.length != 13 ) {
				this.gfn_message("A", "주민등록번호가 잘못되었습니다.");  
				this.ds_ac_inc_evdc.set_rowposition(i);
				this.tab01.tabpage2.grid_ac_inc_evdc.setFocus();
				 
				return false;
			}
		}
	
	}
	
	return true;
}

//원천세 저장 액션
this.fn_tab01_tabpage2_tab02_Save = function()
{	
	if(this.fn_tab01_tabpage2_tab02_preSave()) 
	{
		//this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"slipAmt",this.ds_det.getColumn(this.ds_det.rowposition,"slipAmt"));
		this.gfn_transaction("TABPAGE2_TAB02_SAVE",
							  "txComUrl::com/admi/ac02/saveAc02010p01_t01_03_purc.do",
							  "resultList=ds_ac_inc_evdc:u",
							  "",
							  "",
							 "fn_callBack");
	}
}

//원천세 저장 후처리
this.fn_tab01_tabpage2_tab02_postSave = function()
{
	this.gfn_message("A", "저장이 완료되었습니다.");
	
	//this.fn_tab01_tabpage2_tab02_Search();
	
// 	this.fn_tabList(
// 					"acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntYy")))
// 				   +" acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntUnt")))
// 				   +" vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouNo")))
// 				   +" vouSeq=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouSeq")))
// 					, this.tab01.tabindex
// 					);

	this.tab01.set_tabindex(1);
	this.fn_SearchDet()
	this.tab01_onchanged(); //이거
}









/*____________________________________________________________________________________________________________
	
	계좌내역(지급) CRUD
______________________________________________________________________________________________________________*/

//계좌내역(지급) 조회버튼 이벤트
this.tab01_tabpage3_btn_tab03_Search_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_tab01_tabpage3_tab03_Search();
}



//계좌내역(지급) 조회 전처리
this.fn_tab01_tabpage3_tab03_preSearch = function()
{
	return true;
}

//계좌내역(지급) 조회 액션
this.fn_tab01_tabpage3_tab03_Search = function()
{
	
	if(this.fn_tab01_tabpage3_tab03_preSearch()) 
	{
		var strArg  = "acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition, "acntYy")));
			strArg += " acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition, "acntUnt")));
			strArg += " vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition, "vouNo")));
	
		this.gfn_transaction("TABPAGE3_TAB03_SEARCH",
							 "txComUrl::com/admi/ac02/selectAc02010p01_t01_05.do",
							 "",
							 "ds_ac_pymt=resultList",
							 strArg,
							 "fn_callBack");
	}
}

//계좌내역(지급) 조회 후처리
this.fn_tab01_tabpage3_tab03_postSearch = function()
{
 	this.gfn_getDatasetCount(this.ds_ac_pymt, this.tab01.tabpage3.ds_ac_pymt_cnt);
}




//계좌내역(지급) 추가버튼 이벤트
this.tab01_tabpage3_btn_tab03_New_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.fn_tab01_tabpage3_tab03_New();
}

//계좌내역(지급) 추가 전처리
this.fn_tab01_tabpage3_tab03_preNew = function()
{
	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	return true;
}

//계좌내역(지급) 추가 액션
this.fn_tab01_tabpage3_tab03_New = function()
{
	if(this.fn_tab01_tabpage3_tab03_preNew()) 
	{
		this.gfn_addRow(this.ds_ac_pymt);
		
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "rowStatus", 2);

		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntYy", this.ds_det.getColumn(this.ds_det.rowposition, "acntYy"));	//회계년도
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "acntUnt", this.ds_det.getColumn(this.ds_det.rowposition, "acntUnt"));	
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "vouNo", this.ds_main.getColumn(this.ds_main.rowposition, "vouNo"));
 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "slipNo", this.ds_det.getColumn(this.ds_det.rowposition, "slipNo"));	
// 		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "slipSeq", this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq"));	
		
		
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "pymtDiv", "10"); //지급구분 예금(10)	
		
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bacctDiv", "10");	//계좌구분(10:거래처)
		
		this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "pymtMsg", "동의대");	//입금메시지 추가 16.04.28 라병수
	}
}




//계좌내역(지급) 삭제버튼 이벤트
this.tab01_tabpage3_btn_tab03_Del_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	this.gfn_deleteRow(this.ds_ac_pymt, "this.fn_tab01_tabpage3_tab03_Del()");
}

//계좌내역(지급) 삭제 전처리
this.fn_tab01_tabpage3_tab03_preDel = function()
{
	return true;
}

//계좌내역(입금) 삭제 액션
this.fn_tab01_tabpage3_tab03_Del = function()
{	
	if(this.fn_tab01_tabpage3_tab03_preDel()) 
	{
		this.gfn_transaction("TABPAGE3_TAB03_DEL",
							  "txComUrl::com/admi/ac02/saveAc02010p01_t01_05.do",
							  "resultList=ds_ac_pymt:u",
							  "",
							  "",
							 "fn_callBack");
	}
}

//계좌내역(지급) 삭제 후처리
this.fn_tab01_tabpage3_tab03_postDel = function()
{
	this.gfn_message("A", "삭제가 완료되었습니다.");
	
	//this.fn_tab01_tabpage2_tab02_Search();
	
	this.tab01.set_tabindex(2);
	this.tab01_onchanged(); //이거
}




//계좌내역(지급) 저장버튼 이벤트
this.tab01_tabpage3_btn_tab03_Save_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	//계정내역 데이터 체크
// 	if(this.ds_ac_vou_det.rowcount < 1)
// 	{
// 		this.gfn_message("A", "선택된 계정내역이 없습니다.");
// 		return false;
// 	}
// 	
// 	if(this.ds_ac_vou_det.getCaseCount("rowStatus == 2 || rowStatus == 4") != 0)
// 	{
// 		this.gfn_message("A", "계정내역을 먼저 저장 하십시오.");
// 		return false;
// 	}
	
	this.fn_tab01_tabpage3_tab03_Save();
}

//계좌내역(지급) 저장 전처리
this.fn_tab01_tabpage3_tab03_preSave = function()
{	
	if(!this.gfn_isUpdate(this.ds_ac_pymt)){
		this.gfn_message("A", "변경된 데이터가 없습니다.");
		return false;
	}

 	//데이터 중복 체크
	if(!this.gfn_chkValidation("ds_ac_pymt", "acntUnt$acntYy$vouNo$pymtSeq", "회계단위, 회계연도, 결의번호, 지급순번")){
		return false;
	}
		
 	//필수값 입력 체크
	var colNm = "bacctDiv$bankCd$acntNo$deposr$pymtAmt";
	var korNm = "*계좌구분$*은행코드$*계좌번호$*예금주$*지급금액";
	var cmpNm = " $ ";

	var result = this.gfn_chkEssItem("ds_ac_pymt", colNm, korNm, cmpNm);
	if (result[0] != "success") {
		this.gfn_message("A", result[0]);
		
		/*
		this.ds_ac_inc_evdc.set_rowposition(result[1]);
		if(result[3] != ""){
			this.objects[result[3]].setFocus();
		}
		*/
		
		return false;	
	}
	
	return true;
}

//계좌내역(지급) 저장 액션
this.fn_tab01_tabpage3_tab03_Save = function()
{	
	//지급구분이 예금(10) 일때는 기존로직대로 필수체크를 하고 저장
	//지급구분이 현금(20) 일때는 필수값들 입력안하고 금액만 입력할수 있도록 전처리 생략
	if(this.ds_ac_pymt.getColumn(this.ds_ac_pymt.rowposition,"pymtDiv") == "10" ){
		if(this.fn_tab01_tabpage3_tab03_preSave()) 
		{
			this.gfn_transaction("TABPAGE3_TAB03_SAVE",
								  "txComUrl::com/admi/ac02/saveAc02010p01_t01_05.do",
								  "resultList=ds_ac_pymt:u",
								  "",
								  "",
								 "fn_callBack");
		}
	}else{
		this.gfn_transaction("TABPAGE3_TAB03_SAVE",
								  "txComUrl::com/admi/ac02/saveAc02010p01_t01_05.do",
								  "resultList=ds_ac_pymt:u",
								  "",
								  "",
								 "fn_callBack");
	}
}

//계좌내역(지급) 저장 후처리
this.fn_tab01_tabpage3_tab03_postSave = function()
{
	this.gfn_message("A", "저장이 완료되었습니다.");
	
	//this.fn_tab01_tabpage2_tab02_Search();
	
// 	this.fn_tabList(
// 					"acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntYy")))
// 				   +" acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "acntUnt")))
// 				   +" vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouNo")))
// 				   +" vouSeq=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_ac_vou_det.getColumn(this.ds_ac_vou_det.rowposition, "vouSeq")))
// 					, this.tab01.tabindex
// 					);

	this.tab01.set_tabindex(2);
	this.tab01_onchanged(); //이거
}


this.tab01_onchanged = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
	
	if(this.tab01.tabindex == 0){
		this.fn_SearchSub();
	}else{
		this.fn_tabList(
						"acntYy=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_YY))
					   +" acntUnt=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_ACNT_UNT))
					   +" slipNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition, "slipNo")))
					   +" slipSeq=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(this.ds_det.getColumn(this.ds_det.rowposition, "slipSeq")))
					   +" vouNo=" + nexacro.wrapQuote(this.gfn_getNullToEmpty(F_VOU_NO))
						, this.tab01.tabindex
						);
	}					
}


/*____________________________________________________________________________________________________________
	
	탭별 세부사항 조회 (sub search)
______________________________________________________________________________________________________________*/

this.fn_tabList = function(strArg, strIndex)
{	
	var trId = "";
	var selectUrl = "";
	var dataSet = "";
	
	if(strIndex == 1)	//원천세
	{
		trId = "TABPAGE2_TAB02_SEARCH";
		selectUrl = "txComUrl::com/admi/ac02/selectAc02030_t03_01.do";	//selectAc02010p01_t01_03	                                     
		dataSet = "ds_ac_inc_evdc";
	}
	else if(strIndex == 2)	//계좌내역(지급)
	{
		trId = "TABPAGE3_TAB03_SEARCH";
		selectUrl = "txComUrl::com/admi/ac02/selectAc02020_t04_02.do";// selectAc02010p01_t01_05
		dataSet = "ds_ac_pymt";
	}
	else
	{
		return true;
	}
	
	this.gfn_transaction(trId,
						 selectUrl,
						 "",
						 dataSet + "=resultList",
						 strArg,
						 "fn_callBack");
				
}

//원천세 drop obj
this.tab01_tabpage2_grid_ac_inc_evdc_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	this.tab01.tabpage2.grid_ac_inc_evdc.dropdownCombo();
	this.tab01.tabpage2.grid_ac_inc_evdc.dropdownCalendar();
}

//원천세 그리드 팝업
this.tab01_tabpage2_grid_ac_inc_evdc_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	//신고대상자조회팝업
	if(e.cell == 7)
	{
		//기타수당(교직원조회팝업)
		if(this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition, "incDiv") == 10)
		{
			var strParam = {
						  nm:""
						, autoSearch:true
						, autoClose:false
						};
						   
			this.cfn_comUserPopup(strParam,"fn_popCallback");
		}
		//기타수당(기타소득자조회팝업)
		else
		{
			var strParam = {
						  acntUnt:this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition, "acntUnt")
						, incDiv:this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition, "incDiv")
						, autoSearch:true
						, autoClose:false
						};
			
			this.cfn_comEtcIncUserPopup(strParam,"fn_popCallback");
		}
	}
	//첨부파일등록
	else if(e.cell == 25)
	{
		var strParam = {fileMasterNo:this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition, "fileId")
						};
		this.cfn_fileUpDownloadPop(strParam,"fn_fileIncPopCallBack");
		

	}
	//거주국가조회
	else if(e.cell == 14)
	{
		var strParam = {
						  resiCnty:""
						, resiCntyNm:""
						, autoSearch:true
						, autoClose:true
						};
			
		this.cfn_comResiCntyPopup(strParam,"fn_popCallback");
	}
	//우편번호(주소)조회
	else if(e.cell == 16)
	{
		var strParam = {
						  sidoGb:""
						, doroZipNm:""
						, autoSearch:false
						, autoClose:true
						};
			
		this.cfn_zipPopup(strParam,"fn_popCallback");
	}
}

/********************************************************************************
 * 함 수 명 	: fn_fileIncPopCallBack
 * 함수설명 	: 계정내역팝업콜백(기존).
********************************************************************************/
this.fn_fileIncPopCallBack = function(strID, rtnVal)
{

	this.ds_dummy.clear();
	this.ds_dummy.loadXML(rtnVal);

	if(rtnVal != "close" && rtnVal != "" && rtnVal != "undefined"){
		if(!this.gfn_isNull(this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition,"fileId"))){

			if(this.ds_ac_inc_evdc.getColumn(this.ds_ac_inc_evdc.rowposition,"fileId") != this.ds_dummy.getColumn(0, "fileMasterNo")){
			
				this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"fileId",this.ds_dummy.getColumn(0, "fileMasterNo"));
				this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"orgFileNm",this.ds_dummy.getColumn(0, "filename"));
				//this.fn_tab02_tabpage2_tab02_Save_file();
			}
	 	}else{

	 		this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"fileId",this.ds_dummy.getColumn(0, "fileMasterNo"));
			this.ds_ac_inc_evdc.setColumn(this.ds_ac_inc_evdc.rowposition,"orgFileNm",this.ds_dummy.getColumn(0, "filename"));
	 	}
	}
	
		
}

//계좌내역(지급) drop obj
this.tab01_tabpage3_grid_ac_pymt_oncellclick = function(obj:Grid, e:nexacro.GridClickEventInfo)
{
	this.tab01.tabpage3.grid_ac_pymt.dropdownCombo();
}

//계좌내역(지급) 초기값 정의
this.ds_ac_pymt_oncolumnchanged = function(obj:Dataset, e:nexacro.DSColChangeEventInfo)
{
	if(e.columnid == "bacctDiv")
	{
		//은행코드Cell
		this.ds_ac_pymt.setColumn(e.row, "bankCd", "");
		
		//계좌번호Cell
		this.ds_ac_pymt.setColumn(e.row, "acntNo", "");
		
		//예금주Cell
		this.ds_ac_pymt.setColumn(e.row, "deposr", "");
		
		//지급금액Cell
		//this.ds_ac_pymt.setColumn(e.row, "pymtAmt", "");
	}else if(e.columnid == "pymtDiv"){
		if(this.ds_ac_pymt.getColumn(this.ds_ac_pymt.rowposition, "pymtDiv") == "20") {
			this.ds_ac_pymt.setColumn(this.ds_ac_pymt.rowposition, "bacctDiv", "");	
		}
	}
	
	
}

//계좌내역(지급) 그리드 팝업
this.tab01_tabpage3_grid_ac_pymt_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	//은행조회팝업
	if(e.cell == 6)
	{
		var strParam = {bankCdNm:""
		               ,autoClose:true
		               ,autoSearch:true
		               };
		this.cfn_bankPopup(strParam,"fn_popCallback");
	}
	//계좌조회팝업
	else if(e.cell == 9)
	{
		var sBacctDiv = "";
		sBacctDiv = this.ds_ac_pymt.getColumn(this.ds_ac_pymt.rowposition, "bacctDiv")
		
		//거래처계좌조회팝업
		if(sBacctDiv == "10")
		{
			var strParam = {vendNm:""
						   ,acntNo:""
						   ,autoClose:true
						   ,autoSearch:true
						   };
			this.cfn_comVendAcntNoPopup(strParam,"fn_popCallback");
		}
		
		//교직원계좌조회팝업
		else if(sBacctDiv == "20")
		{
			var strParam = {nm:""
						   ,deposr:""
						   ,deptCdNm:""
						   ,autoClose:true
						   ,autoSearch:true
						   };
			this.cfn_comEmpAcntNoPopup(strParam,"fn_popCallback");
		}
		
		//2016-03-10
		//(자체)계좌조회팝업 => (부외)계좌조회팝업
		else if(sBacctDiv == "30")
		{
			var strParam = {acntNo:""
						   ,autoClose:true
						   ,autoSearch:true
						   };
			this.cfn_acntNoPopup30(strParam,"fn_popCallback");
		}
		
		//기타계좌조회팝업
		else if(sBacctDiv == "90")
		{
			var strParam = {deposr:""
						   ,acntNo:""
						   ,autoClose:true
						   ,autoSearch:true
						   };
			this.cfn_comEtcAcntNoPopup(strParam,"fn_popCallback");
		}
	}
}


this.btn_refresh_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	this.reload();
}

this.tab01_canchange = function(obj:Tab, e:nexacro.TabIndexChangeEventInfo)
{
	if(this.ds_main.rowposition < 0 ) {
		this.gfn_message("A", "전표내역이 없습니다.");
		return false;
	}

	if(this.gfn_isUpdate(this.ds_ac_bill_evdc) || this.gfn_isUpdate(this.ds_ac_inc_evdc) || this.gfn_isUpdate(this.ds_ac_pymt))
	{
		var strMsg = "변경된 데이타가 있습니다. 저장 하지 않고 이동 하시겠습니까?";
		if(!this.gfn_message("C", strMsg)){
			return false;
		}else{
			return true;
		}
	}
	
}

this.btn_elecSearch_onclick = function(obj:Button,  e:nexacro.ClickEventInfo)
{
	if(this.gfn_isNull(this.ds_main.getColumn(this.ds_main.rowposition,"slipApprovalDocid"))) {
		this.gfn_message("A", "연결된 문서가 없습니다.");
		return;
	}
	
	system.execBrowser("https://gw.deu.ac.kr/frmLinkageTransfer11.aspx?docid="+this.ds_main.getColumn(this.ds_main.rowposition,"slipApprovalDocid")+"&userid="+application.gds_user.getColumn(application.gds_user.rowposition,"memberNo"));
}

this.grd_main_onexpandup = function(obj:Grid, e:nexacro.GridMouseEventInfo)
{
	var argumentsList = new Array();
		argumentsList['jukyo']   = this.ds_main.getColumn(this.ds_main.rowposition, "jukyo");
		argumentsList['sdVendorDesc']   = this.ds_main.getColumn(this.ds_main.rowposition, "sdVendorDesc");
		argumentsList['modYn']   = this.btn_save.visible? "Y" :"N";

	var popupId = "ac02020_p01";
	var popupUrl = "ac02::ac02020_p01.xfdl";
	var popupCallback = "fn_jukyoPopCallBack";

	this.gfn_popupOpen(popupId, argumentsList, popupUrl, popupCallback,1200,600, this);
}

this.fn_jukyoPopCallBack = function(strID, rtnVal)
{
	if(rtnVal == "close" || rtnVal == "" || rtnVal == "undefined"){
		return;
	}

	var objArr;
    objArr = rtnVal.split("::");

	this.ds_main.setColumn(this.ds_main.rowposition, "jukyo", objArr[0]);
	this.ds_main.setColumn(this.ds_main.rowposition, "sdVendorDesc", objArr[1]);
}
]]></Script>
  </Form>
</FDL>
