<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="AdmiSQL">

    <typeAlias alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
    
    <select id="admiDAO.selectAcntYy" parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectAcntYy 회계연도 호출 */
 		 SELECT year(getdate()) - CASE WHEN month(getdate()) IN ('1', '2') THEN 1 ELSE 0 END AS acnt_yy
 		       ,CONVERT(VARCHAR(10),CONVERT(INT,year(getdate())) - CONVERT(INT,CASE WHEN month(getdate()) IN ('1', '2') THEN 1 ELSE 0 END)) + CONVERT(VARCHAR(4),'0301') as acnt_fr_dt
 			   ,CONVERT(VARCHAR(10),CONVERT(INT,year(getdate())) + CONVERT(INT,CASE WHEN month(getdate()) IN ('1', '2') THEN 0 ELSE 1 END))
 			   +SUBSTRING(CONVERT(CHAR(10),DATEADD(s, -1, DATEADD(mm, DATEDIFF(m, 0, CONVERT(VARCHAR(10),CONVERT(INT,year(getdate())) 
 			   + CONVERT(INT,CASE WHEN month(getdate()) IN ('1', '2') THEN 0 ELSE 1 END))+CONVERT(VARCHAR(4),'0201') )+1, 0)) , 112),5,4) as acnt_to_dt
		  
	</select>
    
    <select id="admiDAO.selectAcntUntCmb"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectAcntUntCmb 회계단위콤보 호출 */
        
        <isEqual property="strType" compareValue="S">
         SELECT '' AS ACNT_UNT /* 회계단위ID */
	           ,'' AS ACNT_UNT_NM /* 회계단위명 */
	           ,'' AS CD /* 회계단위ID */
	           ,'선택' AS NM /* 회계단위명 */
	           ,0 AS SORT_ORD    
         UNION ALL
        </isEqual>
        
        <isEqual property="strType" compareValue="T">
         SELECT '' AS ACNT_UNT /* 회계단위ID */
	           ,'' AS ACNT_UNT_NM /* 회계단위명 */
	           ,'' AS CD /* 회계단위ID */
	           ,'전체' AS NM /* 회계단위명 */
	           ,0 AS SORT_ORD  
         UNION ALL
        </isEqual>
        SELECT ACNT_UNT
		      ,ACNT_UNT_NM
		      ,CD
		      ,NM
		      ,SORT_ORD
		  FROM
		(
        SELECT DISTINCT bu.acnt_unt /* 회계단위ID */
	          ,bu.acnt_unt_nm /* 회계단위명 */
	          ,bu.acnt_unt as cd /* 회계단위ID */
	          ,bu.acnt_unt_nm as nm /* 회계단위명 */
	          ,bu.sort_ord
          FROM (SELECT acnt_unt
                      ,acnt_unt AS add_acnt_unt
                  FROM BG_UNT  WITH(NOLOCK)
                UNION ALL
                SELECT acnt_unt
                      ,add_acnt_unt
                  FROM BG_UNT_ADD WITH(NOLOCK)) bua /* 회계단위+합산회계단위*/
              ,(SELECT DISTINCT bu.acnt_unt   /*회계단위ID*/
	                  ,bu.acnt_unt_nm  /*회계단위명*/
	                  ,bu.acnt_unt AS cd   /*회계단위ID*/
	                  ,bu.acnt_unt_nm AS nm  /*회계단위명*/
	                  ,bu.sort_ord
                  FROM BG_UNT bu  WITH(NOLOCK)
                  		LEFT OUTER JOIN BG_UNT_PERM bup WITH(NOLOCK)
                          ON bu.acnt_unt = bup.acnt_unt
                 WHERE 1 = 1
               ) bupa /* 권한체크하는부분포함 */
              ,BG_UNT bu
         WHERE bua.add_acnt_unt = bupa.acnt_unt
           AND bua.acnt_unt = bu.acnt_unt  
           <isNotEmpty property="acntYy">
           AND #acntYy# BETWEEN CASE WHEN bu.cre_yy IS NULL OR bu.cre_yy = '' THEN '1900' ELSE bu.cre_yy END AND CASE WHEN bu.close_yy IS NULL OR bu.close_yy = '' THEN '9999' ELSE bu.close_yy END
           </isNotEmpty>
           <isNotEmpty property="useYn">
           AND bu.use_yn = #useYn#
           </isNotEmpty>
           <isNotEqual property="addYn" compareValue="1">
           AND bu.add_yn = #addYn#
           </isNotEqual> 
          ) A
       ORDER BY sort_ord
    </select>
    
    <!-- 회계단위(상세정보탭) 조회 -->
    <select id="admiDAO.selectAcntUntList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    	/* admiDAO.selectAcntUntList 회계단위(상세정보탭) 조회 */
    	SELECT '0' AS chk
              ,'' AS row_status
    	      ,bu.acnt_unt
			  ,bu.acnt_unt_nm
			  ,bu.add_yn
			  ,bu.univ_nm
			  ,bu.univ_enm
			  ,bu.prsdt_nm
			  ,bu.biz_reg_no
			  ,bu.corp_no
			  ,bu.tel_no
			  ,bu.zip_no
			  ,bu.addr
			  ,bu.addr_det
			  ,bu.addr_eng
			  ,bu.wkty
			  ,bu.knd
			  ,bu.txofc_no
			  ,bu.txofc_nm
			  ,bu.use_yn
			  ,bu.cre_yy
			  ,bu.close_yy
			  ,bu.sort_ord
			  ,bu.rmk
		 FROM BG_UNT bu WITH(NOLOCK)
		ORDER BY bu.sort_ord, bu.acnt_unt

    </select>
    
    <!-- 회계단위(상세정보탭) 등록 -->
    <insert id="admiDAO.insertAcntUntList" parameterClass="java.util.HashMap">
	    <![CDATA[
	    INSERT INTO BG_UNT
	    	  (acnt_unt   
			  ,acnt_unt_nm
			  ,add_yn     
			  ,univ_nm    
			  ,univ_enm   
			  ,prsdt_nm   
			  ,biz_reg_no 
			  ,corp_no    
			  ,tel_no     
			  ,zip_no     
			  ,addr       
			  ,addr_det   
			  ,addr_eng   
			  ,wkty       
			  ,knd        
			  ,txofc_no   
			  ,txofc_nm   
			  ,use_yn     
			  ,cre_yy     
			  ,close_yy   
			  ,sort_ord   
			  ,rmk
			  ,insert_dt
			  ,insert_id
			  ,insert_ip
			  ,insert_pgm        
	    	  )VALUES(
	    	  #acntUnt#   
			 ,#acntUntNm#
			 ,#addYn#     
			 ,#univNm#    
			 ,#univEnm#   
			 ,#prsdtNm#  
			 ,#bizRegNo# 
			 ,#corpNo#    
			 ,#telNo#     
			 ,#zipNo#     
			 ,#addr#       
			 ,#addrDet#   
			 ,#addrEng#   
			 ,#wkty#       
			 ,#knd#        
			 ,#txofcNo#   
			 ,#txofcNm#   
			 ,#useYn#     
			 ,#creYy#     
			 ,#closeYy#   
			 ,CONVERT(INT, #sortOrd#)   
			 ,#rmk#  
			 ,GETDATE()
			 ,#insertId#
			 ,#insertIp#
			 ,'bg01010'          
	    	 )
			    
	    ]]>
    </insert>
    
    <!-- 회계단위(상세정보탭) 수정 -->
    <update id="admiDAO.updateAcntUntList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		UPDATE BG_UNT
    		SET    acnt_unt_nm = #acntUntNm#
			      ,add_yn      = #addYn#
			      ,univ_nm     = #univNm#
			      ,univ_enm    = #univEnm#
			      ,prsdt_nm    = #prsdtNm#
			      ,biz_reg_no  = #bizRegNo#
			      ,corp_no     = #corpNo#
			      ,tel_no      = #telNo#
			      ,zip_no      = #zipNo#
			      ,addr        = #addr#
			      ,addr_det    = #addrDet#
			      ,addr_eng    = #addrEng#
			      ,wkty        = #wkty#
			      ,knd         = #knd#
			      ,txofc_no    = #txofcNo#
			      ,txofc_nm    = #txofcNm#
			      ,use_yn      = #useYn#
			      ,cre_yy      = #creYy#
			      ,close_yy    = #closeYy#
			      ,sort_ord    = CONVERT(INT, #sortOrd#)
			      ,rmk         = #rmk#
			      ,update_dt   = GETDATE()
			      ,update_id   = #updateId#
			      ,update_ip   = #updateIp#
			      ,update_pgm  = 'bg01010'
			WHERE acnt_unt     = #acntUnt#
    	]]>
    </update>
    
    <!-- 회계단위(상세정보탭) 삭제 -->
    <delete id="admiDAO.deleteAcntUntList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		DELETE
    		  FROM BG_UNT
    		 WHERE acnt_unt     = #acntUnt#
    	]]>
    </delete>
    
    <!-- 회계단위(권한탭) 조회 -->
    <select id="admiDAO.selectAcntPermList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    	/* admiDAO.selectAcntPermList 회계단위(권한탭) 조회 */
    	SELECT '0' AS chk
    	      ,'' AS row_status 
    	      ,bu.acnt_unt
    	      ,bu.acnt_unt_nm
			  ,bup.perm_id
			  ,bup.perm_id AS perm_id_key
		      ,bup.mgt_cd
		  FROM BG_UNT bu WITH(NOLOCK)
		      ,BG_UNT_PERM bup WITH(NOLOCK)
		 WHERE bu.acnt_unt = bup.acnt_unt
		   AND bu.acnt_unt = #acntUnt#
		 ORDER BY bu.acnt_unt
    </select>
    
    <!-- 회계단위(권한탭) 등록 -->
    <insert id="admiDAO.insertAcntPermList" parameterClass="java.util.HashMap">
	    <![CDATA[
	    INSERT INTO BG_UNT_PERM
	    	  (acnt_unt   
			  ,perm_id
			  ,mgt_cd     
			  ,insert_dt
			  ,insert_id
			  ,insert_ip
			  ,insert_pgm         
	    	  )VALUES(
	    	  #acntUnt#   
			 ,#permId#
			 ,#mgtCd#     
			 ,GETDATE()
			 ,#insertId#
			 ,#insertIp#
			 ,'bg01010'                 
	    	 )
			    
	    ]]>
    </insert>
    
    <!-- 회계단위(권한탭) 수정 -->
    <update id="admiDAO.updateAcntPermList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		UPDATE BG_UNT_PERM
    		SET    acnt_unt    = #acntUnt#
			      ,perm_id     = #permId#
			      ,mgt_cd      = #mgtCd#
			      ,update_dt   = GETDATE()
			      ,update_id   = #updateId#
			      ,update_ip   = #updateIp#
			      ,update_pgm  = 'bg01010' 
			WHERE acnt_unt     = #acntUnt#
			  AND perm_id	   = #permIdKey#
    	]]>
    </update>
    
    <!-- 회계단위(권한탭) 삭제 -->
    <delete id="admiDAO.deleteAcntPermList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		DELETE
    		  FROM BG_UNT_PERM
    		 WHERE acnt_unt = #acntUnt#
    		   AND perm_id	= #permId#
    	]]>
    </delete>
    
    <!-- 회계단위(합산회계탭) 조회 -->
    <select id="admiDAO.selectAcntAddList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    	/* admiDAO.selectAcntAddList 회계단위(합산회계탭) 조회 */
    	SELECT '0' AS chk
    	      ,'' AS row_status 
    	      ,bua.acnt_unt
    	      ,bua.add_acnt_unt
    	      ,bua.add_acnt_unt AS add_acnt_unt_key
    	  FROM BG_UNT_ADD bua WITH(NOLOCK)
    	 WHERE bua.acnt_unt = #acntUnt#
    	 ORDER BY bua.acnt_unt
    </select>
    
    <!-- 회계단위(합산회계탭) 등록 -->
    <insert id="admiDAO.insertAcntAddList" parameterClass="java.util.HashMap">
	    <![CDATA[
	    INSERT INTO BG_UNT_ADD
	    	  (acnt_unt   
			  ,add_acnt_unt
			  ,insert_dt
			  ,insert_id
			  ,insert_ip
			  ,insert_pgm         
	    	  )VALUES(
	    	  #acntUnt#   
			 ,#addAcntUnt#
			 ,GETDATE()
			 ,#insertId#
			 ,#insertIp#
			 ,'bg01010'            
	    	 )
			    
	    ]]>
    </insert>
    
    <!-- 회계단위(합산회계탭) 수정 -->
    <update id="admiDAO.updateAcntAddList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		UPDATE BG_UNT_ADD
    		SET    acnt_unt     = #acntUnt#
			      ,add_acnt_unt = #addAcntUnt#
			      ,update_dt    = GETDATE()
			      ,update_id   = #updateId#
			      ,update_ip   = #updateIp#
			      ,update_pgm  = 'bg01010' 
			WHERE acnt_unt      = #acntUnt#
			  AND add_acnt_unt  = #addAcntUntKey#
    	]]>
    </update>
    
    <!-- 회계단위(합산회계탭) 삭제 -->
    <delete id="admiDAO.deleteAcntAddList" parameterClass="java.util.HashMap">
    	<![CDATA[
    		DELETE
    		  FROM BG_UNT_ADD
    		 WHERE acnt_unt     = #acntUnt#
    		   AND add_acnt_unt = #addAcntUnt#
    	]]>
    </delete>
    
    
    <!--
    #########################################################################################################################################
    # 계정코드등록(bg01020)                                                                                                               
    #########################################################################################################################################
    -->
    
    
    <select id="admiDAO.selectAcntList"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectAcntList 계정내역을 조회 */
		WITH CTE_ACNT_CD
		AS
		(
			SELECT bac1.acnt_unt /* 회계단위ID */
	              , bac1.acnt_yy /* 회계년도 */
	              , bac1.acnt_cd /* 계정과목코드 */
	              , 1 AS tree_level
	              , convert(varchar(200), bac1.acnt_cd) as acnt_ord
	              , bac1.purp_profit_div_cd /* 목적수익구분코드 */
	              , bac1.acnt_nm /* 계정과목명 */
	              , bac1.acnt_lvl /* 계정레벨코드 */
	              , bac1.upr_acnt_cd /* 상위계정과목코드 */
	              , bac1.acnt_inc_nm /* 수입예산명 */
	              , bac1.acnt_exp_nm /* 지출예산명 */
	              , bac1.drcr_cd /* 차대구분코드 */
	              , bac1.intl_trans_cd /* 내부거래여부 */
	              , bac1.usage_cd /* 용도구분 */
	              , bac1.bf_acnt_cd /* 전년도계정과목코드 */
	              , bac1.use_yn /* 사용여부 */
	              , bac1.exp_suspn_yn /* 수입가계정여부 */
	   			  , bac1.inc_suspn_yn /* 지출가계정여부 */
	              , bac1.rmk /* 계정과목설명 */
	           FROM BG_ACNT_CD bac1 WITH(NOLOCK)
	           			LEFT OUTER JOIN BG_ACNT_CD bac2 WITH(NOLOCK)
                	  ON    bac1.acnt_unt    = bac2.acnt_unt
                        AND bac1.acnt_yy     = bac2.acnt_yy
                        AND bac1.upr_acnt_cd = bac2.acnt_cd
                    LEFT OUTER JOIN BG_ACNT_CD bac3 WITH(NOLOCK)
			          ON    bac1.acnt_unt    = bac3.acnt_unt
			            AND bac1.acnt_yy - 1 = bac3.acnt_yy
			            AND bac1.acnt_cd     = bac3.acnt_cd
	          WHERE bac1.acnt_unt    = #acntUnt#
	            AND bac1.acnt_yy    = #acntYy#
	            AND isnull(bac1.upr_acnt_cd, '') = ''
		     
		     UNION ALL 
		
			SELECT  bac1.acnt_unt /* 회계단위ID */
	              , bac1.acnt_yy /* 회계년도 */
	              , bac1.acnt_cd /* 계정과목코드 */
	              , cte.tree_level + 1 as tree_level
	              , convert(varchar(200), convert(varchar(200), cte.acnt_ord) + convert(varchar(200), bac1.acnt_cd)) as acnt_ord
	              , bac1.purp_profit_div_cd /* 목적수익구분코드 */
	              , bac1.acnt_nm /* 계정과목명 */
	              , bac1.acnt_lvl /* 계정레벨코드 */
	              , bac1.upr_acnt_cd /* 상위계정과목코드 */
	              , bac1.acnt_inc_nm /* 수입예산명 */
	              , bac1.acnt_exp_nm /* 지출예산명 */
	              , bac1.drcr_cd /* 차대구분코드 */
	              , bac1.intl_trans_cd /* 내부거래여부 */
	              , bac1.usage_cd /* 용도구분 */
	              , bac1.bf_acnt_cd /* 전년도계정과목코드 */
	              , bac1.use_yn /* 사용여부 */
	              , bac1.exp_suspn_yn /* 수입가계정여부 */
	   			  , bac1.inc_suspn_yn /* 지출가계정여부 */
	              , bac1.rmk /* 계정과목설명 */
	           FROM BG_ACNT_CD bac1 WITH(NOLOCK)
	           	    JOIN CTE_ACNT_CD cte
	           			 on   bac1.upr_acnt_cd = cte.acnt_cd
	           			  and bac1.acnt_unt = cte.acnt_unt
	           			  and bac1.acnt_yy = cte.acnt_yy 
	          WHERE bac1.acnt_unt    = #acntUnt#
	            AND bac1.acnt_yy    = #acntYy#
		)
		SELECT '0' as chk
		     , '' as row_status
		     , cte.tree_level as acct_tree_lvl
             , cte.acnt_unt
             , cte.acnt_yy
             , cte.acnt_cd
             , cte.purp_profit_div_cd
             , cte.acnt_nm
             , cte.acnt_lvl
             , cte.upr_acnt_cd
             , bac2.acnt_nm as upr_acnt_nm /* 상위계정과목명 */
             , cte.acnt_inc_nm
             , cte.acnt_exp_nm
             , cte.drcr_cd
             , cte.intl_trans_cd
             , cte.usage_cd
             , cte.bf_acnt_cd
             , bac3.acnt_nm as preyy_acnt_nm /* 전년도계정과목명 */
             , cte.use_yn
             , cte.exp_suspn_yn
             , cte.inc_suspn_yn
             , cte.rmk
             , 'false' as enable_flg
          FROM CTE_ACNT_CD cte
          	       LEFT OUTER JOIN BG_ACNT_CD bac2 WITH(NOLOCK)
                	  ON    cte.acnt_unt    = bac2.acnt_unt
                        AND cte.acnt_yy     = bac2.acnt_yy
                        AND cte.upr_acnt_cd = bac2.acnt_cd
                    LEFT OUTER JOIN BG_ACNT_CD bac3 WITH(NOLOCK)
			          ON    cte.acnt_unt    = bac3.acnt_unt
			            AND cte.acnt_yy - 1 = bac3.acnt_yy
			            AND cte.acnt_cd     = bac3.acnt_cd
	     WHERE (cte.acnt_nm like '%' + #acntNm# + '%'
                OR  cte.acnt_cd like #acntNm# + '%')
         ORDER BY cte.acnt_ord
    </select>
    
    <select id="admiDAO.selectItmSeqList"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectItmSeqList 세세목내역을 조회 */
		SELECT '0' as chk
		     , '' as row_status
		     , acnt_unt	/* 회계단위id */
			 , acnt_yy	/* 회계년도 */
			 , acnt_cd	/* 계정과목코드 */
			 , bal_div	/* 수지구분 */
			 , itm_seq	/* 세세목 */
			 , itm_seq_nm	/* 세세목명 */
			 , use_yn	/* 사용여부 */
			 , rmk	/* 비고 */
		  FROM BG_ITM_SEQ WITH(NOLOCK)
		 WHERE 1 = 1
           AND acnt_unt = #acntUnt# /* 회계단위 */
           AND acnt_yy = #acntYy# /* 회계년도 */
           AND acnt_cd = #acntCd# /* 계정과목코드 */
    </select>
    
    <insert id="admiDAO.insertAcntList" parameterClass="java.util.HashMap">
    	/* admiDAO.insertAcntList 계정내역을 저장 */
        INSERT INTO BG_ACNT_CD (	
		        acnt_unt	/* 회계단위id */
			   ,acnt_yy	/* 회계년도 */
			   ,acnt_cd	/* 계정과목코드 */
			   ,acnt_nm	/* 계정과목명 */
			   ,acnt_inc_nm	/* 계정수입명 */
			   ,acnt_exp_nm	/* 계정지출명 */
			   ,acnt_lvl	/* 계정레벨 */
			   ,upr_acnt_cd	/* 상위계정과목코드 */
			   ,drcr_cd	/* 차대구분 */
			   ,intl_trans_cd	/* 내부거래구분 */
			   ,usage_cd	/* 용도구분 */
			   ,bf_acnt_cd	/* 전년도계정과목코드 */
			   ,purp_profit_div_cd	/* 목적수익구분코드 */
			   ,use_yn	/* 사용여부 */
			   ,exp_suspn_yn	/* 수입가계정여부 */
			   ,inc_suspn_yn	/* 지출가계정여부 */
			   ,rmk	/* 비고 */
			   ,insert_dt	/* 입력일시 */
			   ,insert_id	/* 입력아이디 */
			   ,insert_ip	/* 입력아이피 */
			   ,insert_pgm	/* 입력프로그램 */)
		    VALUES (
		        #acntUnt#
		       ,#acntYy#
		       ,#acntCd#
		       ,#acntNm#
		       ,#acntIncNm#
		       ,#acntExpNm#
		       ,#acntLvl#
		       ,#uprAcntCd#
		       ,#drcrCd#
		       ,#intlTransCd#
		       ,#usageCd#
		       ,#bfAcntCd#
		       ,#purpProfitDivCd#
		       ,#useYn#
		       ,#expSuspnYn#
		       ,#incSuspnYn#
		       ,#rmk#
		       ,GETDATE()
			   ,#insertId#
			   ,#insertIp#
			   ,#insertPgm#)
    </insert>
    
    <update id="admiDAO.updateAcntList" parameterClass="java.util.HashMap">
    	/* admiDAO.updateAcntList 계정내역을 수정 */
        UPDATE BG_ACNT_CD
		   SET acnt_nm = #acntNm#	/* 계정과목명 */
		     , acnt_inc_nm = #acntIncNm#	/* 계정수입명 */
		     , acnt_exp_nm = #acntExpNm#	/* 계정지출명 */
		     , acnt_lvl = #acntLvl#	/* 계정레벨 */
		     , upr_acnt_cd = #uprAcntCd#	/* 상위계정과목코드 */
		     , drcr_cd = #drcrCd#	/* 차대구분 */
		     , intl_trans_cd = #intlTransCd#	/* 내부거래구분 */
		     , usage_cd = #usageCd#	/* 용도구분 */
		     , bf_acnt_cd = #bfAcntCd#	/* 전년도계정과목코드 */
		     , purp_profit_div_cd = #purpProfitDivCd#	/* 목적수익구분코드 */
		     , use_yn = #useYn#	/* 사용여부 */
		     , exp_suspn_yn = #expSuspnYn#	/* 수입가계정여부 */
		     , inc_suspn_yn = #incSuspnYn#	/* 지출가계정여부 */
		     , rmk = #rmk#	/* 비고 */
		     , update_dt = GETDATE()	/* 수정일시 */
		     , update_id = #updateId#	/* 수정아이디 */
		     , update_ip = #updateIp#	/* 수정아이피 */
		     , update_pgm = #updatePgm# /* 수정프로그램 */
		 WHERE 1 = 1
		   AND acnt_unt = #acntUnt#	/* 회계단위id */
		   AND acnt_yy = #acntYy#	/* 회계년도 */
		   AND acnt_cd = #acntCd#	/* 계정과목코드 */
    </update>
    
    <delete id="admiDAO.deleteAcntList" parameterClass="java.util.HashMap">
    	/* admiDAO.deleteAcntList 계정내역을 삭제 */
        DELETE 
          FROM BG_ACNT_CD
		 WHERE 1 = 1
		   AND acnt_unt = #acntUnt#	/* 회계단위id */
		   AND acnt_yy = #acntYy#	/* 회계년도 */
		   AND acnt_cd = #acntCd#	/* 계정과목코드 */         
    </delete>
    
    <insert id="admiDAO.insertBgAcntCopyList" parameterClass="java.util.HashMap">
    	/* admiDAO.insertBgAcntCopyList 전년도 예산을 복사한다 */
    	
    	  BEGIN
    	  		DELETE
    	  		  FROM BG_ITM_SEQ
    	  		 WHERE ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#; 
    	  		
    	  		DELETE
    	  		  FROM BG_ACNT_CD
    	  		 WHERE ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#;  
    	  	
    	  		
    	  		INSERT INTO BG_ACNT_CD (	
					        acnt_unt	/* 회계단위id */
						   ,acnt_yy	/* 회계년도 */
						   ,acnt_cd	/* 계정과목코드 */
						   ,acnt_nm	/* 계정과목명 */
						   ,acnt_inc_nm	/* 계정수입명 */
						   ,acnt_exp_nm	/* 계정지출명 */
						   ,acnt_lvl	/* 계정레벨 */
						   ,upr_acnt_cd	/* 상위계정과목코드 */
						   ,drcr_cd	/* 차대구분 */
						   ,intl_trans_cd	/* 내부거래구분 */
						   ,usage_cd	/* 용도구분 */
						   ,bf_acnt_cd	/* 전년도계정과목코드 */
						   ,purp_profit_div_cd	/* 목적수익구분코드 */
						   ,use_yn	/* 사용여부 */
						   ,exp_suspn_yn	/* 수입가계정여부 */
						   ,inc_suspn_yn	/* 지출가계정여부 */
						   ,rmk	/* 비고 */
						   ,insert_dt	/* 입력일시 */
						   ,insert_id	/* 입력아이디 */
						   ,insert_ip	/* 입력아이피 */
						   ,insert_pgm	/* 입력프로그램 */
						   )
						   SELECT acnt_unt	/* 회계단위id */
							     ,#acntYy# as acnt_yy	/* 회계년도 */
							     ,acnt_cd	/* 계정과목코드 */
							     ,acnt_nm	/* 계정과목명 */
							     ,acnt_inc_nm	/* 계정수입명 */
							     ,acnt_exp_nm	/* 계정지출명 */
							     ,acnt_lvl	/* 계정레벨 */
							     ,upr_acnt_cd	/* 상위계정과목코드 */
							     ,drcr_cd	/* 차대구분 */
							     ,intl_trans_cd	/* 내부거래구분 */
							     ,usage_cd	/* 용도구분 */
							     ,bf_acnt_cd	/* 전년도계정과목코드 */
							     ,purp_profit_div_cd	/* 목적수익구분코드 */
							     ,use_yn	/* 사용여부 */
							     ,exp_suspn_yn	/* 수입가계정여부 */
							     ,inc_suspn_yn	/* 지출가계정여부 */
							     ,rmk	/* 비고 */
							     ,insert_dt	/* 입력일시 */
							     ,insert_id	/* 입력아이디 */
							     ,insert_ip	/* 입력아이피 */
							     ,insert_pgm
						 	 FROM BG_ACNT_CD WITH(NOLOCK)
						 	WHERE ACNT_YY = CONVERT(VARCHAR, CONVERT(INT, #acntYy#) - 1)
						 	  AND ACNT_UNT = #acntUnt#;
						 	  
				INSERT INTO BG_ITM_SEQ (
					        acnt_unt	/* 회계단위id */
					       ,acnt_yy	/* 회계년도 */
					       ,acnt_cd	/* 계정과목코드 */
					       ,bal_div	/* 수지구분 */
					       ,itm_seq	/* 세세목 */
					       ,itm_seq_nm	/* 세세목명 */
					       ,use_yn	/* 사용여부 */
					       ,rmk	/* 비고 */
					       ,insert_dt	/* 입력일시 */
					       ,insert_id	/* 입력아이디 */
					       ,insert_ip	/* 입력아이피 */
					       ,insert_pgm	/* 입력프로그램 */
					       )
					       SELECT acnt_unt	/* 회계단위id */
						         ,#acntYy# as acnt_yy	/* 회계년도 */
						         ,acnt_cd	/* 계정과목코드 */
						         ,bal_div	/* 수지구분 */
						         ,itm_seq	/* 세세목 */
						         ,itm_seq_nm	/* 세세목명 */
						         ,use_yn	/* 사용여부 */
						         ,rmk	/* 비고 */
						         ,insert_dt	/* 입력일시 */
						         ,insert_id	/* 입력아이디 */
						         ,insert_ip	/* 입력아이피 */
						         ,insert_pgm	/* 입력프로그램 */	
						     FROM BG_ITM_SEQ WITH(NOLOCK)
						 	WHERE ACNT_YY = CONVERT(VARCHAR, CONVERT(INT, #acntYy#) - 1)
						 	  AND ACNT_UNT = #acntUnt#;    	 	        
						   
    	    END;	
    		
    </insert>
    
    <insert id="admiDAO.insertItmSeqList" parameterClass="java.util.HashMap">
    	/* admiDAO.insertItmSeqList 세세목내역을 저장 */
	    INSERT INTO BG_ITM_SEQ (
		        acnt_unt	/* 회계단위id */
		       ,acnt_yy	/* 회계년도 */
		       ,acnt_cd	/* 계정과목코드 */
		       ,bal_div	/* 수지구분 */
		       ,itm_seq	/* 세세목 */
		       ,itm_seq_nm	/* 세세목명 */
		       ,use_yn	/* 사용여부 */
		       ,rmk	/* 비고 */
		       ,insert_dt	/* 입력일시 */
		       ,insert_id	/* 입력아이디 */
		       ,insert_ip	/* 입력아이피 */
		       ,insert_pgm	/* 입력프로그램 */)
		    VALUES (
		        #acntUnt#
		       ,#acntYy#
		       ,#acntCd#
		       ,#balDiv#
		       ,(SELECT ISNULL(max(CONVERT(INT, itm_seq)),0)+1
  				   FROM BG_ITM_SEQ WITH(NOLOCK)
  				  WHERE 1 = 1
				    AND acnt_unt = #acntUnt#
				    AND acnt_yy = #acntYy#
				    AND acnt_cd = #acntCd#
				    AND bal_div = #balDiv#)
		       ,#itmSeqNm#
		       ,#useYn#
		       ,#rmk#
		       ,GETDATE()
			   ,#insertId#
			   ,#insertIp#
			   ,'bg01020')
    </insert>
    
    <update id="admiDAO.updateItmSeqList" parameterClass="java.util.HashMap">
    	/* admiDAO.updateItmSeqList 세세목내역을 수정 */
        UPDATE BG_ITM_SEQ
		   SET itm_seq_nm = #itmSeqNm#	/* 세세목명 */
			 , use_yn = #useYn#	/* 사용여부 */
			 , rmk = #rmk#	/* 비고 */
			 , update_dt = GETDATE()	/* 수정일시 */
		     , update_id = #updateId#	/* 수정아이디 */
		     , update_ip = #updateIp#	/* 수정아이피 */
		     , update_pgm = 'bg01020' /* 수정프로그램 */
		 WHERE 1 = 1
		   AND acnt_unt = #acntUnt#	/* 회계단위id */
		   AND acnt_yy = #acntYy#	/* 회계년도 */
		   AND acnt_cd = #acntCd#	/* 계정과목코드 */
		   AND bal_div = #balDiv#	/* 수지구분 */
		   AND itm_seq = CONVERT(INT, #itmSeq#)	/* 세세목 */   
    </update>
    
    <delete id="admiDAO.deleteItmSeqList" parameterClass="java.util.HashMap">
    	/* admiDAO.deleteItmSeqList 세세목내역을 삭제 */
        DELETE 
          FROM BG_ITM_SEQ
		 WHERE 1 = 1
		   AND acnt_unt = #acntUnt#	/* 회계단위id */
		   AND acnt_yy = #acntYy#	/* 회계년도 */
		   AND acnt_cd = #acntCd#	/* 계정과목코드 */
		   AND bal_div = #balDiv#	/* 수지구분 */
		   AND itm_seq = CONVERT(INT, #itmSeq#)	/* 세세목 */     
    </delete>
    
    <select id="admiDAO.selectBgFinc"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectBgFinc 재원내역조회 */
        SELECT '0' as chk
    	       ,'' as row_status
    	       ,acnt_unt
    	       ,finc_cd
    	       ,finc_nm
    	       ,finc_div_cd
    	       ,mgt_acnt_no
    	       ,supt_org_nm
    	       ,beg_yy
    	       ,rmk
    	   FROM BG_FINC WITH(NOLOCK)
    	  WHERE 1 = 1
            AND acnt_unt = #acntUnt#
       ORDER BY finc_cd
    </select>
    
    <insert id="admiDAO.insertBgFinc" parameterClass="java.util.HashMap">
    	/* admiDAO.insertBgFinc  재원내역저장 */
    	INSERT INTO BG_FINC(
    		   ACNT_UNT
    		 , FINC_CD
    		 , FINC_NM
    		 , FINC_DIV_CD
    		 , MGT_ACNT_NO
    		 , SUPT_ORG_NM
    		 , BEG_YY
    		 , INSERT_DT
    		 , INSERT_ID
    		 , INSERT_IP
    		 , INSERT_PGM
    		 ) VALUES (
    		   #acntUnt#
    		 , dbo.FN_LPAD(CONVERT(VARCHAR, ISNULL((select (max(CONVERT(INT, finc_cd))) from BG_FINC where acnt_unt = #acntUnt#),0)+1),4,'0')
    		 , #fincNm#
    		 , #fincDivCd#
    		 , #mgtAcntNo#
    		 , #suptOrgNm#
    		 , #begYy#
    		 , GETDATE()
    		 , #insertId#
    		 , #insertIp#
    		 , 'bg01040'
    		 )
    
    </insert>
    
    <delete id="admiDAO.deleteBgFinc" parameterClass="java.util.HashMap">
    	/* admiDAO.deleteBgFinc 재원내역삭제 */
    	DELETE 
    	  FROM BG_FINC
    	 WHERE 1 = 1
    	   AND acnt_unt = #acntUnt#
    	   AND finc_cd = #fincCd#
    </delete>
    
    <update id="admiDAO.updateBgFinc" parameterClass="java.util.HashMap">
    /* admiDAO.updateBgFinc 재원내역수정 */
        UPDATE BG_FINC
           SET FINC_NM = #fincNm#
             , FINC_DIV_CD = #fincDivCd#
             , MGT_ACNT_NO = #mgtAcntNo#
             , SUPT_ORG_NM = #suptOrgNm#
             , BEG_YY = #begYy#
             , UPDATE_DT = GETDATE()
             , UPDATE_ID = #updateId#
             , UPDATE_IP = #updateIp#
             , UPDATE_PGM = 'bg01040'
         WHERE ACNT_UNT = #acntUnt#
           AND FINC_CD = #fincCd#
    </update>
    
    <!--
    #########################################################################################################################################
    # 예산일정등록(bg02010)                                                                                                               
    #########################################################################################################################################
    -->
    
    <select id="admiDAO.selectBgSched"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectBgSched 예산일정 조회 */
        SELECT '0' as chk
    	       ,'' as row_status
    	       ,acnt_unt
    	       ,acnt_yy
    	       ,budg_cd
    	       ,fr_dt
    	       ,to_dt
    	       ,mgt_fr_dt
    	       ,mgt_to_dt
    	   FROM BG_SCHED WITH(NOLOCK)
    	  WHERE 1 = 1
            AND acnt_unt = #strStdYy#
            AND acnt_yy = #year#
    </select>
    
    <insert id ="admiDAO.insertBgSched" parameterClass="java.util.HashMap">
    /* admiDAO.insertBgSched 예산일정 저장 */
    	INSERT INTO BG_SCHED
    		 ( ACNT_UNT
    		 , ACNT_YY
    		 , BUDG_CD
    		 , FR_DT
    		 , TO_DT
    		 , MGT_FR_DT
    		 , MGT_TO_DT
    		 , INSERT_DT
    		 , INSERT_ID
    		 , INSERT_IP
    		 , INSERT_PGM
    		 ) VALUES 
    		 (
    		   #acntUnt#
    		 , #acntYy#
    		 , #budgCd#
    		 , #frDt#
    		 , #toDt#
    		 , #mgtFrDt#
    		 , #mgtToDt#
    		 , GETDATE()
    		 , #insertId#
    		 , #insertIp#
    		 , 'bg02010'
    		)
    	</insert>
    
    <delete id="admiDAO.deleteBgSched" parameterClass="java.util.HashMap">
    	/* admiDAO.deleteBgSched 예산일정 삭제 */
    	DELETE 
    	  FROM BG_SCHED
    	 WHERE 1 = 1
    	   AND budg_cd = #budgCd#
    	   AND acnt_unt = #acntUnt#
    	   AND acnt_yy = #acntYy#
    </delete>
    
    <update id="admiDAO.updateBgSched" parameterClass="java.util.HashMap">
    /* admiDAO.updateBgSched 예산일정 수정 */
        UPDATE BG_SCHED
           SET 
               FR_DT = #frDt#
             , TO_DT = #toDt#
             , MGT_FR_DT = #mgtFrDt#
             , MGT_TO_DT = #mgtToDt#
             , UPDATE_DT = GETDATE()
             , UPDATE_ID = #updateId#
             , UPDATE_IP = #updateIp#
             , UPDATE_PGM = 'bg02010'
         WHERE BUDG_CD = #budgCd#
           AND ACNT_UNT = #acntUnt#
           AND ACNT_YY = #acntYy#
           
    </update>
    
    <select id="admiDAO.selectBgBiz"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectbgBiz 사업등록내역 조회 */
	    SELECT '0' AS CHK 
        	 , '' AS ROW_STATUS            
			 , A.ACNT_UNT	/* 회계단위ID */
			 , A.BIZ_CD	/* 사업코드 */
			 , A.BIZ_NM	/* 사업명 */
			 , A.BIZ_LVL	/* 사업레벨 */
             , dbo.F_COM_CODE_NM('BG013', A.BIZ_LVL, 'KOR') AS BIZ_LVL_NM 	/* 사업레벨명 */
			 , A.UPR_BIZ_CD	/* 상위사업코드 */
             , (SELECT biz_nm from BG_BIZ sa where sa.acnt_unt = A.acnt_unt and sa.biz_cd = A.upr_biz_cd) as upr_biz_nm /* 상위사업명 */
             , A.BIZ_DIV_CD	/* 사업구분 */
             , dbo.F_COM_CODE_NM('BG014', A.BIZ_DIV_CD, 'KOR') AS BIZ_DIV_CD_NM 	/* 사업구분명 */
             , A.FINC_CD	/* 재원코드 */
             , (SELECT finc_nm FROM   BG_FINC WHERE acnt_unt =  a.acnt_unt
               and finc_cd = a.finc_cd) as finc_nm /* 재원코드명 */
             , A.PURP_PROFIT_DIV_CD	/* 목적수익구분코드 */
             , dbo.F_COM_CODE_NM('BG006', A.PURP_PROFIT_DIV_CD, 'KOR') AS PURP_PROFIT_DIV_NM 	/* 목적수익구분코드명 */
			 , A.USE_YN	/* 사용여부 */
			 , A.BEG_YY	/* 개시년도 */
			 , A.BF_BIZ_CD	/* 이전사업코드 */
             , (SELECT biz_nm from BG_BIZ sa where sa.acnt_unt = A.acnt_unt and sa.biz_cd = A.BF_BIZ_CD) as BF_BIZ_Nm /* 이전사업명 */
			 , A.MGT_ORG_ID	/* 주관부서 */
			 , (SELECT sa.DEPT_NM_KOR from   VW_COMM_DEPT sa where  sa.DEPT_CD = A.MGT_ORG_ID) as MGT_ORG_NM /* 주관부서명 */
			 , A.RMK	/* 비고 */
	  	  FROM BG_BIZ A WITH(NOLOCK)
	  	 WHERE A.ACNT_UNT = #acntUnt#
	  	 <isNotEmpty property="bizlvl">   
           AND A.BIZ_LVL = #bizlvl#
         </isNotEmpty>
         <isNotEmpty property="bizdivcd">   
           AND A.BIZ_DIV_CD = #bizdivcd#
         </isNotEmpty>
         <isNotEmpty property="biznm">   
           AND A.BIZ_NM LIKE '%' + #biznm# + '%'
         </isNotEmpty>
         <isNotEmpty property="useYn">   
           AND ISNULL(A.USE_YN, '0') = #useYn#
         </isNotEmpty>
		 ORDER BY acnt_unt, biz_cd
    </select>   
    
	<insert id="admiDAO.insertBgBiz" parameterClass="java.util.HashMap">
   		/* admiDAO.selectbgBiz 사업등록내역 추가 */
   		BEGIN
   		
   			DECLARE @BIZ_CD NUMERIC(5,0);
   			
   			SELECT @BIZ_CD = ISNULL(max(CONVERT(INT, biz_cd)),0) + 1
		      FROM BG_BIZ
		     WHERE ACNT_UNT = #acntUnt#
   		
			INSERT INTO BG_BIZ 
				( acnt_unt	/* 회계단위id */
				, biz_cd	/* 사업코드 */
				, biz_nm	/* 사업명 */
				, biz_lvl	/* 사업레벨 */
				, upr_biz_cd	/* 상위사업코드 */
				, biz_div_cd	/* 사업구분 */
				, purp_profit_div_cd	/* 목적수익구분코드 */
				, use_yn	/* 사용여부 */
				, finc_cd	/* 재원코드 */
				, beg_yy	/* 개시년도 */
				, bf_biz_cd	/* 이전사업코드 */
				, mgt_org_id	/* 주관부서 */
				, rmk	/* 비고 */
				, insert_dt	/* 입력일시 */
				, insert_id	/* 입력아이디 */
				, insert_ip	/* 입력아이피 */
				, insert_pgm	/* 입력프로그램 */
			    )VALUES(
				 #acntUnt#
				, @BIZ_CD        
		  		, #bizNm#
				, #bizLvl#
				, #uprBizCd#
				, #bizDivCd#
				, #purpProfitDivCd#
				, #useYn#
				, #fincCd#
				, #begYy#
				, #bfBizCd#
				, #mgtOrgId#
				, #rmk#
				, GETDATE()
				, #insertId#
				, #insertIp#
				, 'bg01030.xfdl'
				)

		DECLARE @V_ACNT_UNT VARCHAR(10);
		SET @V_ACNT_UNT = #acntUnt#;

		IF @V_ACNT_UNT = '10'
			BEGIN
			INSERT INTO BG_BIZ 
				( acnt_unt	/* 회계단위id */
				, biz_cd	/* 사업코드 */
				, biz_nm	/* 사업명 */
				, biz_lvl	/* 사업레벨 */
				, upr_biz_cd	/* 상위사업코드 */
				, biz_div_cd	/* 사업구분 */
				, purp_profit_div_cd	/* 목적수익구분코드 */
				, use_yn	/* 사용여부 */
				, finc_cd	/* 재원코드 */
				, beg_yy	/* 개시년도 */
				, bf_biz_cd	/* 이전사업코드 */
				, mgt_org_id	/* 주관부서 */
				, rmk	/* 비고 */
				, insert_dt	/* 입력일시 */
				, insert_id	/* 입력아이디 */
				, insert_ip	/* 입력아이피 */
				, insert_pgm	/* 입력프로그램 */
			    )VALUES(
				 '20'
				, @BIZ_CD       
		  		, #bizNm#
				, #bizLvl#
				, #uprBizCd#
				, #bizDivCd#
				, #purpProfitDivCd#
				, #useYn#
				, #fincCd#
				, #begYy#
				, #bfBizCd#
				, #mgtOrgId#
				, #rmk#
				, GETDATE()
				, #insertId#
				, #insertIp#
				, 'bg01030.xfdl'
				)
			END

		END
    </insert>
    
    <update id="admiDAO.updateBgBiz" parameterClass="java.util.HashMap">
 		/* admiDAO.updateBgBiz 사업등록내역 수정 */
	    UPDATE BG_BIZ 
		   SET biz_nm = #bizNm# /* 사업명 */
			  , biz_lvl = #bizLvl# /* 사업레벨 */
			  , upr_biz_cd = #uprBizCd# /* 상위사업코드 */
			  , biz_div_cd = #bizDivCd# /* 사업구분 */
			  , purp_profit_div_cd = #purpProfitDivCd# /* 목적수익구분코드 */
			  , use_yn = #useYn# /* 사용여부 */
			  , finc_cd = #fincCd# /* 재원코드 */
			  , beg_yy = #begYy# /* 개시년도 */
			  , bf_biz_cd = #bfBizCd# /* 이전사업코드 */
			  , mgt_org_id = #mgtOrgId# /* 주관부서 */
			  , rmk = #RMK# /* 비고 */
			  , update_dt = GETDATE()	/* 수정일시 */
			  , update_id = #updateId#	/* 수정아이디 */
			  , update_ip = #updateIp#	/* 수정아이피 */
			  , update_pgm = 'bg01030'	/* 수정프로그램 */
	      WHERE acnt_unt = #acntUnt# 
	  	    AND biz_cd = #bizCd#
    </update>
    
    <delete id="admiDAO.deleteBgBiz" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgBiz 사업등록내역 삭제 */
		BEGIN
			DELETE 
			  FROM BG_BIZ 
			 WHERE acnt_unt = #acntUnt# AND biz_cd = #bizCd#
		 
		DECLARE @V_ACNT_UNT VARCHAR(10);
		SET @V_ACNT_UNT = #acntUnt#;

		IF @V_ACNT_UNT = '10'
			BEGIN		 
				DELETE 
				  FROM BG_BIZ 
				 WHERE acnt_unt = '20' AND biz_cd = #bizCd#
		 	END
		END
    </delete>
    

    <select id="admiDAO.selectbgFrmn"  parameterClass="java.util.HashMap" resultClass="egovMap">
  		/* admiDAO.selectbgFrmn 예산편성 통계내역 조회 */
     	SELECT 'x' x
    </select>    
    
    
    <!-- 
    #########################################################################################################################################*/
    # 관리부서등록(bg01050.xfdl)
    #########################################################################################################################################*/
     -->
     
    <select id="admiDAO.selectBgOrgPermMain"  parameterClass="java.util.HashMap" resultClass="egovMap">
    
		  SELECT '0' AS CHK 
     		   , '' AS ROW_STATUS
	 		   , A.DEPT_CD 
     		   , A.DEPT_NM_KOR
     		   , A.DEPT_LEVEL 
     		   , A.UP_DEPT_CD
     		   , A.SORT_SEQ
     		   , A.USE_FLAG
     		   , B.DEPT_NM_KOR AS UP_DEPT_NM
  			FROM VW_COMM_DEPT A WITH(NOLOCK)
  			   LEFT OUTER JOIN VW_COMM_DEPT_ALL B
  			     ON  A.UP_DEPT_CD = B.DEPT_CD
 		   WHERE 1=1
   			 AND A.USE_FLAG = '1'
   
   			<isNotEmpty property="DEPT_NM_KOR">
             AND A.DEPT_NM_KOR LIKE '%' + #DEPT_NM_KOR# + '%'
   			</isNotEmpty>
    
        ORDER BY B.DEPT_CD, A.DEPT_CD, A.DEPT_LEVEL, A.SORT_SEQ 
	    
    </select>
        
    
    <insert id="admiDAO.insertBgOrgPermMain" parameterClass="java.util.HashMap">
    </insert>
        
    <update id="admiDAO.updateBgOrgPermMain" parameterClass="java.util.HashMap">
    </update>
       
    <delete id="admiDAO.deleteBgOrgPermMain" parameterClass="java.util.HashMap">
    </delete>
        
    <select id="admiDAO.selectBgOrgPerm"  parameterClass="java.util.HashMap" resultClass="egovMap">
    
    	SELECT '0' AS CHK 
     		 , '' AS ROW_STATUS 
             , A.ACNT_UNT
    	     , A.WORK_DIV
    	     , A.MGT_ORG_ID
    	     , A.ORG_ID
    	     , B.DEPT_NM_KOR AS ORG_ID_NM 
    	     , A.USE_YN
    	     , C.DEPT_NM_KOR AS UP_DEPT_NM
    	  FROM BG_ORG_PERM A WITH(NOLOCK)
    	   LEFT OUTER JOIN VW_COMM_DEPT_ALL B
    	     ON A.ORG_ID = B.DEPT_CD
    	   LEFT OUTER JOIN VW_COMM_DEPT_ALL C
    	     ON B.UP_DEPT_CD = C.DEPT_CD
    	 WHERE 1=1
    	   AND A.MGT_ORG_ID = #DEPT_CD#
      ORDER BY A.ACNT_UNT, A.WORK_DIV  
    </select>
    
    <insert id="admiDAO.insertBgOrgPerm" parameterClass="java.util.HashMap">

    	INSERT INTO BG_ORG_PERM
    			    (
    			    	ACNT_UNT
    			      , WORK_DIV
    			      , MGT_ORG_ID
    			      , ORG_ID
    			      , USE_YN
    			      , INSERT_DT
    			      , INSERT_ID
    			      , INSERT_IP
    			      , INSERT_PGM 
    			    )
				VALUES
					(
						#acntUnt#
    			      , #workDiv#
    			      , #mgtOrgId#
    			      , #orgId#
    			      , #useYn#
    			      , #insertDt#
    			      , #insertId#
    			      , #insertIp#
    			      , 'bg01050'
					)    	
    </insert>
    
    <update id="admiDAO.updateBgOrgPerm" parameterClass="java.util.HashMap">
    	
    	UPDATE BG_ORG_PERM
    	   SET USE_YN = #useYn#
    	     , UPDATE_DT = #updateDt#
    		 , UPDATE_ID = #updateId#
    		 , UPDATE_IP = #updateIp#
    		 , UPDATE_PGM = 'bg01050'
    	 WHERE 1=1
    	   AND ACNT_UNT = #acntUnt#
    	   AND WORK_DIV = #workDiv#
    	   AND MGT_ORG_ID = #mgtOrgId#
    	   AND ORG_ID = #orgId#
    
    </update>
    
    <delete id="admiDAO.deleteBgOrgPerm" parameterClass="java.util.HashMap">    
    
		DELETE FROM BG_ORG_PERM
	   	 WHERE 1=1
	   	   AND ACNT_UNT = #acntUnt#
	   	   AND WORK_DIV = #workDiv#
	   	   AND MGT_ORG_ID = #mgtOrgId#
	   	   AND ORG_ID = #orgId#
    
    </delete>
     
     
    <select id="admiDAO.selectBgOrgBizSta"  parameterClass="java.util.HashMap" resultClass="egovMap">
    /* admiDAO.selectBgOrgBizSta 예산편성신청현황 조회 */
    	SELECT ACNT_UNT
    	     , ACNT_YY
    	     , BUDG_ORG_ID
    	     , BAL_DIV
    	     , BUDG_CD
    	     , BUDG_ORG_ID_NM
    	     , BIZ_DIV_CD
    	     , BIZ_CD_NM
    	     , STA_CD
    	     , STA_CD_NM
    	     , ACNT_UNT_NM
    	     , BAL_DIV_NM
    	     , BUDG_AMT
    	 FROM ( 
		        SELECT A.ACNT_UNT AS ACNT_UNT
				     , A.ACNT_YY AS ACNT_YY
				     , A.BUDG_ORG_ID AS BUDG_ORG_ID
				     , A.BAL_DIV
				     , A.BUDG_CD
				     , (select dept_nm_kor from VW_COMM_DEPT_ALL where dept_cd = A.BUDG_ORG_ID ) AS BUDG_ORG_ID_NM
				     , B.BIZ_DIV_CD AS BIZ_DIV_CD
				     , A.BIZ_CD AS BIZ_CD
		     		 , (
		        		SELECT BIZ_NM
		          	      FROM BG_BIZ WITH(NOLOCK)
		                 WHERE ACNT_UNT = A.ACNT_UNT
		                   AND BIZ_CD = A.BIZ_CD
		               ) AS BIZ_CD_NM
		             , A.STA_CD
		             , ( SELECT COM_CD_NM
		                   FROM COM_COD D
		                  WHERE D.COM_CD_DIV = 'BG011'
		                    AND D.COM_CD = A.STA_CD ) AS STA_CD_NM
		             , ( SELECT E.ACNT_UNT_NM
		                   FROM BG_UNT E
		                  WHERE E.ACNT_UNT = A.ACNT_UNT ) AS ACNT_UNT_NM
		             , ( SELECT COM_CD_NM
		                   FROM COM_COD D
		                  WHERE D.COM_CD_DIV = 'BG007'
		                    AND D.COM_CD = A.BAL_DIV ) AS BAL_DIV_NM
		             , ISNULL(( SELECT SUM(BUDG_AMT)
		                   FROM BG_FRMN F
		                  WHERE F.ACNT_UNT = A.ACNT_UNT
		                    AND F.ACNT_YY = A.ACNT_YY
		                    AND F.BUDG_ORG_ID = A.BUDG_ORG_ID
		                    AND F.BAL_DIV = A.BAL_DIV
		                    AND F.BUDG_CD = A.BUDG_CD
		                    AND F.BIZ_CD = A.BIZ_CD
		                    AND F.ADJ_ORD_CD = '101'
		                ),0) AS BUDG_AMT
		          FROM BG_ORG_BIZ A WITH(NOLOCK)
		  		       JOIN BG_BIZ B WITH(NOLOCK)
		    		     ON A.ACNT_UNT = B.ACNT_UNT
		                AND A.BIZ_CD = B.BIZ_CD 
		         WHERE 1=1
				   AND A.ACNT_YY = #acntYy#
				   AND A.BUDG_CD = #budgCd#
				   <isNotEmpty property="staCd">
				   AND A.STA_CD = #staCd#
				   </isNotEmpty>
		     ) TA
		 WHERE 1 = 1
		  <isEqual property="includeZeroYn" compareValue="1">
		   AND BUDG_AMT != 0
		  </isEqual>
		 ORDER BY BUDG_ORG_ID, BIZ_CD, ACNT_UNT, BAL_DIV
    </select>
     
    <!-- 
    /************************************************************
     * 부서별사업등록(bg02020)
     ************************************************************/
    /*
	 *부서별사업등록 상세내역을 조회한다
	 */
	  -->
    <select id="admiDAO.selectBgOrgBiz"  parameterClass="java.util.HashMap" resultClass="egovMap">
    /* admiDAO.selectBgOrgBiz 부서별사업등록내역 조회 */
        SELECT '0' AS CHK 
		     , '' AS ROW_STATUS
		     , A.ACNT_UNT AS ACNT_UNT
		     , A.ACNT_YY AS ACNT_YY
		     , A.BUDG_ORG_ID AS BUDG_ORG_ID
		     , A.BAL_DIV
		     , A.BUDG_CD
		     , A.BUDG_CD AS KEY_BUDG_CD
		     , (select dept_nm_kor from VW_COMM_DEPT_ALL where dept_cd = A.BUDG_ORG_ID ) AS BUDG_ORG_ID_NM
		     , B.BIZ_DIV_CD AS BIZ_DIV_CD
		     , A.BIZ_CD AS BIZ_CD
     		 , (
        		SELECT BIZ_NM
          	      FROM BG_BIZ WITH(NOLOCK)
                 WHERE 1=1
                   AND ACNT_UNT = A.ACNT_UNT
                   AND BIZ_CD = A.BIZ_CD
               ) AS BIZ_CD_NM
          FROM BG_ORG_BIZ A WITH(NOLOCK)
  		       JOIN BG_BIZ B WITH(NOLOCK)
    		     ON A.ACNT_UNT = B.ACNT_UNT
                AND A.BIZ_CD = B.BIZ_CD 
         WHERE 1=1
           AND A.ACNT_UNT = #acntUnt#
		   AND A.ACNT_YY = #acntYy#
		   AND A.BAL_DIV = #balDiv#
		   AND A.BUDG_CD = #budgCd#
		   <isNotEmpty property="budgOrgBiz">
		   AND A.BUDG_ORG_ID = #budgOrgBiz#
		   </isNotEmpty>
		   AND B.BIZ_DIV_CD =  #bizDivCd#

    </select>
     
     <insert id="admiDAO.insertBgOrgBiz" parameterClass="java.util.HashMap">
     /* admiDAO.insertBgOrgBiz 부서별사업등록내역 저장 */
     	INSERT INTO BG_ORG_BIZ
     		 ( 
     		   ACNT_UNT
     		 , ACNT_YY
     		 , BUDG_ORG_ID
     		 , BAL_DIV
     		 , BIZ_CD
     		 , BUDG_CD
     		 , STA_CD
     		 , APLY_USER_ID
     		 , APLY_DT
     		 , APPRO_USER_ID
     		 , APPRO_DT
     		 , CFM_USER_ID
     		 , CFM_DT
     		 , RCL_DT
     		 , RCL_RSN
     		 , FILE_ID
     		 , INSERT_DT
     		 , INSERT_ID
     		 , INSERT_IP
     		 , INSERT_PGM
     		 ) VALUES
     		 (
     		   #acntUnt#
     		 , #acntYy#
     		 , #budgOrgId#
     		 , #balDiv#
     		 , #bizCd#
     		 , #budgCd#
     		 , '10'
     		 , null
     		 , null
     		 , null
     		 , null
     		 , null
     		 , null
     		 , null
     		 , null
     		 , null
     		 , GETDATE()
     		 , #insertId#
     		 , #insertIp#
     		 , 'bg02020'
     		 )
     
     </insert>

    <update id ="admiDAO.updateBgOrgBiz" parameterClass="java.util.HashMap">
    /* admiDAO.updateBgOrgBiz 부서별사업등록내역 수정 */
    	UPDATE BG_ORG_BIZ
    	   SET BUDG_ORG_ID = #budgOrgId#
    	      ,BIZ_CD      = #bizCd#
    	      ,UPDATE_DT   = GETDATE()
    	      ,UPDATE_ID   = #updateId#
    	      ,UPDATE_IP   = #updateIp#
    	      ,UPDATE_PGM  = 'bg02020'
    	 WHERE ACNT_UNT    = #acntUnt#
      	   AND ACNT_YY     = #acntYy#
      	   AND BUDG_ORG_ID = #budgOrgId#
      	   AND BAL_DIV     = #balDiv#
      	   AND BIZ_CD      = #bizCd#
      	   AND BUDG_CD     = #budgCd#
    	 
    </update>

      <delete id ="admiDAO.deleteBgOrgBiz" parameterClass="java.util.HashMap">
      /* admiDAO.deleteBgOrgBiz 부서별사업등록내역 삭제 */
      	DELETE FROM BG_ORG_BIZ
      	 WHERE ACNT_UNT = #acntUnt#
      	   AND ACNT_YY = #acntYy#
      	   AND BUDG_ORG_ID = #budgOrgId#
      	   AND BAL_DIV = #balDiv#
      	   AND BIZ_CD =#bizCd#
      	   AND BUDG_CD = #budgCd#
      </delete>
      
      <!-- 
    /************************************************************
     * 예산편성신청등록(bg02030)
     ************************************************************/
    /*
	 *예산편성신청등록을 조회한다
	 */
	  -->
	<select id="admiDAO.selectBgFrmnApplyList"  parameterClass="java.util.HashMap" resultClass="egovMap">               
		/* admiDAO.selectBgFrmnApplyList 예산편성신청등록을 조회한다. */	 
		  <isEqual property="budgCd" compareValue="10">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL(ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,bfr.adj_ord_cd										/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		           JOIN BG_BIZ bb1 WITH(NOLOCK)
		             ON     bob.acnt_unt       = bb1.acnt_unt
		                AND bob.biz_cd         = bb1.biz_cd
		           LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bf.acnt_unt
		                AND bb1.finc_cd        = bf.finc_cd
		        
		           LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bb2.acnt_unt
		                AND bb1.upr_biz_cd     = bb2.biz_cd
		       
		           LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		             ON     bb2.acnt_unt       = bb3.acnt_unt
		                AND bb2.upr_biz_cd     = bb3.biz_cd

                   LEFT OUTER JOIN ( SELECT   bfr.acnt_unt
					    	                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div ) bfr
		                 ON    bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div
					       AND bfr.adj_ord_cd   = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
							                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END
		          
		          LEFT OUTER JOIN ( SELECT  bfd.acnt_unt
						                   ,bfd.acnt_yy
						                   ,bfd.budg_cd
						                   ,bfd.adj_ord_cd
						                   ,bfd.budg_org_id
						                   ,bfd.biz_cd
						                   ,bfd.bal_div
						                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
						                   ,count(1) as cal_bss_cnt /* 산출건수 */
						              FROM BG_FRMN_DET bfd WITH(NOLOCK)
						             WHERE 1=1
						               <isNotEmpty property = "acntCd">
						               AND bfd.acnt_cd    = #acntCd#
						               </isNotEmpty> 
						             GROUP BY bfd.acnt_unt
						                     ,bfd.acnt_yy
						                     ,bfd.budg_cd
						                     ,bfd.adj_ord_cd
						                     ,bfd.budg_org_id
						                     ,bfd.biz_cd
						                     ,bfd.bal_div) bfd
		             ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div      
				       AND bfd.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
			                                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                         ELSE '101' END
		                     
		         LEFT OUTER JOIN ( SELECT bfs.acnt_unt
					                     ,bfs.acnt_yy
					                     ,bfs.budg_cd
					                     ,bfs.adj_ord_cd
					                     ,bfs.budg_org_id
					                     ,bfs.biz_cd
					                     ,bfs.bal_div
					                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					               WHERE 1=1
					                 <isNotEmpty property = "acntCd">
					                 AND bfs.acnt_cd    = #acntCd#
					                 </isNotEmpty> 
					               GROUP BY bfs.acnt_unt
					                       ,bfs.acnt_yy
					                       ,bfs.budg_cd
					                       ,bfs.adj_ord_cd
					                       ,bfs.budg_org_id
					                       ,bfs.biz_cd
					                       ,bfs.bal_div) bfs
		            ON     bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div
				       AND bfs.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
							                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                         ELSE '101' END
		                       
		          LEFT OUTER JOIN ( SELECT  ba.acnt_unt
					                       ,ba.acnt_yy
					                       ,ba.budg_org_id
					                       ,ba.biz_cd
					                       ,ba.bal_div
					                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
					                  FROM BG_ASGN ba WITH(NOLOCK)
			                         WHERE 1=1
					                   <isNotEmpty property = "acntCd">
					                   AND ba.acnt_cd    = #acntCd#
					                   </isNotEmpty> 
					                 GROUP BY ba.acnt_unt
					                         ,ba.acnt_yy
					                         ,ba.budg_org_id
					                         ,ba.biz_cd
					                         ,ba.bal_div) ba                
				      ON   bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy-1      = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div                 
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.budg_org_id    = #budgOrgId#
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		  </isEqual>
		
		  <isEqual property="budgCd" compareValue="20">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL(ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,bfr.adj_ord_cd										/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		           JOIN BG_BIZ bb1 WITH(NOLOCK)
		             ON     bob.acnt_unt       = bb1.acnt_unt
		                AND bob.biz_cd         = bb1.biz_cd
		           LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bf.acnt_unt
		                AND bb1.finc_cd        = bf.finc_cd
		        
		           LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bb2.acnt_unt
		                AND bb1.upr_biz_cd     = bb2.biz_cd
		       
		           LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		             ON     bb2.acnt_unt       = bb3.acnt_unt
		                AND bb2.upr_biz_cd     = bb3.biz_cd

                   LEFT OUTER JOIN ( SELECT   bfr.acnt_unt
					    	                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div ) bfr
		                 ON    bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div
					       AND bfr.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
				                                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
				                                         ELSE '101' END
		          
		          LEFT OUTER JOIN ( SELECT  bfd.acnt_unt
						                   ,bfd.acnt_yy
						                   ,bfd.budg_cd
						                   ,bfd.adj_ord_cd
						                   ,bfd.budg_org_id
						                   ,bfd.biz_cd
						                   ,bfd.bal_div
						                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
						                   ,count(1) as cal_bss_cnt /* 산출건수 */
						              FROM BG_FRMN_DET bfd WITH(NOLOCK)
						             WHERE 1=1
						               <isNotEmpty property = "acntCd">
						               AND bfd.acnt_cd    = #acntCd#
						               </isNotEmpty> 
						             GROUP BY bfd.acnt_unt
						                     ,bfd.acnt_yy
						                     ,bfd.budg_cd
						                     ,bfd.adj_ord_cd
						                     ,bfd.budg_org_id
						                     ,bfd.biz_cd
						                     ,bfd.bal_div) bfd
		             ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div      
				       AND bfd.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
							                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                         ELSE '101' END
		                     
		         LEFT OUTER JOIN ( SELECT bfs.acnt_unt
					                     ,bfs.acnt_yy
					                     ,bfs.budg_cd
					                     ,bfs.adj_ord_cd
					                     ,bfs.budg_org_id
					                     ,bfs.biz_cd
					                     ,bfs.bal_div
					                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					               WHERE 1=1
					                 <isNotEmpty property = "acntCd">
					                 AND bfs.acnt_cd    = #acntCd#
					                 </isNotEmpty> 
					               GROUP BY bfs.acnt_unt
					                       ,bfs.acnt_yy
					                       ,bfs.budg_cd
					                       ,bfs.adj_ord_cd
					                       ,bfs.budg_org_id
					                       ,bfs.biz_cd
					                       ,bfs.bal_div) bfs
		            ON     bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div
				       AND bfs.adj_ord_cd    = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
							                        WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                        ELSE '101' END
		                       
		          LEFT OUTER JOIN ( SELECT  ba.acnt_unt
					                       ,ba.acnt_yy
					                       ,ba.budg_org_id
					                       ,ba.biz_cd
					                       ,ba.bal_div
					                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
					                  FROM BG_ASGN ba WITH(NOLOCK)
			                         WHERE ba.budg_cd = '10' 
					                 GROUP BY ba.acnt_unt
					                         ,ba.acnt_yy
					                         ,ba.budg_org_id
					                         ,ba.biz_cd
					                         ,ba.bal_div) ba                
				      ON   bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy        = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div                 
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.budg_org_id    = #budgOrgId#
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		  </isEqual>
		  
		  <isEqual property="budgCd" compareValue="30">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL(ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,bfr.adj_ord_cd										/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		           JOIN BG_BIZ bb1 WITH(NOLOCK)
		             ON     bob.acnt_unt       = bb1.acnt_unt
		                AND bob.biz_cd         = bb1.biz_cd
		           LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bf.acnt_unt
		                AND bb1.finc_cd        = bf.finc_cd
		        
		           LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		             ON     bb1.acnt_unt       = bb2.acnt_unt
		                AND bb1.upr_biz_cd     = bb2.biz_cd
		       
		           LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		             ON     bb2.acnt_unt       = bb3.acnt_unt
		                AND bb2.upr_biz_cd     = bb3.biz_cd

                   LEFT OUTER JOIN ( SELECT   bfr.acnt_unt
					    	                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div) bfr
		                 ON    bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div
					       AND bfr.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
				                                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
				                                         ELSE '101' END
		          
		          LEFT OUTER JOIN ( SELECT  bfd.acnt_unt
						                   ,bfd.acnt_yy
						                   ,bfd.budg_cd
						                   ,bfd.adj_ord_cd
						                   ,bfd.budg_org_id
						                   ,bfd.biz_cd
						                   ,bfd.bal_div
						                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
						                   ,count(1) as cal_bss_cnt /* 산출건수 */
						              FROM BG_FRMN_DET bfd WITH(NOLOCK)
						             WHERE 1=1
						               <isNotEmpty property = "acntCd">
						               AND bfd.acnt_cd    = #acntCd#
						               </isNotEmpty> 
						             GROUP BY bfd.acnt_unt
						                     ,bfd.acnt_yy
						                     ,bfd.budg_cd
						                     ,bfd.adj_ord_cd
						                     ,bfd.budg_org_id
						                     ,bfd.biz_cd
						                     ,bfd.bal_div) bfd
		             ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div      
				       AND bfd.adj_ord_cd    = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
			                                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                         ELSE '101' END
		                     
		         LEFT OUTER JOIN ( SELECT bfs.acnt_unt
					                     ,bfs.acnt_yy
					                     ,bfs.budg_cd
					                     ,bfs.adj_ord_cd
					                     ,bfs.budg_org_id
					                     ,bfs.biz_cd
					                     ,bfs.bal_div
					                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					               WHERE 1=1
					                 <isNotEmpty property = "acntCd">
					                 AND bfs.acnt_cd    = #acntCd#
					                 </isNotEmpty> 
					               GROUP BY bfs.acnt_unt
					                       ,bfs.acnt_yy
					                       ,bfs.budg_cd
					                       ,bfs.adj_ord_cd
					                       ,bfs.budg_org_id
					                       ,bfs.biz_cd
					                       ,bfs.bal_div) bfs
		            ON     bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div
				       AND bfs.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd
			                                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                         ELSE '101' END
		                       
		          LEFT OUTER JOIN ( SELECT  ba.acnt_unt
					                       ,ba.acnt_yy
					                       ,ba.budg_org_id
					                       ,ba.biz_cd
					                       ,ba.bal_div
					                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
					                  FROM BG_ASGN ba WITH(NOLOCK)
			                         WHERE ba.budg_cd in ( '10' , '20' ) 
					                 GROUP BY ba.acnt_unt
					                         ,ba.acnt_yy
					                         ,ba.budg_org_id
					                         ,ba.biz_cd
					                         ,ba.bal_div) ba                
				      ON   bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy        = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div                 
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.budg_org_id    = #budgOrgId#
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		  </isEqual>

	</select>
	
	<select id="admiDAO.selectBgFrmnApplyFixedList"  parameterClass="java.util.HashMap" resultClass="egovMap">               
		/* admiDAO.selectBgFrmnApplyList 예산편성관리등록을 조회한다. */
		<isEqual property="budgCd" compareValue="10">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,( SELECT NM 
		             FROM VW_USER_LIST
		            WHERE MEMBER_NO = BOB.CFM_USER_ID  ) AS CFM_USER_NM
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL( ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,ISNULL(bfr.adj_ord_cd, #adjOrdCd#) as adj_ord_cd		/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		        	LEFT OUTER JOIN BG_BIZ bb1 WITH(NOLOCK)
		        		ON    bob.acnt_unt   = bb1.acnt_unt
		                  AND bob.biz_cd     = bb1.biz_cd
		         	LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		            	ON    bb1.acnt_unt   = bf.acnt_unt
		                  AND bb1.finc_cd    = bf.finc_cd
		            LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		                ON    bb1.acnt_unt       = bb2.acnt_unt
		                  AND bb1.upr_biz_cd     = bb2.biz_cd
		            LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		        		ON    bb2.acnt_unt       = bb3.acnt_unt
		                  AND bb2.upr_biz_cd     = bb3.biz_cd
		            LEFT OUTER JOIN (SELECT   bfr.acnt_unt
							                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div) bfr
                         ON   bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div			   
					       AND bfr.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END                
		            LEFT OUTER JOIN (SELECT     bfd.acnt_unt
							                   ,bfd.acnt_yy
							                   ,bfd.budg_cd
							                   ,bfd.adj_ord_cd
							                   ,bfd.budg_org_id
							                   ,bfd.biz_cd
							                   ,bfd.bal_div
							                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
							                   ,count(1) as cal_bss_cnt /* 산출건수 */
							              FROM BG_FRMN_DET bfd WITH(NOLOCK)
							             WHERE 1=1
							               <isNotEmpty property = "acntCd">
							               AND bfd.acnt_cd    = #acntCd#
							               </isNotEmpty> 
							             GROUP BY bfd.acnt_unt
							                     ,bfd.acnt_yy
							                     ,bfd.budg_cd
							                     ,bfd.adj_ord_cd
							                     ,bfd.budg_org_id
							                     ,bfd.biz_cd
							                     ,bfd.bal_div) bfd
                     ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div        
				       AND bfd.adj_ord_cd   = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END     
							                     
		            LEFT OUTER JOIN (SELECT  bfs.acnt_unt
						                     ,bfs.acnt_yy
						                     ,bfs.budg_cd
						                     ,bfs.adj_ord_cd
						                     ,bfs.budg_org_id
						                     ,bfs.biz_cd
						                     ,bfs.bal_div
						                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
						                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
						               WHERE 1=1
						                 <isNotEmpty property = "acntCd">
						                 AND bfs.acnt_cd    = #acntCd#
						                 </isNotEmpty> 
						               GROUP BY bfs.acnt_unt
						                       ,bfs.acnt_yy
						                       ,bfs.budg_cd
						                       ,bfs.adj_ord_cd
						                       ,bfs.budg_org_id
						                       ,bfs.biz_cd
						                       ,bfs.bal_div) bfs
                     ON    bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div 
				       AND bfs.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END
						                       
		            LEFT OUTER JOIN (SELECT  ba.acnt_unt
						                       ,ba.acnt_yy
						                       ,ba.budg_org_id
						                       ,ba.biz_cd
						                       ,ba.bal_div
						                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
						                  FROM BG_ASGN ba WITH(NOLOCK)
				                         WHERE 1=1
						                   <isNotEmpty property = "acntCd">
						                   AND ba.acnt_cd    = #acntCd#
						                   </isNotEmpty> 
						                 GROUP BY ba.acnt_unt
						                         ,ba.acnt_yy
						                         ,ba.budg_org_id
						                         ,ba.biz_cd
						                         ,ba.bal_div) ba
		       		 ON    bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy-1      = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div
						                         
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.sta_cd    != '10'
		       <isNotEmpty property = "acntCd">
		       AND exists ( select 1
							  FROM BG_FRMN bfr WITH(NOLOCK)
					         WHERE bfr.acnt_cd    = #acntCd#
					           and bfr.acnt_unt = bob.acnt_unt
					           and bfr.acnt_yy = bob.acnt_yy
					           and bfr.budg_org_id = bob.budg_org_id
					           and bfr.bal_div = bob.bal_div
					           and bfr.biz_cd = bob.biz_cd
					           and bfr.budg_cd = bob.budg_cd )
		       </isNotEmpty> 
		       <isNotEmpty property = "budgOrgId">
		       AND bob.budg_org_id    = #budgOrgId#
		       </isNotEmpty>
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		</isEqual>
		
		<isEqual property="budgCd" compareValue="20">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,( SELECT NM 
		             FROM VW_USER_LIST
		            WHERE MEMBER_NO = BOB.CFM_USER_ID  ) AS CFM_USER_NM
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL( ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,ISNULL(bfr.adj_ord_cd, #adjOrdCd#) as adj_ord_cd		/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		        	LEFT OUTER JOIN BG_BIZ bb1 WITH(NOLOCK)
		        		ON    bob.acnt_unt   = bb1.acnt_unt
		                  AND bob.biz_cd     = bb1.biz_cd
		         	LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		            	ON    bb1.acnt_unt   = bf.acnt_unt
		                  AND bb1.finc_cd    = bf.finc_cd
		            LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		                ON    bb1.acnt_unt       = bb2.acnt_unt
		                  AND bb1.upr_biz_cd     = bb2.biz_cd
		            LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		        		ON    bb2.acnt_unt       = bb3.acnt_unt
		                  AND bb2.upr_biz_cd     = bb3.biz_cd
		            LEFT OUTER JOIN (SELECT   bfr.acnt_unt
							                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div) bfr
                         ON   bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div			 
					       AND bfr.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
							                             WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                             ELSE '101' END                  
		            LEFT OUTER JOIN (SELECT     bfd.acnt_unt
							                   ,bfd.acnt_yy
							                   ,bfd.budg_cd
							                   ,bfd.adj_ord_cd
							                   ,bfd.budg_org_id
							                   ,bfd.biz_cd
							                   ,bfd.bal_div
							                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
							                   ,count(1) as cal_bss_cnt /* 산출건수 */
							              FROM BG_FRMN_DET bfd WITH(NOLOCK)
							             WHERE 1=1
							               <isNotEmpty property = "acntCd">
							               AND bfd.acnt_cd    = #acntCd#
							               </isNotEmpty> 
							             GROUP BY bfd.acnt_unt
							                     ,bfd.acnt_yy
							                     ,bfd.budg_cd
							                     ,bfd.adj_ord_cd
							                     ,bfd.budg_org_id
							                     ,bfd.biz_cd
							                     ,bfd.bal_div) bfd
                     ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div        
				       AND bfd.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
							                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                         ELSE '101' END     
							                     
		            LEFT OUTER JOIN (SELECT  bfs.acnt_unt
						                     ,bfs.acnt_yy
						                     ,bfs.budg_cd
						                     ,bfs.adj_ord_cd
						                     ,bfs.budg_org_id
						                     ,bfs.biz_cd
						                     ,bfs.bal_div
						                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
						                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
						               WHERE 1=1
						                 <isNotEmpty property = "acntCd">
						                 AND bfs.acnt_cd    = #acntCd#
						                 </isNotEmpty> 
						               GROUP BY bfs.acnt_unt
						                       ,bfs.acnt_yy
						                       ,bfs.budg_cd
						                       ,bfs.adj_ord_cd
						                       ,bfs.budg_org_id
						                       ,bfs.biz_cd
						                       ,bfs.bal_div) bfs
                     ON    bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div 
				       AND bfs.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
							                         WHEN bob.sta_cd = '40' THEN #adjOrdCd#
							                         ELSE '101' END
						                       
		            LEFT OUTER JOIN (SELECT  ba.acnt_unt
						                       ,ba.acnt_yy
						                       ,ba.budg_org_id
						                       ,ba.biz_cd
						                       ,ba.bal_div
						                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
						                  FROM BG_FRMN ba WITH(NOLOCK)
						                 INNER JOIN BG_ORG_BIZ bob 
						                    ON ba.acnt_unt = bob.acnt_unt
						                   AND ba.acnt_yy = bob.acnt_yy
						                   AND ba.budg_org_id = bob.budg_org_id
						                   AND ba.bal_div = bob.bal_div
						                   AND ba.biz_cd = bob.biz_cd
						                   AND ba.budg_cd = bob.budg_cd
						                   AND ba.adj_ord_cd = bob.cfm_ord_cd
				                         WHERE 1=1
						                   <isNotEmpty property = "acntCd">
						                   AND ba.acnt_cd    = #acntCd#
						                   </isNotEmpty> 
						                   AND ba.budg_cd = '10'
						                   AND bob.sta_cd = '50'
						                 GROUP BY ba.acnt_unt
						                         ,ba.acnt_yy
						                         ,ba.budg_org_id
						                         ,ba.biz_cd
						                         ,ba.bal_div) ba
		       		 ON    bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy      = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div
						                         
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.sta_cd    != '10'
		       <isNotEmpty property = "acntCd">
		       AND exists ( select 1
							  FROM BG_FRMN bfr WITH(NOLOCK)
					         WHERE bfr.acnt_cd    = #acntCd#
					           and bfr.acnt_unt = bob.acnt_unt
					           and bfr.acnt_yy = bob.acnt_yy
					           and bfr.budg_org_id = bob.budg_org_id
					           and bfr.bal_div = bob.bal_div
					           and bfr.biz_cd = bob.biz_cd
					           and bfr.budg_cd = bob.budg_cd )
		       </isNotEmpty> 
		       <isNotEmpty property = "budgOrgId">
		       AND bob.budg_org_id    = #budgOrgId#
		       </isNotEmpty>
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		</isEqual>
		
		<isEqual property="budgCd" compareValue="30">
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,( SELECT NM 
		             FROM VW_USER_LIST
		            WHERE MEMBER_NO = BOB.CFM_USER_ID  ) AS CFM_USER_NM
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL( ISNULL(bfd.budg_amt_sum,0) - ISNULL(ba.pre_year_budg_amt,0) ,0) as amount_amt	/* 증감액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,ISNULL(bfr.adj_ord_cd, #adjOrdCd#) as adj_ord_cd		/* 조정차수 */
			    ,bob.cfm_ord_cd                                     /* 확정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		        	LEFT OUTER JOIN BG_BIZ bb1 WITH(NOLOCK)
		        		ON    bob.acnt_unt   = bb1.acnt_unt
		                  AND bob.biz_cd     = bb1.biz_cd
		         	LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		            	ON    bb1.acnt_unt   = bf.acnt_unt
		                  AND bb1.finc_cd    = bf.finc_cd
		            LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		                ON    bb1.acnt_unt       = bb2.acnt_unt
		                  AND bb1.upr_biz_cd     = bb2.biz_cd
		            LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		        		ON    bb2.acnt_unt       = bb3.acnt_unt
		                  AND bb2.upr_biz_cd     = bb3.biz_cd
		            LEFT OUTER JOIN (SELECT   bfr.acnt_unt
							                 ,bfr.acnt_yy
							                 ,bfr.budg_cd
							                 ,bfr.adj_ord_cd
							                 ,bfr.budg_org_id
							                 ,bfr.biz_cd
							                 ,bfr.bal_div
							                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
							            FROM BG_FRMN bfr WITH(NOLOCK)
							           WHERE 1=1
							             <isNotEmpty property = "acntCd">
							             AND bfr.acnt_cd    = #acntCd#
							             </isNotEmpty> 
							           GROUP BY bfr.acnt_unt
							                   ,bfr.acnt_yy
							                   ,bfr.budg_cd
							                   ,bfr.adj_ord_cd
							                   ,bfr.budg_org_id
							                   ,bfr.biz_cd
							                   ,bfr.bal_div) bfr
                         ON   bob.acnt_unt       = bfr.acnt_unt
					       AND bob.acnt_yy        = bfr.acnt_yy
					       AND bob.budg_org_id    = bfr.budg_org_id
					       AND bob.biz_cd         = bfr.biz_cd
					       AND bob.budg_cd        = bfr.budg_cd
					       AND bob.bal_div        = bfr.bal_div			   
					       AND bfr.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END                
		            LEFT OUTER JOIN (SELECT     bfd.acnt_unt
							                   ,bfd.acnt_yy
							                   ,bfd.budg_cd
							                   ,bfd.adj_ord_cd
							                   ,bfd.budg_org_id
							                   ,bfd.biz_cd
							                   ,bfd.bal_div
							                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
							                   ,count(1) as cal_bss_cnt /* 산출건수 */
							              FROM BG_FRMN_DET bfd WITH(NOLOCK)
							             WHERE 1=1
							               <isNotEmpty property = "acntCd">
							               AND bfd.acnt_cd    = #acntCd#
							               </isNotEmpty> 
							             GROUP BY bfd.acnt_unt
							                     ,bfd.acnt_yy
							                     ,bfd.budg_cd
							                     ,bfd.adj_ord_cd
							                     ,bfd.budg_org_id
							                     ,bfd.biz_cd
							                     ,bfd.bal_div) bfd
                     ON    bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div
				       AND bfd.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END             
							                     
		            LEFT OUTER JOIN (SELECT  bfs.acnt_unt
						                     ,bfs.acnt_yy
						                     ,bfs.budg_cd
						                     ,bfs.adj_ord_cd
						                     ,bfs.budg_org_id
						                     ,bfs.biz_cd
						                     ,bfs.bal_div
						                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
						                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
						               WHERE 1=1
						                 <isNotEmpty property = "acntCd">
						                 AND bfs.acnt_cd    = #acntCd#
						                 </isNotEmpty> 
						               GROUP BY bfs.acnt_unt
						                       ,bfs.acnt_yy
						                       ,bfs.budg_cd
						                       ,bfs.adj_ord_cd
						                       ,bfs.budg_org_id
						                       ,bfs.biz_cd
						                       ,bfs.bal_div) bfs
                     ON    bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div 
				       AND bfs.adj_ord_cd     = CASE WHEN bob.sta_cd = '50' THEN bob.cfm_ord_cd 
			                                           WHEN bob.sta_cd = '40' THEN #adjOrdCd#
			                                           ELSE '101' END
						                       
		            LEFT OUTER JOIN (SELECT  ba.acnt_unt
						                       ,ba.acnt_yy
						                       ,ba.budg_org_id
						                       ,ba.biz_cd
						                       ,ba.bal_div
						                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
						                  FROM BG_FRMN ba WITH(NOLOCK)
						                 INNER JOIN BG_ORG_BIZ bob 
						                    ON ba.acnt_unt = bob.acnt_unt
						                   AND ba.acnt_yy = bob.acnt_yy
						                   AND ba.budg_org_id = bob.budg_org_id
						                   AND ba.bal_div = bob.bal_div
						                   AND ba.biz_cd = bob.biz_cd
						                   AND ba.budg_cd = bob.budg_cd
						                   AND ba.adj_ord_cd = bob.cfm_ord_cd
				                         WHERE 1=1
						                   <isNotEmpty property = "acntCd">
						                   AND ba.acnt_cd    = #acntCd#
						                   </isNotEmpty> 
						                   AND ba.budg_cd = '20'
						                   AND bob.sta_cd = '50'
						                 GROUP BY ba.acnt_unt
						                         ,ba.acnt_yy
						                         ,ba.budg_org_id
						                         ,ba.biz_cd
						                         ,ba.bal_div) ba
		       		 ON    bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy      = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div
						                         
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       AND bob.sta_cd    != '10'
		       <isNotEmpty property = "acntCd">
		       AND exists ( select 1
							  FROM BG_FRMN bfr WITH(NOLOCK)
					         WHERE bfr.acnt_cd    = #acntCd#
					           and bfr.acnt_unt = bob.acnt_unt
					           and bfr.acnt_yy = bob.acnt_yy
					           and bfr.budg_org_id = bob.budg_org_id
					           and bfr.bal_div = bob.bal_div
					           and bfr.biz_cd = bob.biz_cd
					           and bfr.budg_cd = bob.budg_cd )
		       </isNotEmpty> 
		       <isNotEmpty property = "budgOrgId">
		       AND bob.budg_org_id    = #budgOrgId#
		       </isNotEmpty>
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
		</isEqual>
			 

	</select>


	<select id="admiDAO.selectBgFrmnApplyExcelList"  parameterClass="java.util.HashMap" resultClass="egovMap">               
		/* admiDAO.selectBgFrmnApplyExcelList 예산편성신청등록을 조회한다. 엑셀용 */	 
		  SELECT '0' AS chk
		        ,'' AS row_status
		        ,bob.acnt_unt /* 회계단위 */
		        ,bob.acnt_yy /* 회계연도 */
		        ,bob.budg_org_id /* 예산부서 */
		        ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
		        ,bob.bal_div /* 수지구분 */
		        ,bob.biz_cd /* 사업코드 */
		        ,bob.budg_cd /* 예산구분 */
		        ,bob.sta_cd /* 상태코드 */
		        ,bob.aply_user_id /* 신청자 */
		        ,bob.aply_dt /* 신청일자 */
		        ,bob.appro_user_id /* 승인자 */
		        ,bob.appro_dt /* 승인일자 */
		        ,bob.cfm_user_id /* 확정자 */
		        ,bob.cfm_dt /* 확정일자 */
		        ,bob.file_id /* 파일ID */
		        ,bf.finc_cd /* 재원코드 */
		        ,bf.finc_nm /* 재원명 */
		        ,bb1.biz_nm                                               /* 사업명 */
		        ,bb2.biz_nm as midcl_biz_nm                               /* 대분류사업 */
		        ,bb3.biz_nm as lrgcl_biz_nm                               /* 중분류사업 */
		        ,bb1.biz_lvl                                           /* 사업레벨코드 */
		        ,(SELECT dbo.F_COM_CODE_NM('ADMI01', bb1.biz_lvl, 'KOR')) AS biz_lvl_nm    /* 사업레벨명 */
		        ,bb1.upr_biz_cd                                            /* 상위사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.upr_biz_cd) as upr_biz_nm  /*상위사업명*/
		        ,bb1.bf_biz_cd                                            /* 이전사업코드 */
		        ,(SELECT abb.biz_nm FROM BG_BIZ abb WITH(NOLOCK)
		           WHERE abb.acnt_unt = #acntUnt#
		             AND abb.biz_cd   = bb1.bf_biz_cd) as bef_biz_nm  /*이전사업명*/
		        ,bb1.mgt_org_id                                             /* 주관조직id */
		        ,(SELECT dbo.F_COM_DEPT_NM(bb1.mgt_org_id, 'DEPT_NM_KOR')) AS mgt_org_nm
		        ,bb1.purp_profit_div_cd                                      /* 목적수익구분코드 */ 
		        ,bb1.beg_yy                                                /* 개시년도 */
		        ,bb1.use_yn                                                /* 사용여부 */
		        ,ISNULL(bfd.budg_amt_sum,0)as budg_amt_sum                    /* 예산신청액 */
			    ,ISNULL(bfd.cal_bss_cnt,0)as cal_bss_cnt                  /* 산출건수 */
			    ,ISNULL(bfr.acnt_cd_cnt,0)as acnt_cd_cnt                    /* 계정건수 */
			    ,ISNULL(bfs.month_budg_amt,0)as month_budg_amt                /* 원별편성액 */
			    ,ISNULL(ba.pre_year_budg_amt,0)as pre_year_budg_amt        /* 전년도예산액 */
			    ,bob.rcl_dt                                               /* 반려일자 */
			    ,bob.rcl_rsn                                              /* 반려사유 */
			    ,bfr.adj_ord_cd										/* 조정차수 */
		    FROM BG_ORG_BIZ bob WITH(NOLOCK)
		         JOIN BG_BIZ bb1 WITH(NOLOCK)
		        	ON   bob.acnt_unt       = bb1.acnt_unt
		              AND bob.biz_cd         = bb1.biz_cd
		         LEFT OUTER JOIN BG_FINC bf WITH(NOLOCK)
		        	ON   bb1.acnt_unt       = bf.acnt_unt
		             AND bb1.finc_cd        = bf.finc_cd
		         LEFT OUTER JOIN BG_BIZ bb2 WITH(NOLOCK)
		        	ON   bb1.acnt_unt       = bb2.acnt_unt
		              AND bb1.upr_biz_cd     = bb2.biz_cd
		         LEFT OUTER JOIN BG_BIZ bb3 WITH(NOLOCK)
		            ON   bb2.acnt_unt       = bb3.acnt_unt
		              AND bb2.upr_biz_cd     = bb3.biz_cd
		         LEFT OUTER JOIN (SELECT  bfr.acnt_unt
						                 ,bfr.acnt_yy
						                 ,bfr.budg_cd
						                 ,bfr.adj_ord_cd
						                 ,bfr.budg_org_id
						                 ,bfr.biz_cd
						                 ,bfr.bal_div
						                 ,count(1)  as acnt_cd_cnt  /* 계정건수 */
						            FROM BG_FRMN bfr WITH(NOLOCK)
						           WHERE bfr.adj_ord_cd     = #adjOrdCd#
						           GROUP BY bfr.acnt_unt
						                   ,bfr.acnt_yy
						                   ,bfr.budg_cd
						                   ,bfr.adj_ord_cd
						                   ,bfr.budg_org_id
						                   ,bfr.biz_cd
						                   ,bfr.bal_div) bfr
		            ON   bob.acnt_unt       = bfr.acnt_unt
				       AND bob.acnt_yy        = bfr.acnt_yy
				       AND bob.budg_org_id    = bfr.budg_org_id
				       AND bob.biz_cd         = bfr.biz_cd
				       AND bob.budg_cd        = bfr.budg_cd
				       AND bob.bal_div        = bfr.bal_div            	                   
		         LEFT OUTER JOIN (SELECT  bfd.acnt_unt
						                   ,bfd.acnt_yy
						                   ,bfd.budg_cd
						                   ,bfd.adj_ord_cd
						                   ,bfd.budg_org_id
						                   ,bfd.biz_cd
						                   ,bfd.bal_div
						                   ,sum(bfd.budg_amt)       as budg_amt_sum  /* 예산신청액 */
						                   ,count(1) as cal_bss_cnt /* 산출건수 */
						              FROM BG_FRMN_DET bfd WITH(NOLOCK)
						             WHERE bfd.adj_ord_cd     = #adjOrdCd#
						             GROUP BY bfd.acnt_unt
						                     ,bfd.acnt_yy
						                     ,bfd.budg_cd
						                     ,bfd.adj_ord_cd
						                     ,bfd.budg_org_id
						                     ,bfd.biz_cd
						                     ,bfd.bal_div) bfd
		            ON   bob.acnt_unt       = bfd.acnt_unt
				       AND bob.acnt_yy        = bfd.acnt_yy
				       AND bob.budg_org_id    = bfd.budg_org_id
				       AND bob.biz_cd         = bfd.biz_cd
				       AND bob.budg_cd        = bfd.budg_cd
				       AND bob.bal_div        = bfd.bal_div                
						                     
		         LEFT OUTER JOIN (SELECT  bfs.acnt_unt
					                     ,bfs.acnt_yy
					                     ,bfs.budg_cd
					                     ,bfs.adj_ord_cd
					                     ,bfs.budg_org_id
					                     ,bfs.biz_cd
					                     ,bfs.bal_div
					                     ,sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					               WHERE bfs.adj_ord_cd     = #adjOrdCd#
					               GROUP BY bfs.acnt_unt
					                       ,bfs.acnt_yy
					                       ,bfs.budg_cd
					                       ,bfs.adj_ord_cd
					                       ,bfs.budg_org_id
					                       ,bfs.biz_cd
					                       ,bfs.bal_div) bfs
		            ON   bob.acnt_unt       = bfs.acnt_unt
				       AND bob.acnt_yy        = bfs.acnt_yy
				       AND bob.budg_org_id    = bfs.budg_org_id
				       AND bob.biz_cd         = bfs.biz_cd
				       AND bob.budg_cd        = bfs.budg_cd
				       AND bob.bal_div        = bfs.bal_div               			                       
		         LEFT OUTER JOIN (SELECT  ba.acnt_unt
				                       ,ba.acnt_yy
				                       ,ba.budg_org_id
				                       ,ba.biz_cd
				                       ,ba.bal_div
				                       ,sum(ba.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
				                  FROM BG_ASGN ba WITH(NOLOCK)
				                 GROUP BY ba.acnt_unt
				                         ,ba.acnt_yy
				                         ,ba.budg_org_id
				                         ,ba.biz_cd
				                         ,ba.bal_div) ba
		            ON  bob.acnt_unt       = ba.acnt_unt
				       AND bob.acnt_yy-1      = ba.acnt_yy
				       AND bob.budg_org_id    = ba.budg_org_id
				       AND bob.biz_cd         = ba.biz_cd
				       AND bob.bal_div        = ba.bal_div
		     WHERE bob.acnt_unt       = #acntUnt#
		       AND bob.acnt_yy        = #acntYy#
		       AND bob.budg_cd        = #budgCd#
		       AND bob.bal_div        = #balDiv#
		       <isNotEmpty property = "budgOrgId">
		       AND bob.budg_org_id    = #budgOrgId#
		       </isNotEmpty>
		       <isNotEmpty property = "staCd">
		       AND bob.sta_cd    = #staCd#
		       </isNotEmpty>
		       ORDER BY bb1.biz_nm
	</select>

    <select id="admiDAO.selectBgFrmnSched"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnSched 예산일정에 포함된 오늘기준 회계연도,회계단위,예산구분을 조회 */
		SELECT acnt_yy
              ,min(acnt_unt) AS acnt_unt
              ,min(budg_cd) AS budg_cd
              ,fr_dt
              ,to_dt
          FROM BG_SCHED WITH(NOLOCK)
         WHERE CONVERT(CHAR(10),GETDATE(),112) BETWEEN fr_dt AND to_dt
         GROUP BY acnt_yy,acnt_unt,budg_cd,fr_dt,to_dt
         ORDER BY acnt_yy,acnt_unt,budg_cd,fr_dt,to_dt
	</select>
	
	<select id="admiDAO.selectBgFrmnSchedFixed"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnSchedFixed 예산일정에 포함된 오늘기준 회계연도,회계단위,예산구분을 조회 */
		SELECT acnt_yy
              ,min(acnt_unt) AS acnt_unt
              ,min(budg_cd) AS budg_cd
              ,mgt_fr_dt
              ,mgt_to_dt
          FROM BG_SCHED WITH(NOLOCK)
         WHERE CONVERT(CHAR(10),GETDATE(),112) BETWEEN mgt_fr_dt AND mgt_to_dt
         GROUP BY acnt_yy,acnt_unt,budg_cd,mgt_fr_dt,mgt_to_dt
	</select>
	
	<select id="admiDAO.selectBgFrmnSchedCheck"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnSchedCheck 선택된 조회조건이 예산일정에 포함되는지 확인 */
		SELECT bs.acnt_yy
              ,bs.acnt_unt
              ,bs.budg_cd
              ,case when CONVERT(CHAR(10),GETDATE(),112) BETWEEN bs.fr_dt AND bs.to_dt THEN 'Y' ELSE 'N' END as budg_yn
              ,case when CONVERT(CHAR(10),GETDATE(),112) BETWEEN bs.mgt_fr_dt AND bs.mgt_to_dt THEN 'Y' ELSE 'N' END as budg_admin_yn
          FROM BG_SCHED bs WITH(NOLOCK)
         WHERE bs.acnt_yy  = #acntYy#
           AND bs.acnt_unt = #acntUnt#
           AND bs.budg_cd  = #budgCd#
	</select>
	
	<select id="admiDAO.selectBgFrmnlist"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnlist 편성예산정보 조회한다. */
		<isEqual property="budgCd" compareValue="10">
		SELECT '0' AS chk
		      ,'' AS row_status
		      ,bfr.acnt_unt            /* 회계단위ID */
              ,bfr.acnt_yy                /* 회계년도 */
              ,bfr.budg_cd             /* 예산구분코드 */
              ,bfr.adj_ord_cd                /* 조정차수 */
              ,bfr.budg_org_id              /* 예산조직ID */
              ,(SELECT dbo.F_COM_DEPT_NM(bfr.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
              ,bfr.acnt_cd             /* 계정과목코드 */
              ,bfr.acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
              ,CASE WHEN #balDiv# = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END acnt_nm  /* 계정과목명 세목명 */
              ,CASE WHEN #balDiv# = '10' THEN bac2.acnt_inc_nm ELSE bac2.acnt_exp_nm END  mok_nm   /* 계정과목명 목명 */
              ,bfr.biz_cd                  /* 사업코드 */
              ,bb.biz_nm                   /* 사업명 */
              ,bfr.budg_amt                /* 예산액 */
              ,bfr.budg_cfm_dt            /* 예산확정일 */
              ,bfr.bal_div            /* 수지구분코드 */
	          ,bfd.calc_bss_cnt           /* 산출건수 */
              ,bfs.month_budg_amt          /* 원별편성액 */
              ,ba2.pre_year_budg_amt      /* 전년도예산액 */
              ,null as aply_amt
          FROM BG_FRMN bfr WITH(NOLOCK)
                	LEFT OUTER JOIN BG_BIZ bb WITH(NOLOCK)
                	  ON   bfr.acnt_unt     = bb.acnt_unt
                	   AND bfr.biz_cd       = bb.biz_cd
                	LEFT OUTER JOIN BG_ACNT_CD bac1 WITH(NOLOCK)
                      ON   bfr.acnt_unt     = bac1.acnt_unt
                       AND bfr.acnt_yy      = bac1.acnt_yy
                       AND bfr.acnt_cd      = bac1.acnt_cd
                    LEFT OUTER JOIN BG_ACNT_CD bac2 WITH(NOLOCK)
			          ON   bac1.acnt_unt     = bac2.acnt_unt
			           AND bac1.acnt_yy      = bac2.acnt_yy
			           AND bac1.upr_acnt_cd  = bac2.acnt_cd
                    LEFT OUTER JOIN (SELECT  bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div
					                       , count(1) as calc_bss_cnt /* 산출건수 */
					                    FROM BG_FRMN_DET bfd WITH(NOLOCK)
					                   GROUP BY bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div) bfd
					  ON   bfr.acnt_unt     = bfd.acnt_unt
			           AND bfr.acnt_yy      = bfd.acnt_yy
			           AND bfr.budg_cd      = bfd.budg_cd
			           AND bfr.adj_ord_cd   = bfd.adj_ord_cd
			           AND bfr.acnt_cd      = bfd.acnt_cd
			           AND bfr.budg_org_id  = bfd.budg_org_id
			           AND bfr.biz_cd       = bfd.biz_cd
			           AND bfr.bal_div      = bfd.bal_div
                    LEFT OUTER JOIN (SELECT  bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div
					                       , sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                    FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					                   GROUP BY bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div) bfs             
					  ON   bfr.acnt_unt     = bfs.acnt_unt
			           AND bfr.acnt_yy      = bfs.acnt_yy
			           AND bfr.budg_cd      = bfs.budg_cd
			           AND bfr.adj_ord_cd   = bfs.adj_ord_cd
			           AND bfr.acnt_cd      = bfs.acnt_cd
			           AND bfr.budg_org_id  = bfs.budg_org_id
			           AND bfr.biz_cd       = bfs.biz_cd
			           AND bfr.bal_div      = bfs.bal_div			                       
                    LEFT OUTER JOIN (SELECT  ba1.acnt_unt
					                       , ba1.acnt_yy
					                       , ba1.budg_org_id
					                       , ba1.biz_cd
					                       , ba1.acnt_cd
					                       , ba1.bal_div
					                       , sum(ba1.budg_amt) as pre_year_budg_amt /* 전년도예산액 */
					                    FROM BG_ASGN ba1 WITH(NOLOCK)
					                   GROUP BY ba1.acnt_unt
					                       , ba1.acnt_yy
					                       , ba1.budg_org_id
					                       , ba1.biz_cd
					                       , ba1.acnt_cd
					                       , ba1.bal_div) ba2
					  ON   bfr.acnt_unt     = ba2.acnt_unt
			           AND bfr.acnt_yy-1    = ba2.acnt_yy
			           AND bfr.budg_org_id  = ba2.budg_org_id
			           AND bfr.biz_cd       = ba2.biz_cd
			           AND bfr.acnt_cd      = ba2.acnt_cd
			           AND bfr.bal_div      = ba2.bal_div
         WHERE bfr.acnt_unt     = #acntUnt#
           AND bfr.acnt_yy      = #acntYy#
           AND bfr.budg_cd      = #budgCd#
           <isNotEmpty property = "budgOrgId">
           AND bfr.budg_org_id  = #budgOrgId#
           </isNotEmpty>
           AND bfr.biz_cd       = #bizCd#
           AND bfr.bal_div      = #balDiv#
           <isNotEmpty property = "adjOrdCd">
           AND bfr.adj_ord_cd   = #adjOrdCd#
           </isNotEmpty>
           ORDER BY bfr.acnt_unt ,bfr.acnt_yy,bfr.budg_cd,bfr.acnt_cd
		</isEqual>
		
		<isEqual property="budgCd" compareValue="20">
		SELECT '0' AS chk
		      ,'' AS row_status
		      ,bfr.acnt_unt            /* 회계단위ID */
              ,bfr.acnt_yy                /* 회계년도 */
              ,bfr.budg_cd             /* 예산구분코드 */
              ,bfr.adj_ord_cd                /* 조정차수 */
              ,bfr.budg_org_id              /* 예산조직ID */
              ,(SELECT dbo.F_COM_DEPT_NM(bfr.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
              ,bfr.acnt_cd             /* 계정과목코드 */
              ,bfr.acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
              ,CASE WHEN #balDiv# = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END acnt_nm  /* 계정과목명 세목명 */
              ,CASE WHEN #balDiv# = '10' THEN bac2.acnt_inc_nm ELSE bac2.acnt_exp_nm END  mok_nm   /* 계정과목명 목명 */
              ,bfr.biz_cd                  /* 사업코드 */
              ,bb.biz_nm                   /* 사업명 */
              ,bfr.budg_amt                /* 예산액 */
              ,bfr.budg_cfm_dt            /* 예산확정일 */
              ,bfr.bal_div            /* 수지구분코드 */
	          ,bfd.calc_bss_cnt           /* 산출건수 */
              ,bfs.month_budg_amt          /* 원별편성액 */
              ,ISNULL((SELECT  sum(ba1.budg_amt)
                   FROM BG_ASGN ba1 WITH(NOLOCK)
                  WHERE ba1.acnt_yy = bfr.acnt_yy
                    AND ba1.acnt_unt = bfr.acnt_unt
                    AND ba1.budg_org_id = bfr.budg_org_id
                    AND ba1.biz_cd = bfr.biz_cd
                    AND ba1.acnt_cd = bfr.acnt_cd
                    AND ba1.bal_div = bfr.bal_div
                    AND ba1.budg_cd = '10' ), 0) pre_year_budg_amt      /* 본예산액 */
              ,ISNULL((SELECT SUM(BC.APLY_AMT)
                  FROM BG_CTRL BC
                 WHERE BC.ACNT_YY = BFR.ACNT_YY
                   AND BC.ACNT_UNT = BFR.ACNT_UNT
                   AND BC.BIZ_CD = BFR.BIZ_CD
                   AND BC.ACNT_CD = BFR.ACNT_CD
                   AND BC.BUDG_ORG_ID = BFR.BUDG_ORG_ID
                   AND BC.BAL_DIV = BFR.BAL_DIV
                ),0) aply_amt /* 집행액 */
              
          FROM BG_FRMN bfr WITH(NOLOCK)
                	LEFT OUTER JOIN BG_BIZ bb WITH(NOLOCK)
                	  ON   bfr.acnt_unt     = bb.acnt_unt
                	   AND bfr.biz_cd       = bb.biz_cd
                	LEFT OUTER JOIN BG_ACNT_CD bac1 WITH(NOLOCK)
                      ON   bfr.acnt_unt     = bac1.acnt_unt
                       AND bfr.acnt_yy      = bac1.acnt_yy
                       AND bfr.acnt_cd      = bac1.acnt_cd
                    LEFT OUTER JOIN BG_ACNT_CD bac2 WITH(NOLOCK)
			          ON   bac1.acnt_unt     = bac2.acnt_unt
			           AND bac1.acnt_yy      = bac2.acnt_yy
			           AND bac1.upr_acnt_cd  = bac2.acnt_cd
                    LEFT OUTER JOIN (SELECT  bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div
					                       , count(1) as calc_bss_cnt /* 산출건수 */
					                    FROM BG_FRMN_DET bfd WITH(NOLOCK)
					                   GROUP BY bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div) bfd
					  ON   bfr.acnt_unt     = bfd.acnt_unt
			           AND bfr.acnt_yy      = bfd.acnt_yy
			           AND bfr.budg_cd      = bfd.budg_cd
			           AND bfr.adj_ord_cd   = bfd.adj_ord_cd
			           AND bfr.acnt_cd      = bfd.acnt_cd
			           AND bfr.budg_org_id  = bfd.budg_org_id
			           AND bfr.biz_cd       = bfd.biz_cd
			           AND bfr.bal_div      = bfd.bal_div
                    LEFT OUTER JOIN (SELECT  bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div
					                       , sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                    FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					                   GROUP BY bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div) bfs             
					  ON   bfr.acnt_unt     = bfs.acnt_unt
			           AND bfr.acnt_yy      = bfs.acnt_yy
			           AND bfr.budg_cd      = bfs.budg_cd
			           AND bfr.adj_ord_cd   = bfs.adj_ord_cd
			           AND bfr.acnt_cd      = bfs.acnt_cd
			           AND bfr.budg_org_id  = bfs.budg_org_id
			           AND bfr.biz_cd       = bfs.biz_cd
			           AND bfr.bal_div      = bfs.bal_div
         WHERE bfr.acnt_unt     = #acntUnt#
           AND bfr.acnt_yy      = #acntYy#
           AND bfr.budg_cd      = #budgCd#
           <isNotEmpty property = "budgOrgId">
           AND bfr.budg_org_id  = #budgOrgId#
           </isNotEmpty>
           AND bfr.biz_cd       = #bizCd#
           AND bfr.bal_div      = #balDiv#
           <isNotEmpty property = "adjOrdCd">
           AND bfr.adj_ord_cd   = #adjOrdCd#
           </isNotEmpty>
           ORDER BY bfr.acnt_unt ,bfr.acnt_yy,bfr.budg_cd,bfr.acnt_cd
		</isEqual>
		
		<isEqual property="budgCd" compareValue="30">
		SELECT '0' AS chk
		      ,'' AS row_status
		      ,bfr.acnt_unt            /* 회계단위ID */
              ,bfr.acnt_yy                /* 회계년도 */
              ,bfr.budg_cd             /* 예산구분코드 */
              ,bfr.adj_ord_cd                /* 조정차수 */
              ,bfr.budg_org_id              /* 예산조직ID */
              ,(SELECT dbo.F_COM_DEPT_NM(bfr.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm		/* 예산조직명 */
              ,bfr.acnt_cd             /* 계정과목코드 */
              ,bfr.acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
              ,CASE WHEN #balDiv# = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END acnt_nm  /* 계정과목명 세목명 */
              ,CASE WHEN #balDiv# = '10' THEN bac2.acnt_inc_nm ELSE bac2.acnt_exp_nm END  mok_nm   /* 계정과목명 목명 */
              ,bfr.biz_cd                  /* 사업코드 */
              ,bb.biz_nm                   /* 사업명 */
              ,bfr.budg_amt                /* 예산액 */
              ,bfr.budg_cfm_dt            /* 예산확정일 */
              ,bfr.bal_div            /* 수지구분코드 */
	          ,bfd.calc_bss_cnt           /* 산출건수 */
              ,bfs.month_budg_amt          /* 원별편성액 */
              ,ISNULL((SELECT  sum(ba1.budg_amt)
                   FROM BG_ASGN ba1 WITH(NOLOCK)
                  WHERE ba1.acnt_yy = bfr.acnt_yy
                    AND ba1.acnt_unt = bfr.acnt_unt
                    AND ba1.budg_org_id = bfr.budg_org_id
                    AND ba1.biz_cd = bfr.biz_cd
                    AND ba1.acnt_cd = bfr.acnt_cd
                    AND ba1.bal_div = bfr.bal_div
                    AND ba1.budg_cd in ( '10', '20') ), 0) pre_year_budg_amt      /* 1차추경액 */
              ,ISNULL((SELECT SUM(BC.APLY_AMT)
                  FROM BG_CTRL BC
                 WHERE BC.ACNT_YY = BFR.ACNT_YY
                   AND BC.ACNT_UNT = BFR.ACNT_UNT
                   AND BC.BIZ_CD = BFR.BIZ_CD
                   AND BC.ACNT_CD = BFR.ACNT_CD
                   AND BC.BUDG_ORG_ID = BFR.BUDG_ORG_ID
                   AND BC.BAL_DIV = BFR.BAL_DIV
                ),0) aply_amt /* 집행액 */
              
          FROM BG_FRMN bfr WITH(NOLOCK)
                	LEFT OUTER JOIN BG_BIZ bb WITH(NOLOCK)
                	  ON   bfr.acnt_unt     = bb.acnt_unt
                	   AND bfr.biz_cd       = bb.biz_cd
                	LEFT OUTER JOIN BG_ACNT_CD bac1 WITH(NOLOCK)
                      ON   bfr.acnt_unt     = bac1.acnt_unt
                       AND bfr.acnt_yy      = bac1.acnt_yy
                       AND bfr.acnt_cd      = bac1.acnt_cd
                    LEFT OUTER JOIN BG_ACNT_CD bac2 WITH(NOLOCK)
			          ON   bac1.acnt_unt     = bac2.acnt_unt
			           AND bac1.acnt_yy      = bac2.acnt_yy
			           AND bac1.upr_acnt_cd  = bac2.acnt_cd
                    LEFT OUTER JOIN (SELECT  bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div
					                       , count(1) as calc_bss_cnt /* 산출건수 */
					                    FROM BG_FRMN_DET bfd WITH(NOLOCK)
					                   GROUP BY bfd.acnt_unt
					                       , bfd.acnt_yy
					                       , bfd.budg_cd
					                       , bfd.adj_ord_cd
					                       , bfd.acnt_cd
					                       , bfd.budg_org_id
					                       , bfd.biz_cd
					                       , bfd.bal_div) bfd
					  ON   bfr.acnt_unt     = bfd.acnt_unt
			           AND bfr.acnt_yy      = bfd.acnt_yy
			           AND bfr.budg_cd      = bfd.budg_cd
			           AND bfr.adj_ord_cd   = bfd.adj_ord_cd
			           AND bfr.acnt_cd      = bfd.acnt_cd
			           AND bfr.budg_org_id  = bfd.budg_org_id
			           AND bfr.biz_cd       = bfd.biz_cd
			           AND bfr.bal_div      = bfd.bal_div
                    LEFT OUTER JOIN (SELECT  bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div
					                       , sum(bfs.budg_amt) as month_budg_amt /* 원별편성액 */
					                    FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
					                   GROUP BY bfs.acnt_unt
					                       , bfs.acnt_yy
					                       , bfs.budg_cd
					                       , bfs.adj_ord_cd
					                       , bfs.acnt_cd
					                       , bfs.budg_org_id
					                       , bfs.biz_cd
					                       , bfs.bal_div) bfs             
					  ON   bfr.acnt_unt     = bfs.acnt_unt
			           AND bfr.acnt_yy      = bfs.acnt_yy
			           AND bfr.budg_cd      = bfs.budg_cd
			           AND bfr.adj_ord_cd   = bfs.adj_ord_cd
			           AND bfr.acnt_cd      = bfs.acnt_cd
			           AND bfr.budg_org_id  = bfs.budg_org_id
			           AND bfr.biz_cd       = bfs.biz_cd
			           AND bfr.bal_div      = bfs.bal_div
         WHERE bfr.acnt_unt     = #acntUnt#
           AND bfr.acnt_yy      = #acntYy#
           AND bfr.budg_cd      = #budgCd#
           <isNotEmpty property = "budgOrgId">
           AND bfr.budg_org_id  = #budgOrgId#
           </isNotEmpty>
           AND bfr.biz_cd       = #bizCd#
           AND bfr.bal_div      = #balDiv#
           <isNotEmpty property = "adjOrdCd">
           AND bfr.adj_ord_cd   = #adjOrdCd#
           </isNotEmpty>
           ORDER BY bfr.acnt_unt ,bfr.acnt_yy,bfr.budg_cd,bfr.acnt_cd
		</isEqual>

	</select>
	
	<insert id="admiDAO.insertBgFrmn" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgFrmn 편성예산 저장한다 */
		INSERT INTO BG_FRMN (
                acnt_unt       /* 회계단위IDz */
               ,acnt_yy           /* 회계년도 */
               ,budg_cd        /* 예산구분코드 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,budg_amt           /* 예산액 */
               ,budg_cfm_dt       /* 예산확정일 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */
               ) VALUES (
                #acntUnt#
               ,#acntYy#
               ,#budgCd#
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,CONVERT(BIGINT, #budgAmt#)
               ,#budgCfmDt#
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,'bg02030'
               )
	
	</insert>
	
	<update id="admiDAO.updateBgFrmn" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgFrmn 편성예산 수정한다 */
		UPDATE BG_FRMN
           SET budg_amt    = CONVERT(BIGINT, #budgAmt#)        /* 예산액 */
              ,acnt_cd     = #acntCd#         /* 계정과목코드 */
              ,update_dt   = GETDATE()        /* 최근수정사용자ID */
              ,update_id   = #updateId#       /* 최근수정일시 */
              ,update_ip   = #updateIp#       /* 최근수정IP */
              ,update_pgm  = 'bg02030'        /* 최근수정IP */
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           AND acnt_cd     = #keyAcntCd#
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
	</update>
	
	<delete id="admiDAO.deleteBgFrmn" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmn 편성예산삭제한다 */
		DELETE
          FROM BG_FRMN
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<insert id="admiDAO.insertBgChg" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgChg 변경예산 저장한다 */
		INSERT INTO BG_CHG (
                acnt_unt       /* 회계단위IDz */
               ,acnt_yy           /* 회계년도 */
               ,aply_org_id		/* 신청부서 */
               ,chg_seq        /* 변경신청순번 */
               ,budg_org_id         /* 예산조직ID */
               ,biz_cd             /* 사업코드 */
               ,acnt_cd        /* 계정과목코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,bal_div       /* 수지구분코드 */
               ,budg_amt           /* 예산액 */
               ,budg_cfm_dt       /* 예산확정일 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */
               ) VALUES (
                #acntUnt#
               ,#acntYy#
               ,#aplyOrgId#
               ,CONVERT(INT, #chgSeq#)
               ,#budgOrgId#
               ,#bizCd#
               ,#acntCd#
               ,#adjOrdCd#
               ,#balDiv#
               ,CONVERT(BIGINT, #budgAmt#)
               ,#budgCfmDt#
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,#insertPgm#
               )
	
	</insert>
	
	<update id="admiDAO.updateBgChg" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChg 변경예산 수정한다 */
		UPDATE BG_CHG
           SET budg_amt    = CONVERT(BIGINT, #budgAmt#)         /* 예산액 */
              ,acnt_cd     = #acntCd#       /* 계정과목코드 */
              ,update_dt   = GETDATE()    /* 최근수정사용자ID */
              ,update_id   = #updateId#            /* 최근수정일시 */
              ,update_ip   = #updateIp#      /* 최근수정IP */
              ,update_pgm  = #updatePgm#      /* 최근수정IP */
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND aply_org_id = #aplyOrgId#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND budg_org_id = #budgOrgId#
           AND biz_cd      = #bizCd#
           AND acnt_cd     = #keyAcntCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND bal_div     = #balDiv#
		
	</update>
	
	<delete id="admiDAO.deleteBgChg" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChg 변경예산삭제한다 */
		DELETE
          FROM BG_CHG
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND aply_org_id = #aplyOrgId#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND budg_org_id = #budgOrgId#
           AND biz_cd      = #bizCd#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND adj_ord_cd  = #adjOrdCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<select id="admiDAO.selectBgFrmnDetlist"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnDetlist 편성예산상세정보 조회한다. */
		SELECT '0' AS chk
		      ,'' AS row_status
		      ,acnt_unt    		/* 회계단위ID */
              ,acnt_yy     		/* 회계년도 */
              ,budg_cd     		/* 예산구분코드 */
              ,bal_div    		/* 수지구분코드 */
              ,adj_ord_cd       /* 조정차수 */
              ,budg_org_id      /* 예산조직ID */
              ,acnt_cd     		/* 계정과목코드 */
              ,acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
              ,biz_cd          	/* 사업코드 */
              ,seq         	    /* 품목순번 */
              ,itm_nm          	/* 품목명 */
              ,itm_seq         	/* 세세목 */
              ,calc_bss    		/* 산출근거명 */
              ,budg_amt       	/* 예산액 */
              ,new_biz_yn		/* 신규사업여부 */
              ,pre_budg_amt     /* 본예산액, 1차추경액 */
              ,chg_desc         /* 변경사유 */
          FROM BG_FRMN_DET WITH(NOLOCK)
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND acnt_cd     = #acntCd#
           AND budg_org_id = #budgOrgId#
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
         ORDER BY acnt_unt,acnt_yy,acnt_cd,biz_cd ,seq   
		
	</select>

	<select id="admiDAO.selectFrmnDetSeq" parameterClass="java.util.HashMap" resultClass="Integer">
		SELECT ISNULL(max(CONVERT(INT, seq)),0)+1
           FROM BG_FRMN_DET WITH(NOLOCK)
          WHERE acnt_unt    = #acntUnt#
            AND acnt_yy     = #acntYy#
            AND budg_cd     = #budgCd#
            AND adj_ord_Cd  = #adjOrdCd#
            AND budg_org_id = #budgOrgId#
            AND acnt_cd     = #acntCd#
            AND biz_cd      = #bizCd#
            AND bal_div     = #balDiv#
	</select>
	
	<insert id="admiDAO.insertBgFrmnDet" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgFrmnDet 편성예산상세 저장한다 */
		BEGIN		
		
	        INSERT INTO BG_FRMN_DET (
	                acnt_unt       /* 회계단위IDzz */
	               ,acnt_yy           /* 회계년도 */
	               ,budg_cd        /* 예산구분코드 */
	               ,bal_div       /* 수지구분코드 */
	               ,adj_ord_cd           /* 조정차수 */
	               ,budg_org_id         /* 예산조직ID */
	               ,acnt_cd        /* 계정과목코드 */
	               ,biz_cd             /* 사업코드 */
	               ,seq            /* 품목순번 */
	               ,itm_nm             /* 품목명 */
	               ,calc_bss       /* 산출근거명 */
	               ,itm_seq            /* 세세목 */
	               ,budg_amt           /* 예산액 */
	               ,new_biz_yn		/* 신규사업여부 */
	               ,chg_desc        /* 변경사유 */
	               ,insert_dt          /* 입력일시 */
	               ,insert_id           /* 입력사용자ID */
	               ,insert_ip           /* 입력사용자IP */
	               ,insert_pgm           /* 입력PROGRAM */)
	            VALUES (
	                #acntUnt#
	               ,#acntYy#
	               ,#budgCd#
	               ,#balDiv#
	               ,#adjOrdCd#
	               ,#budgOrgId#
	               ,#acntCd#
	               ,#bizCd#
	               ,CONVERT(INT, #seq#)
	               ,#itmNm#
	               ,#calcBss#
	               ,CONVERT(INT,#itmSeq#)
	               ,CONVERT(BIGINT,#budgAmt#)
	               ,#newBizYn#
	               ,#chgDesc#
	               ,GETDATE()
	               ,#insertId#
	               ,#insertIp#
	               ,'bg02030'
	               )
	     
	    	UPDATE BG_FRMN
	    	   SET BUDG_AMT = ISNULL(( SELECT SUM(BUDG_AMT)
	    	                      FROM BG_FRMN_DET
	    	                     WHERE ACNT_UNT = #acntUnt#
	    	                       AND ACNT_YY  = #acntYy#
	    	                       AND BUDG_CD  = #budgCd#
	    	                       AND BAL_DIV  = #balDiv#
	    	                       AND ADJ_ORD_CD = #adjOrdCd#
	    	                       AND BUDG_ORG_ID = #budgOrgId#
	    	                       AND ACNT_CD  = #acntCd#
	    	                       AND BIZ_CD   = #bizCd#	    	   
	    	                    ), 0)
	    	 WHERE ACNT_UNT = #acntUnt#
               AND ACNT_YY  = #acntYy#
               AND BUDG_CD  = #budgCd#
               AND BAL_DIV  = #balDiv#
               AND ADJ_ORD_CD = #adjOrdCd#
               AND BUDG_ORG_ID = #budgOrgId#
               AND ACNT_CD  = #acntCd#
               AND BIZ_CD   = #bizCd#	    
	               
	    END
	</insert>
	
	<update id="admiDAO.updateBgFrmnDet" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgFrmnDet 편성예산상세 수정한다 */
		BEGIN
		
			UPDATE BG_FRMN_DET
	           SET itm_nm         = #itmNm#          /* 품목명 */
	              ,itm_seq        = CONVERT(INT,#itmSeq#)          /* 세세목 */
	              ,calc_bss       = #calcBss#     /* 산출근거명 */
	              ,budg_amt       = CONVERT(BIGINT,#budgAmt#)        /* 예산액 */
	              ,acnt_cd        = #acntCd#       /* 계정과목코드 */
	              ,new_biz_yn	  = #newBizYn#	    /* 신규사업여부 */
	              ,chg_desc       = #chgDesc#
	              ,update_dt      = GETDATE()    /* 최근수정사용자ID */
	              ,update_id      = #updateId#            /* 최근수정일시 */
	              ,update_ip      = #updateIp#      /* 최근수정IP */
	              ,update_pgm     = 'bg02030'      /* 최근수정IP */
	         WHERE acnt_unt       = #acntUnt#
	           AND acnt_yy        = #acntYy#
	           AND budg_cd        = #budgCd#
	           AND adj_ord_cd     = #adjOrdCd#
	           AND budg_org_id    = #budgOrgId#
	           AND acnt_cd        = #keyAcntCd#
	           AND biz_cd         = #bizCd#
	           AND seq            = CONVERT(INT, #seq#)
	           AND bal_div        = #balDiv#
		
	    	UPDATE BG_FRMN
	    	   SET BUDG_AMT = ISNULL(( SELECT SUM(BUDG_AMT)
	    	                      FROM BG_FRMN_DET
	    	                     WHERE ACNT_UNT = #acntUnt#
	    	                       AND ACNT_YY  = #acntYy#
	    	                       AND BUDG_CD  = #budgCd#
	    	                       AND BAL_DIV  = #balDiv#
	    	                       AND ADJ_ORD_CD = #adjOrdCd#
	    	                       AND BUDG_ORG_ID = #budgOrgId#
	    	                       AND ACNT_CD  = #acntCd#
	    	                       AND BIZ_CD   = #bizCd#	    	   
	    	                    ), 0)
	    	 WHERE ACNT_UNT = #acntUnt#
               AND ACNT_YY  = #acntYy#
               AND BUDG_CD  = #budgCd#
               AND BAL_DIV  = #balDiv#
               AND ADJ_ORD_CD = #adjOrdCd#
               AND BUDG_ORG_ID = #budgOrgId#
               AND ACNT_CD  = #acntCd#
               AND BIZ_CD   = #bizCd#	    
		
		END
	</update>
	
	<delete id="admiDAO.deleteBgFrmnDet" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnDet 편성예산상세 삭제한다 */
		BEGIN
		
			DELETE
	          FROM BG_FRMN_DET
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND budg_cd     = #budgCd#
	           AND adj_ord_cd  = #adjOrdCd#
	           AND budg_org_id = #budgOrgId#
	           AND acnt_cd     = #acntCd#
	           AND biz_cd      = #bizCd#
	           AND bal_div     = #balDiv#
	           AND seq         = CONVERT(INT, #seq#)
	           
			DELETE
	          FROM BG_FRMN_SCHED
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND budg_cd     = #budgCd#
	           AND adj_ord_cd  = #adjOrdCd#
	           AND budg_org_id = #budgOrgId#
	           AND acnt_cd     = #acntCd#
	           AND biz_cd      = #bizCd#
	           AND bal_div     = #balDiv#
	           AND seq         = CONVERT(INT, #seq#)
		
	    	UPDATE BG_FRMN
	    	   SET BUDG_AMT = ISNULL(( SELECT SUM(BUDG_AMT)
	    	                      FROM BG_FRMN_DET
	    	                     WHERE ACNT_UNT = #acntUnt#
	    	                       AND ACNT_YY  = #acntYy#
	    	                       AND BUDG_CD  = #budgCd#
	    	                       AND BAL_DIV  = #balDiv#
	    	                       AND ADJ_ORD_CD = #adjOrdCd#
	    	                       AND BUDG_ORG_ID = #budgOrgId#
	    	                       AND ACNT_CD  = #acntCd#
	    	                       AND BIZ_CD   = #bizCd#	    	   
	    	                    ), 0)
	    	 WHERE ACNT_UNT = #acntUnt#
               AND ACNT_YY  = #acntYy#
               AND BUDG_CD  = #budgCd#
               AND BAL_DIV  = #balDiv#
               AND ADJ_ORD_CD = #adjOrdCd#
               AND BUDG_ORG_ID = #budgOrgId#
               AND ACNT_CD  = #acntCd#
               AND BIZ_CD   = #bizCd#	    
		
		END
	</delete>
	
	<insert id="admiDAO.insertBgChgDet" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgChgDet 변경예산상세 저장한다 */
        INSERT INTO BG_CHG_DET (
                acnt_unt       /* 회계단위IDzz */
               ,acnt_yy           /* 회계년도 */
               ,chg_seq        /* 변경신청순번 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,seq            /* 품목순번 */
               ,itm_nm             /* 품목명 */
               ,calc_bss       /* 산출근거명 */
               ,itm_seq            /* 세세목 */
               ,budg_amt           /* 예산액 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */)
            VALUES (
                #acntUnt#
               ,#acntYy#
               ,CONVERT(INT, #chgSeq#)
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,(SELECT ISNULL(max(seq),'0')+1
		           FROM BG_CHG_DET
		          WHERE acnt_unt    = #acntUnt#
		            AND acnt_yy     = #acntYy#
		            AND chg_seq     = CONVERT(INT, #chgSeq#)
		            AND adj_ord_Cd  = #adjOrdCd#
		            AND budg_org_id = #budgOrgId#
		            AND acnt_cd     = #acntCd#
		            AND biz_cd      = #bizCd#
		            AND bal_div     = #balDiv#)
               ,#itmNm#
               ,#calcBss#
               ,CONVERT(INT,#itmSeq#)
               ,CONVERT(BIGINT,#budgAmt#)
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,#insertPgm#
               )
	</insert>
	
	<update id="admiDAO.updateBgChgDet" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChgDet 변경예산상세 수정한다 */
		UPDATE BG_CHG_DET
           SET itm_nm         = #itmNm#          /* 품목명 */
              ,itm_seq        = CONVERT(INT,#itmSeq#)          /* 세세목 */
              ,calc_bss       = #calcBss#     /* 산출근거명 */
              ,budg_amt       = CONVERT(BIGINT,#budgAmt#)      /* 예산액 */
              ,acnt_cd        = #acntCd#       /* 계정과목코드 */
              ,update_dt      = GETDATE()    /* 최근수정사용자ID */
              ,update_id      = #updateId#            /* 최근수정일시 */
              ,update_ip      = #updateIp#      /* 최근수정IP */
              ,update_pgm     = 'bg02030'      /* 최근수정IP */
         WHERE acnt_unt       = #acntUnt#
           AND acnt_yy        = #acntYy#
           AND chg_seq        = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd     = #adjOrdCd#
           AND budg_org_id    = #budgOrgId#
           AND acnt_cd        = #keyAcntCd#
           AND biz_cd         = #bizCd#
           AND seq            = CONVERT(INT,#seq#)
           AND bal_div        = #balDiv#
		
	</update>
	
	<delete id="admiDAO.deleteBgChgDet" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChgDet 편성예산상세 삭제한다 */
		DELETE
          FROM BG_CHG_DET
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           AND seq         = CONVERT(INT, #seq#)
		
	</delete>
	
	<delete id="admiDAO.deleteBgFrmnDetDel" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnDet 편성예산상세 일괄 삭제한다 */
		DELETE
          FROM BG_FRMN_DET
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<delete id="admiDAO.deleteBgChgDetDel" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChgDetDel 변경예산상세 일괄 삭제한다 */
		DELETE
          FROM BG_CHG_DET
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<select id="admiDAO.selectBgFrmnSchedList"  parameterClass="java.util.HashMap" resultClass="egovMap">   
		/* admiDAO.selectBgFrmnSchedList 편성예산계획정보 조회한다. */
		SELECT '0' AS chk
		      ,'' AS row_status
		      ,acnt_unt    /* 회계단위ID */
              ,acnt_yy        /* 회계년도 */
              ,budg_cd     /* 예산구분코드 */
              ,adj_ord_cd        /* 조정차수 */
              ,budg_org_id      /* 예산조직ID */
              ,acnt_cd     /* 계정과목코드 */
              ,acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
              ,biz_cd          /* 사업코드 */
              ,budg_yymm       /* 편성년월 */
              ,budg_amt        /* 편성액 */
              ,bal_div    /* 수지구분코드 */
              ,seq			/* 품목순번 */
          FROM BG_FRMN_SCHED WITH(NOLOCK)
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND acnt_cd     = #acntCd#
           AND budg_org_id = #budgOrgId#
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           AND seq         = CONVERT(INT, #seq#)
         ORDER BY budg_yymm
		
	</select>
	
	<insert id="admiDAO.insertBgFrmnSched" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgFrmnSched 편성예산계획 등록한다 */
		INSERT INTO BG_FRMN_SCHED (
                acnt_unt       /* 회계단위ID */
               ,acnt_yy           /* 회계년도 */
               ,budg_cd        /* 예산구분코드 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,budg_yymm          /* 편성년월 */
               ,budg_amt           /* 편성액 */
               ,seq				   /* 품목순번 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */)
            VALUES (
                #acntUnt#
               ,#acntYy#
               ,#budgCd#
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,#budgYymm#
               ,CONVERT(BIGINT,ISNULL(#budgAmt#,0))
               ,CONVERT(INT, #seq#)
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,'bg02030')
		
	</insert>
	
	<insert id="admiDAO.insertBgFrmnSchedRemove" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgFrmnSchedRemove 편성예산계획 등록한다 */
		INSERT INTO BG_FRMN_SCHED (
                acnt_unt       /* 회계단위ID */
               ,acnt_yy           /* 회계년도 */
               ,budg_cd        /* 예산구분코드 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,budg_yymm          /* 편성년월 */
               ,budg_amt           /* 편성액 */
               ,seq				   /* 품목순번 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */)
            VALUES (
                #acntUnt#
               ,#acntYy#
               ,#budgCd#
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,#budgYymm#
               ,CONVERT(BIGINT,ISNULL(#budgAmt#,0))
               ,CONVERT(INT,#seq#)
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,'bg02030')
		
	</insert>
	
	<insert id="admiDAO.insertBgChgSchedRemove" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgChgSchedRemove 변경예산계획 등록한다 */
		INSERT INTO BG_CHG_SCHED (
                acnt_unt       /* 회계단위ID */
               ,acnt_yy           /* 회계년도 */
               ,chg_seq        /* 변경신청순번 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,budg_yymm          /* 편성년월 */
               ,budg_amt           /* 편성액 */
               ,seq				   /* 품목순번 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */)
            VALUES (
                #acntUnt#
               ,#acntYy#
               ,CONVERT(INT,#chgSeq#)
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,#budgYymm#
               ,CONVERT(BIGINT,ISNULL(#budgAmt#,0))
               ,CONVERT(INT,#seq#)
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,'bg02030')
		
	</insert>
	
	<update id="admiDAO.updateBgFrmnSched" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgFrmnSched 편성예산계획 수정한다 */
		UPDATE BG_FRMN_SCHED
           SET budg_amt      = CONVERT(BIGINT,ISNULL(#budgAmt#,0))   /* 편성액 */
              ,acnt_cd       = #acntCd#        /* 계정과목코드 */
              ,update_dt     = GETDATE()    /* 최근수정사용자ID */
              ,update_id     = #updateId#            /* 최근수정일시 */
              ,update_ip     = #updateIp#      /* 최근수정IP */
              ,update_pgm    = 'bg02030'      /* 최근수정IP */
         WHERE acnt_unt  = #acntUnt#
           AND acnt_yy      = #acntYy#
           AND budg_cd   = #budgCd#
           AND adj_ord_cd      = #adjOrdCd#
           AND budg_org_id    = #budgOrgId#
           AND acnt_cd   = #keyAcntCd#
           AND biz_cd        = #bizCd#
           AND budg_yymm     = #budgYymm#
           AND bal_div  = #balDiv#
           AND seq      = CONVERT(INT,#seq#)
		
	</update>
	
	<delete id="admiDAO.deleteBgFrmnSched" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnSched 편성예산계획삭제한다 */
		DELETE
          FROM BG_FRMN_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           <isNotEmpty property = "budgYymm">
           AND budg_yymm   = #budgYymm#
           </isNotEmpty>
           <isNotEmpty property = "seq">
           AND seq         = CONVERT(INT, #seq#)
           </isNotEmpty>
		
	</delete>
	
	<insert id="admiDAO.insertBgChgSched" parameterClass="java.util.HashMap">
		/* admiDAO.insertBgChgSched 변경예산계획 등록한다 */
		INSERT INTO BG_CHG_SCHED (
                acnt_unt       /* 회계단위ID */
               ,acnt_yy           /* 회계년도 */
               ,chg_seq        /* 변경신청순번 */
               ,bal_div       /* 수지구분코드 */
               ,adj_ord_cd           /* 조정차수 */
               ,budg_org_id         /* 예산조직ID */
               ,acnt_cd        /* 계정과목코드 */
               ,biz_cd             /* 사업코드 */
               ,budg_yymm          /* 편성년월 */
               ,budg_amt           /* 편성액 */
               ,seq				   /* 품목순번 */
               ,insert_dt          /* 입력일시 */
               ,insert_id           /* 입력사용자ID */
               ,insert_ip           /* 입력사용자IP */
               ,insert_pgm           /* 입력PROGRAM */)
            VALUES (
                #acntUnt#
               ,#acntYy#
               ,CONVERT(INT, #chgSeq#)
               ,#balDiv#
               ,#adjOrdCd#
               ,#budgOrgId#
               ,#acntCd#
               ,#bizCd#
               ,#budgYymm#
               ,ISNULL(#budgAmt#,0)
               ,(SELECT ISNULL(max(CONVERT(INT,seq)),'0')
		           FROM BG_CHG_DET
		          WHERE acnt_unt    = #acntUnt#
		            AND acnt_yy     = #acntYy#
		            AND chg_seq     = CONVERT(INT, #chgSeq#)
		            AND adj_ord_Cd  = #adjOrdCd#
		            AND budg_org_id = #budgOrgId#
		            AND acnt_cd     = #acntCd#
		            AND biz_cd      = #bizCd#
		            AND bal_div     = #balDiv#)
               ,GETDATE()
               ,#insertId#
               ,#insertIp#
               ,#insertPgm#)
		
	</insert>
	
	<update id="admiDAO.updateBgChgSched" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChgSched 변경예산계획 수정한다 */
		UPDATE BG_CHG_SCHED
           SET budg_amt      = CONVERT(BIGINT,ISNULL(#budgAmt#,0))   /* 편성액 */
              ,acnt_cd       = #acntCd#        /* 계정과목코드 */
              ,update_dt     = GETDATE()    /* 최근수정사용자ID */
              ,update_id     = #updateId#            /* 최근수정일시 */
              ,update_ip     = #updateIp#      /* 최근수정IP */
              ,update_pgm    = #updatePgm#      /* 최근수정IP */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND chg_seq       = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd    = #adjOrdCd#
           AND budg_org_id   = #budgOrgId#
           AND acnt_cd       = #keyAcntCd#
           AND biz_cd        = #bizCd#
           AND budg_yymm     = #budgYymm#
           AND bal_div       = #balDiv#
           AND seq           = CONVERT(INT, #seq#)
		
	</update>
	
	<delete id="admiDAO.deleteBgChgSched" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChgSched 변경예산계획삭제한다 */
		DELETE
          FROM BG_CHG_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           <isNotEmpty property = "budgYymm">
           AND budg_yymm   = #budgYymm#
           </isNotEmpty>
           <isNotEmpty property = "seq">
           AND seq         = CONVERT(INT, #seq#)
           </isNotEmpty>
		
	</delete>
	
	<delete id="admiDAO.deleteBgFrmnSchedRemove" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnSched 편성예산계획삭제한다 */
		DELETE
          FROM BG_FRMN_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           <isNotEmpty property = "budgYymm">
           AND budg_yymm   = #budgYymm#
           </isNotEmpty>
           AND seq         = CONVERT(INT, #seq#)
		
	</delete>
	
	<delete id="admiDAO.deleteBgChgSchedRemove" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChgSchedRemove 변경예산계획삭제한다 */
		DELETE
          FROM BG_CHG_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           <isNotEmpty property = "acntCd">
           AND acnt_cd     = #acntCd#
           </isNotEmpty>
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
           <isNotEmpty property = "budgYymm">
           AND budg_yymm   = #budgYymm#
           </isNotEmpty>
           AND seq         = CONVERT(INT, #seq#)
		
	</delete>

	<delete id="admiDAO.deleteBgFrmnAll" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnAll 편성예산계획삭제한다 */
		BEGIN
		
			DELETE
	          FROM BG_FRMN_SCHED
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND budg_cd     = #budgCd#
	           AND adj_ord_cd  = #adjOrdCd#
	           AND budg_org_id = #budgOrgId#
	           AND acnt_cd     = #acntCd#
	           AND biz_cd      = #bizCd#
	           AND bal_div     = #balDiv#
		
			DELETE
	          FROM BG_FRMN_DET
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND budg_cd     = #budgCd#
	           AND adj_ord_cd  = #adjOrdCd#
	           AND budg_org_id = #budgOrgId#
	           AND acnt_cd     = #acntCd#
	           AND biz_cd      = #bizCd#
	           AND bal_div     = #balDiv#
		
			DELETE
	          FROM BG_FRMN
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND budg_cd     = #budgCd#
	           AND adj_ord_cd  = #adjOrdCd#
	           AND budg_org_id = #budgOrgId#
	           AND acnt_cd     = #acntCd#
	           AND biz_cd      = #bizCd#
	           AND bal_div     = #balDiv#
		
		END
	</delete>


	
	<delete id="admiDAO.deleteBgFrmnSchedDel" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnSched 편성예산계획삭제한다 */
		DELETE
          FROM BG_FRMN_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_cd     = #budgCd#
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           AND acnt_cd     = #acntCd#
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<delete id="admiDAO.deleteBgChgSchedDel" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgChgSched 변경예산계획삭제한다 */
		DELETE
          FROM BG_CHG_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND adj_ord_cd  = #adjOrdCd#
           AND budg_org_id = #budgOrgId#
           AND acnt_cd     = #acntCd#
           AND biz_cd      = #bizCd#
           AND bal_div     = #balDiv#
		
	</delete>
	
	<insert id="admiDAO.insertBgFrmnChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgFrmnChg 1차조정이후 계정과목 등록/삭제 BG_FRMN  */
        
        INSERT INTO BG_FRMN (
                    acnt_unt       /* 회계단위ID */
                   ,acnt_yy           /* 회계년도 */
                   ,budg_cd        /* 예산구분코드 */
                   ,bal_div       /* 수지구분코드 */
                   ,adj_ord_cd           /* 조정차수 */
                   ,budg_org_id         /* 예산조직ID */
                   ,acnt_cd        /* 계정과목코드 */
                   ,biz_cd             /* 사업코드 */
                   ,budg_amt           /* 예산액 */
                   ,budg_cfm_dt       /* 예산확정일 */
                   ,insert_dt          /* 입력일시 */
	               ,insert_id           /* 입력사용자ID */
	               ,insert_ip           /* 입력사용자IP */
	               ,insert_pgm           /* 입력PROGRAM */
                   )
                    SELECT  acnt_unt             /* 회계단위ID */
                           ,acnt_yy                 /* 회계년도 */
                           ,budg_cd              /* 예산구분코드 */
                           ,bal_div             /* 수지구분코드 */
                           ,adj_ord_cd                 /* 조정차수 */
                           ,budg_org_id               /* 예산조직ID */
                           ,#acntCd#             /* 계정과목코드 */
                           ,#bizCd#                   /* 사업코드 */
                           ,budg_amt                 /* 예산액 */
                           ,budg_cfm_dt             /* 예산확정일 */
                           ,GETDATE()					 /* 입력일시 */
                           ,#insertId#              /* 입력사용자ID */
                           ,#insertIp#                 /* 입력IP */     
                           ,'bg02030'				/* 입력PGM */              
                      FROM BG_FRMN
                     WHERE acnt_unt    = #acntUnt#
                       AND acnt_yy     = #acntYy#
                       AND budg_org_id = #budgOrgId#
                       AND bal_div	   = #balDiv#
                       AND budg_cd     = #budgCd#
                       AND acnt_cd     = #keyAcntCd#
                       AND biz_cd      = #KeyBizCd#
                       AND adj_ord_cd  = #adjOrdCd#
    </insert>

    <insert id="admiDAO.insertBgFrmnDetChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgFrmnDetChg 1차조정이후 계정과목 등록/삭제 BG_FRMN_DET  */
        INSERT INTO BG_FRMN_DET (
                        acnt_unt        /* 회계단위IDzz */
                       ,acnt_yy            /* 회계년도 */
                       ,budg_cd         /* 예산구분코드 */
                       ,bal_div        /* 수지구분코드 */
                       ,adj_ord_cd            /* 조정차수 */
                       ,budg_org_id          /* 예산조직ID */
                       ,acnt_cd         /* 계정과목코드 */
                       ,biz_cd              /* 사업코드 */
                       ,seq             /* 품목순번 */
                       ,itm_nm              /* 품목명 */
                       ,itm_seq             /* 세세목 */
                       ,calc_bss        /* 산출근거명 */
                       ,budg_amt            /* 예산액 */
                       ,new_biz_yn		/* 신규사업여부 */
                       ,insert_dt          /* 입력일시 */
		               ,insert_id           /* 입력사용자ID */
		               ,insert_ip           /* 입력사용자IP */
		               ,insert_pgm           /* 입력PROGRAM */
                       )
                       SELECT  acnt_unt              /* 회계단위IDzz */
                              ,acnt_yy                  /* 회계년도 */
                              ,budg_cd               /* 예산구분코드 */
                              ,bal_div              /* 수지구분코드 */
                              ,adj_ord_cd                  /* 조정차수 */
                              ,budg_org_id                /* 예산조직ID */
                              ,#acctSbjCd#              /* 계정과목코드 */
                              ,#bizCd#                    /* 사업코드 */
                              ,seq                   /* 품목순번 */
                              ,itm_nm                    /* 품목명 */
                              ,itm_seq                   /* 세세목 */
                              ,calc_bss              /* 산출근거명 */
                              ,budg_amt                  /* 예산액 */
                              ,new_biz_yn		/* 신규사업여부 */
                              ,GETDATE()					 /* 입력일시 */
	                           ,#insertId#              /* 입력사용자ID */
	                           ,#insertIp#                 /* 입력IP */     
	                           ,'bg02030'				/* 입력PGM */ 
                         FROM  BG_FRMN_DET WITH(NOLOCK)
                        WHERE acnt_unt = #acntUnt#
                          AND acnt_yy     = #acntYy#
                          AND budg_org_id   = #budgOrgId#
                          AND bal_div = #balDiv#
                          AND budg_cd  = #budgCd#
                          AND acnt_cd  = #keyAcntCd#
                          AND biz_cd       = #KeyBizCd#
                          AND adj_ord_cd     = #adjOrdCd#

    </insert>

    <insert id="admiDAO.insertBgFrmnSchedChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgFrmnSchedChg 1차조정이후 계정과목 등록/삭제 BG_FRMN_SCHED  */
        
        INSERT INTO BG_FRMN_SCHED (
                        acnt_unt              /* 회계단위ID */
                       ,acnt_yy                  /* 회계년도 */
                       ,budg_cd               /* 예산구분코드 */
                       ,bal_div              /* 수지구분코드 */
                       ,adj_ord_cd                  /* 조정차수 */
                       ,budg_org_id                /* 예산조직ID */
                       ,acnt_cd               /* 계정과목코드 */
                       ,biz_cd                    /* 사업코드 */
                       ,budg_yymm                 /* 편성년월 */
                       ,budg_amt                  /* 편성액 */
                       ,seq					/* 품목순번 */
                       ,insert_dt          /* 입력일시 */
		               ,insert_id           /* 입력사용자ID */
		               ,insert_ip           /* 입력사용자IP */
		               ,insert_pgm           /* 입력PROGRAM */
                       )
                       SELECT  acnt_unt              /* 회계단위ID */
                              ,acnt_yy                  /* 회계년도 */
                              ,budg_cd               /* 예산구분코드 */
                              ,bal_div              /* 수지구분코드 */
                              ,adj_ord_cd                  /* 조정차수 */
                              ,budg_org_id                /* 예산조직ID */
                              ,#acctSbjCd#              /* 계정과목코드 */
                              ,#bizCd#                    /* 사업코드 */
                              ,budg_yymm                 /* 편성년월 */
                              ,budg_amt                  /* 편성액 */
                              ,seq					/* 품목순번 */
                              ,GETDATE()					 /* 입력일시 */
	                          ,#insertId#              /* 입력사용자ID */
	                          ,#insertIp#                 /* 입력IP */     
	                          ,'bg02030'				/* 입력PGM */ 
                         FROM  BG_FRMN_SCHED bfs WITH(NOLOCK)
                        WHERE acnt_unt = #acntUnt#
                          AND acnt_yy     = #acntYy#
                          AND budg_org_id   = #budgOrgId#
                          AND bal_div = #balDiv#
                          AND budg_cd  = #budgCd#
                          AND acnt_cd  = #keyAcntCd#
                          AND biz_cd       = #KeyBizCd#
                          AND adj_ord_cd     = #adjOrdCd#

    </insert>

    <delete id="admiDAO.deleteBgFrmnChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgFrmnChg 1차조정이후 계정과목 등록/삭제 BG_FRMN */
        DELETE
          FROM BG_FRMN
         WHERE acnt_unt = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id   = #budgOrgId#
           AND bal_div = #balDiv#
           AND budg_cd  = #budgCd#
           AND acnt_cd  = #keyAcntCd#
           AND biz_cd       = #KeyBizCd#
           AND adj_ord_cd     = #adjOrdCd#
    </delete>

    <delete id="admiDAO.deleteBgFrmnDetChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgFrmnDetChg 1차조정이후 계정과목 등록/삭제 BG_FRMN_DET */
        DELETE
          FROM BG_FRMN_DET
         WHERE acnt_unt   = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id = #budgOrgId#
           AND bal_div     = #balDiv#
           AND budg_cd     = #budgCd#
           AND acnt_cd     = #keyAcntCd#
           AND biz_cd      = #KeyBizCd#
           AND adj_ord_cd  = #adjOrdCd#
    </delete>

    <delete id="admiDAO.deleteBgFrmnSchedChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgFrmnSchedChg 1차조정이후 계정과목 등록/삭제 BG_FRMN_SCHED */
        DELETE
          FROM BG_FRMN_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id = #budgOrgId#
           AND bal_div     = #balDiv#
           AND budg_cd     = #budgCd#
           AND acnt_cd     = #keyAcntCd#
           AND biz_cd      = #KeyBizCd#
           AND adj_ord_cd  = #adjOrdCd#

    </delete>
    
    <insert id="admiDAO.insertBgChgChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgChgChg 1차조정이후 계정과목 등록/삭제 BG_CHG  */
        
        INSERT INTO BG_CHG (
                    acnt_unt       /* 회계단위ID */
                   ,acnt_yy           /* 회계년도 */
                   ,chg_seq        /* 예산구분코드 */
                   ,bal_div       /* 수지구분코드 */
                   ,adj_ord_cd           /* 조정차수 */
                   ,budg_org_id         /* 예산조직ID */
                   ,acnt_cd        /* 계정과목코드 */
                   ,biz_cd             /* 사업코드 */
                   ,budg_amt           /* 예산액 */
                   ,budg_cfm_dt       /* 예산확정일 */
                   ,insert_dt          /* 입력일시 */
	               ,insert_id           /* 입력사용자ID */
	               ,insert_ip           /* 입력사용자IP */
	               ,insert_pgm           /* 입력PROGRAM */
                   )
                    SELECT  acnt_unt             /* 회계단위ID */
                           ,acnt_yy                 /* 회계년도 */
                           ,chg_seq              /* 예산구분코드 */
                           ,bal_div             /* 수지구분코드 */
                           ,adj_ord_cd                 /* 조정차수 */
                           ,budg_org_id               /* 예산조직ID */
                           ,#acntCd#             /* 계정과목코드 */
                           ,#bizCd#                   /* 사업코드 */
                           ,budg_amt                 /* 예산액 */
                           ,budg_cfm_dt             /* 예산확정일 */
                           ,GETDATE()					 /* 입력일시 */
                           ,#insertId#              /* 입력사용자ID */
                           ,#insertIp#                 /* 입력IP */     
                           ,#insertPgm#				/* 입력PGM */              
                      FROM BG_CHG WITH(NOLOCK)
                     WHERE acnt_unt    = #acntUnt#
                       AND acnt_yy     = #acntYy#
                       AND budg_org_id = #budgOrgId#
                       AND bal_div	   = #balDiv#
                       AND chg_seq     = CONVERT(INT, #chgSeq#)
                       AND acnt_cd     = #keyAcntCd#
                       AND biz_cd      = #KeyBizCd#
                       AND adj_ord_cd  = #adjOrdCd#
    </insert>

    <insert id="admiDAO.insertBgChgDetChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgChgDetChg 1차조정이후 계정과목 등록/삭제 BG_CHG_DET  */
        
        INSERT INTO BG_CHG_DET (
                        acnt_unt        /* 회계단위IDzz */
                       ,acnt_yy            /* 회계년도 */
                       ,chg_seq         /* 예산구분코드 */
                       ,bal_div        /* 수지구분코드 */
                       ,adj_ord_cd            /* 조정차수 */
                       ,budg_org_id          /* 예산조직ID */
                       ,acnt_cd         /* 계정과목코드 */
                       ,biz_cd              /* 사업코드 */
                       ,seq             /* 품목순번 */
                       ,itm_nm              /* 품목명 */
                       ,itm_seq             /* 세세목 */
                       ,calc_bss        /* 산출근거명 */
                       ,budg_amt            /* 예산액 */
                       ,insert_dt          /* 입력일시 */
		               ,insert_id           /* 입력사용자ID */
		               ,insert_ip           /* 입력사용자IP */
		               ,insert_pgm           /* 입력PROGRAM */
                       )
                       SELECT  acnt_unt              /* 회계단위IDzz */
                              ,acnt_yy                  /* 회계년도 */
                              ,chg_seq               /* 예산구분코드 */
                              ,bal_div              /* 수지구분코드 */
                              ,adj_ord_cd                  /* 조정차수 */
                              ,budg_org_id                /* 예산조직ID */
                              ,#acctSbjCd#              /* 계정과목코드 */
                              ,#bizCd#                    /* 사업코드 */
                              ,seq                   /* 품목순번 */
                              ,itm_nm                    /* 품목명 */
                              ,itm_seq                   /* 세세목 */
                              ,calc_bss              /* 산출근거명 */
                              ,budg_amt                  /* 예산액 */
                              ,GETDATE()					 /* 입력일시 */
	                           ,#insertId#              /* 입력사용자ID */
	                           ,#insertIp#                 /* 입력IP */     
	                           ,#insertPgm#				/* 입력PGM */ 
                         FROM  BG_CHG_DET WITH(NOLOCK)
                        WHERE acnt_unt = #acntUnt#
                          AND acnt_yy     = #acntYy#
                          AND budg_org_id   = #budgOrgId#
                          AND bal_div = #balDiv#
                          AND chg_seq  = CONVERT(INT, #chgSeq#)
                          AND acnt_cd  = #keyAcntCd#
                          AND biz_cd       = #KeyBizCd#
                          AND adj_ord_cd     = #adjOrdCd#

    </insert>

    <insert id="admiDAO.insertBgChgSchedChg" parameterClass="java.util.HashMap">
        /* admiDAO.insertBgChgSchedChg 1차조정이후 계정과목 등록/삭제 BG_CHG_SCHED  */
        
        INSERT INTO BG_CHG_SCHED (
                        acnt_unt              /* 회계단위ID */
                       ,acnt_yy                  /* 회계년도 */
                       ,chg_seq               /* 예산구분코드 */
                       ,bal_div              /* 수지구분코드 */
                       ,adj_ord_cd                  /* 조정차수 */
                       ,budg_org_id                /* 예산조직ID */
                       ,acnt_cd               /* 계정과목코드 */
                       ,biz_cd                    /* 사업코드 */
                       ,budg_yymm                 /* 편성년월 */
                       ,budg_amt                  /* 편성액 */
                       ,seq					/* 품목순번 */
                       ,insert_dt          /* 입력일시 */
		               ,insert_id           /* 입력사용자ID */
		               ,insert_ip           /* 입력사용자IP */
		               ,insert_pgm           /* 입력PROGRAM */
                       )
                       SELECT  acnt_unt              /* 회계단위ID */
                              ,acnt_yy                  /* 회계년도 */
                              ,chg_seq               /* 예산구분코드 */
                              ,bal_div              /* 수지구분코드 */
                              ,adj_ord_cd                  /* 조정차수 */
                              ,budg_org_id                /* 예산조직ID */
                              ,#acctSbjCd#              /* 계정과목코드 */
                              ,#bizCd#                    /* 사업코드 */
                              ,budg_yymm                 /* 편성년월 */
                              ,budg_amt                  /* 편성액 */
                              ,seq					/* 품목순번 */
                              ,GETDATE()					 /* 입력일시 */
	                          ,#insertId#              /* 입력사용자ID */
	                          ,#insertIp#                 /* 입력IP */     
	                          ,#insertPgm#				/* 입력PGM */ 
                         FROM  BG_CHG_SCHED bfs WITH(NOLOCK)
                        WHERE acnt_unt = #acntUnt#
                          AND acnt_yy     = #acntYy#
                          AND budg_org_id   = #budgOrgId#
                          AND bal_div = #balDiv#
                          AND chg_seq  = CONVERT(INT, #chgSeq#)
                          AND acnt_cd  = #keyAcntCd#
                          AND biz_cd       = #KeyBizCd#
                          AND adj_ord_cd     = #adjOrdCd#

    </insert>

    <delete id="admiDAO.deleteBgChgChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgChgChg 1차조정이후 계정과목 등록/삭제 BG_CHG */
        DELETE
          FROM BG_CHG
         WHERE acnt_unt = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id   = #budgOrgId#
           AND bal_div = #balDiv#
           AND chg_seq  = CONVERT(INT, #chgSeq#)
           AND acnt_cd  = #keyAcntCd#
           AND biz_cd       = #KeyBizCd#
           AND adj_ord_cd     = #adjOrdCd#
    </delete>

    <delete id="admiDAO.deleteBgChgDetChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgChgDetChg 1차조정이후 계정과목 등록/삭제 BG_CHG_DET */
        DELETE
          FROM BG_CHG_DET
         WHERE acnt_unt   = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id = #budgOrgId#
           AND bal_div     = #balDiv#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND acnt_cd     = #keyAcntCd#
           AND biz_cd      = #KeyBizCd#
           AND adj_ord_cd  = #adjOrdCd#
    </delete>

    <delete id="admiDAO.deleteBgChgSchedChg" parameterClass="java.util.HashMap">
        /* admiDAO.deleteBgChgSchedChg 1차조정이후 계정과목 등록/삭제 BG_CHG_SCHED */
        DELETE
          FROM BG_CHG_SCHED
         WHERE acnt_unt    = #acntUnt#
           AND acnt_yy     = #acntYy#
           AND budg_org_id = #budgOrgId#
           AND bal_div     = #balDiv#
           AND chg_seq     = CONVERT(INT, #chgSeq#)
           AND acnt_cd     = #keyAcntCd#
           AND biz_cd      = #KeyBizCd#
           AND adj_ord_cd  = #adjOrdCd#

    </delete>
    
    <select id="admiDAO.selectBgItmSeqCombo" parameterClass="java.util.HashMap" resultClass="egovMap">
    	/* admiDAO.selectBgItmSeqCombo 세세목콤보조회호출  */
    	SELECT acnt_unt	
	         , acnt_yy	
	         , acnt_cd	
	         , bal_div	
	         , itm_seq AS cd
	         , itm_seq_nm AS nm
		  FROM BG_ITM_SEQ WITH(NOLOCK)
  	     WHERE acnt_unt = #acntUnt#
	       AND acnt_yy  = #acntYy#
	       <isNotEmpty property = "acntCd"> 
	       AND acnt_cd  = #acntCd#
	       </isNotEmpty>
	       AND bal_div  = #balDiv#
    </select>
    
    <select id="admiDAO.selectBgApplyChk" parameterClass="java.util.HashMap" resultClass="egovMap">
		 /* admiDAO.selectBgApplyChk 예산신청내역 계정기본,상세,월별 신청액의 합계여부확인 */
		 SELECT sum(bfr.budg_amt) as bfr_budg_amt
               ,sum(bfd.bfd_budg_amt) as bfd_budg_amt
               ,sum(bfs.bfs_budg_amt) as bfs_budg_amt 
               ,bfr.biz_cd
               ,(SELECT bb.biz_nm FROM BG_BIZ bb WITH(NOLOCK)
                  WHERE bb.acnt_unt = #acntUnt#
                    AND bb.biz_cd       = bfr.biz_cd) as bfr_biz_nm
           FROM BG_FRMN bfr WITH(NOLOCK)
               ,(SELECT bfd.acnt_unt
                      , bfd.acnt_yy
                      , bfd.budg_cd
                      , bfd.adj_ord_cd
                      , bfd.budg_org_id
                      , bfd.acnt_cd
                      , bfd.biz_cd
                      , bfd.bal_div
                      , sum(bfd.budg_amt) as bfd_budg_amt
                   FROM BG_FRMN_DET bfd WITH(NOLOCK)
                  GROUP BY bfd.acnt_unt
                      , bfd.acnt_yy
                      , bfd.budg_cd
                      , bfd.adj_ord_cd
                      , bfd.budg_org_id
                      , bfd.acnt_cd
                      , bfd.biz_cd
                      , bfd.bal_div ) bfd
               ,(SELECT bfs.acnt_unt
                      , bfs.acnt_yy
                      , bfs.budg_cd
                      , bfs.adj_ord_cd
                      , bfs.budg_org_id
                      , bfs.acnt_cd
                      , bfs.biz_cd
                      , bfs.bal_div
                      , sum(bfs.budg_amt) as bfs_budg_amt
                  FROM BG_FRMN_SCHED bfs WITH(NOLOCK)
                 GROUP BY  bfs.acnt_unt
                      , bfs.acnt_yy
                      , bfs.budg_cd
                      , bfs.adj_ord_cd
                      , bfs.budg_org_id
                      , bfs.acnt_cd
                      , bfs.biz_cd
                      , bfs.bal_div) bfs
          WHERE bfr.acnt_unt    = bfd.acnt_unt
            AND bfr.acnt_yy     = bfd.acnt_yy
            AND bfr.budg_cd     = bfd.budg_cd
            AND bfr.adj_ord_cd  = bfd.adj_ord_cd
            AND bfr.biz_cd      = bfd.biz_cd
            AND bfr.budg_org_id = bfd.budg_org_id
            AND bfr.acnt_cd     = bfd.acnt_cd
            AND bfr.bal_div     = bfd.bal_div
            AND bfr.acnt_unt    = bfs.acnt_unt
            AND bfr.acnt_yy     = bfs.acnt_yy
            AND bfr.budg_cd     = bfs.budg_cd
            AND bfr.adj_ord_cd  = bfs.adj_ord_cd
            AND bfr.biz_cd      = bfs.biz_cd
            AND bfr.budg_org_id = bfs.budg_org_id
            AND bfr.acnt_cd     = bfs.acnt_cd
            AND bfr.bal_div     = bfs.bal_div
            AND bfr.acnt_unt    = #acntUnt#
            AND bfr.acnt_yy     = #acntYy#
            AND bfr.budg_cd     = #budgCd#
            AND bfr.adj_ord_cd  = 101
            AND bfr.budg_org_id = #budgOrgId#
            AND bfr.bal_div     = #balDiv#
            AND bfr.biz_cd      = #bizCd#
	   group by bfr.biz_cd
	</select>
	
	<select id="admiDAO.selectBgChgApplyChk" parameterClass="java.util.HashMap" resultClass="egovMap">
		 /* admiDAO.selectBgChgApplyChk 예산변경신청내역 계정기본,상세,월별 신청액의 합계여부확인 */
		 SELECT bch.budg_amt as bch_budg_amt
               ,bcd.bcd_budg_amt
               ,bcs.bcs_budg_amt
               ,bch.biz_cd
               ,(SELECT bb.biz_nm FROM BG_BIZ bb
                  WHERE bb.acnt_unt = #acntUnt#
                    AND bb.biz_cd   = bch.biz_cd) as bch_biz_nm
           FROM BG_CHG bch WITH(NOLOCK)
               ,(SELECT bcd.acnt_unt
                      , bcd.acnt_yy
                      , bcd.chg_seq
                      , bcd.adj_ord_cd
                      , bcd.budg_org_id
                      , bcd.acnt_cd
                      , bcd.biz_cd
                      , bcd.bal_div
                      , sum(bcd.budg_amt) as bcd_budg_amt
                   FROM BG_CHG_DET bcd WITH(NOLOCK)
                  GROUP BY bcd.acnt_unt
                      , bcd.acnt_yy
                      , bcd.chg_seq
                      , bcd.adj_ord_cd
                      , bcd.budg_org_id
                      , bcd.acnt_cd
                      , bcd.biz_cd
                      , bcd.bal_div ) bcd
               ,(SELECT bcs.acnt_unt
                      , bcs.acnt_yy
                      , bcs.chg_seq
                      , bcs.adj_ord_cd
                      , bcs.budg_org_id
                      , bcs.acnt_cd
                      , bcs.biz_cd
                      , bcs.bal_div
                      , sum(bcs.budg_amt) as bcs_budg_amt
                  FROM BG_CHG_SCHED bcs WITH(NOLOCK)
                 GROUP BY  bcs.acnt_unt
                      , bcs.acnt_yy
                      , bcs.chg_seq
                      , bcs.adj_ord_cd
                      , bcs.budg_org_id
                      , bcs.acnt_cd
                      , bcs.biz_cd
                      , bcs.bal_div) bcs
          WHERE bch.acnt_unt    = bcd.acnt_unt
            AND bch.acnt_yy     = bcd.acnt_yy
            AND bch.chg_seq     = bcd.chg_seq
            AND bch.adj_ord_cd  = bcd.adj_ord_cd
            AND bch.biz_cd      = bcd.biz_cd
            AND bch.budg_org_id = bcd.budg_org_id
            AND bch.acnt_cd     = bcd.acnt_cd
            AND bch.bal_div     = bcd.bal_div
            AND bch.acnt_unt    = bcs.acnt_unt
            AND bch.acnt_yy     = bcs.acnt_yy
            AND bch.chg_seq     = bcs.chg_seq
            AND bch.adj_ord_cd  = bcs.adj_ord_cd
            AND bch.biz_cd      = bcs.biz_cd
            AND bch.budg_org_id = bcs.budg_org_id
            AND bch.acnt_cd     = bcs.acnt_cd
            AND bch.bal_div     = bcs.bal_div
            AND bch.acnt_unt    = #acntUnt#
            AND bch.acnt_yy     = #acntYy#
            AND bch.chg_seq     = CONVERT(INT, #chgSeq#)
            AND bch.adj_ord_cd  = 101
            AND bch.budg_org_id = #budgOrgId#
            AND bch.bal_div     = #balDiv#
            AND bch.biz_cd      = #bizCd#
	
	</select>
	
	<update id="admiDAO.updateBgStaCd" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgStaCd 예산신청 및 취소  */
		UPDATE BG_ORG_BIZ
           SET sta_cd        = #staCd#      /* 예산진행코드 */
              ,aply_user_id  = #aplyUserId# /* 신청자 */
              ,aply_dt       = #aplyDt#	      /* 신청일자 */
              ,update_dt     = GETDATE()    /* 수정일시 */
			  ,update_id     = #updateId#	/* 수정아이디 */
			  ,update_ip     = #updateIp#	/* 수정아이피 */
			  ,update_pgm    = 'bg02030'	/* 수정프로그램 */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND biz_cd        = #bizCd#
           AND budg_org_id   = #budgOrgId#
           AND bal_div       = #balDiv#
           AND budg_cd       = #budgCd#
	
	</update>
	
	<update id="admiDAO.updateBgChgStaCd" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChgStaCd 예산변경신청 및 취소  */
		UPDATE BG_CHG_APLY
           SET sta_cd        = #staCd#      /* 예산진행코드 */
              ,aply_user_id  = #aplyUserId# /* 신청자 */
              ,aply_dt       = #aplyDt#	      /* 신청일자 */
              ,update_dt     = GETDATE()    /* 수정일시 */
			  ,update_id     = #updateId#	/* 수정아이디 */
			  ,update_ip     = #updateIp#	/* 수정아이피 */
			  ,update_pgm    = 'bg02030'	/* 수정프로그램 */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND aply_org_id   = #aplyOrgId#
           AND chg_seq       = CONVERT(INT, #chgSeq#)
           AND chg_div       = #chgDiv#
	
	</update>
	
	<update id="admiDAO.updateBgStaCdFixed" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgStaCdFixed 예산확정 및 취소  */
		UPDATE BG_ORG_BIZ
           SET sta_cd        = #staCd#      /* 예산진행코드 */
              ,cfm_user_id   = #cfmUserId#  /* 신청자 */
              ,cfm_dt        = #cfmDt#	    /* 신청일자 */
              ,cfm_ord_cd    = #cfmOrdCd#   /* 확정차수 */
              ,update_dt     = GETDATE()    /* 수정일시 */
			  ,update_id     = #updateId#	/* 수정아이디 */
			  ,update_ip     = #updateIp#	/* 수정아이피 */
			  ,update_pgm    = 'bg02040'	/* 수정프로그램 */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND bal_div       = #balDiv#
           AND budg_cd       = #budgCd#
	
	</update>
	
	<update id="admiDAO.updateBgChgStaCdFixed" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChgStaCdFixed 예산변경확정 및 취소  */
		UPDATE BG_CHG_APLY
           SET sta_cd        = #staCd#      /* 예산진행코드 */
              ,cfm_user_id   = #cfmUserId# /* 신청자 */
              ,cfm_dt        = #cfmDt#	      /* 신청일자 */
              ,update_dt     = GETDATE()    /* 수정일시 */
			  ,update_id     = #updateId#	/* 수정아이디 */
			  ,update_ip     = #updateIp#	/* 수정아이피 */
			  ,update_pgm    = 'bg03020'	/* 수정프로그램 */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND aply_org_id   = #aplyOrgId#
           AND chg_seq       = CONVERT(INT, #chgSeq#)
           AND chg_div       = #chgDiv#
	
	</update>
	
	<insert id="admiDAO.insertBgFrmnAsgnFixed" parameterClass="java.util.HashMap">
			/* admiDAO.insertBgFrmnAsgnFixed 예산확정입력 */
		BEGIN
			
			INSERT INTO BG_ASGN (
                        acnt_unt           /* 회계단위ID */
                       ,acnt_yy               /* 회계연도 */
                       ,biz_cd                 /* 사업코드 */
                       ,acnt_cd            /* 계정과목코드 */
                       ,budg_org_id             /* 예산조직ID */
                       ,bal_div           /* 수지구분코드 */
                       ,budg_yymm              /* 편성년월 */
                       ,budg_seq               /* 확정순번 */
                       ,budg_cd            /* 예산구분코드 */
                       ,adj_ord_cd               /* 조정차수 */
                       ,budg_amt               /* 예산액 */
                       ,cfm_dt				/* 확정일자 */
                       ,chg_seq            /* 변경신청순번 */
                       ,insert_id              /* 입력사용자ID */
                       ,insert_ip               /* 입력IP */
                       ,insert_dt               /* 입력일시 */
                       ,insert_pgm               /* 입력PGM */
                       )
              select bfs.acnt_unt
                    ,bfs.acnt_yy
                    ,bfs.biz_cd
                    ,bfs.acnt_cd
                    ,bfs.budg_org_id
                    ,bfs.bal_div
                    ,bfs.budg_yymm
                    ,(SELECT ISNULL(max(ba1.budg_seq),'0')+1
                        FROM BG_ASGN ba1 WITH(NOLOCK)
                       WHERE ba1.acnt_unt    = bfs.acnt_unt
                         AND ba1.acnt_yy     = bfs.acnt_yy
                         AND ba1.budg_org_id = bfs.budg_org_id
                         AND ba1.biz_cd      = bfs.biz_cd
                         AND ba1.acnt_cd     = bfs.acnt_cd
                         AND ba1.bal_div     = bfs.bal_div
                         AND ba1.budg_yymm   = bfs.budg_yymm ) as budg_seq
                    ,bfs.budg_cd                   
                    ,bfs.adj_ord_cd                    
                    ,sum(bfs.budg_amt)- isnull( ( select sum(isnull(budg_amt,0))
                                                    from bg_asgn ba1
                                                   where ba1.acnt_unt    = bfs.acnt_unt
													 AND ba1.acnt_yy     = bfs.acnt_yy
													 and ba1.BIZ_CD      = bfs.BIZ_CD
													 and ba1.ACNT_CD     = bfs.ACNT_CD
													 and ba1.BUDG_ORG_ID = bfs.BUDG_ORG_ID
													 and ba1.bal_div     = bfs.bal_div
													 and ba1.BUDG_YYMM   = bfs.budg_yymm )
													 
                                                 ,0) as budg_amt                        
                    ,#cfmDt#
                    ,0 as chg_seq                 
                    ,#insertId#                  
                    ,#insertIp#  
                    ,GETDATE()                                     
                    ,#insertPgm#                  
                from BG_FRMN_SCHED bfs WITH(NOLOCK)
               where bfs.acnt_unt    = #acntUnt#
                 AND bfs.acnt_yy     = #acntYy#
                 AND bfs.budg_cd     = #budgCd#
                 AND bfs.adj_ord_cd  = #adjOrdCd#
                 AND bfs.bal_div     = #balDiv#
            GROUP BY bfs.acnt_unt
                    ,bfs.acnt_yy
                    ,bfs.biz_cd
                    ,bfs.acnt_cd
                    ,bfs.budg_org_id
                    ,bfs.bal_div
                    ,bfs.budg_yymm
                    ,bfs.budg_cd                   
                    ,bfs.adj_ord_cd
                    
			INSERT INTO BG_ASGN (
                        acnt_unt           /* 회계단위ID */
                       ,acnt_yy               /* 회계연도 */
                       ,biz_cd                 /* 사업코드 */
                       ,acnt_cd            /* 계정과목코드 */
                       ,budg_org_id             /* 예산조직ID */
                       ,bal_div           /* 수지구분코드 */
                       ,budg_yymm              /* 편성년월 */
                       ,budg_seq               /* 확정순번 */
                       ,budg_cd            /* 예산구분코드 */
                       ,adj_ord_cd               /* 조정차수 */
                       ,budg_amt               /* 예산액 */
                       ,cfm_dt				/* 확정일자 */
                       ,chg_seq            /* 변경신청순번 */
                       ,insert_id              /* 입력사용자ID */
                       ,insert_ip               /* 입력IP */
                       ,insert_dt               /* 입력일시 */
                       ,insert_pgm               /* 입력PGM */
                       )  
              select ba.acnt_unt
                    ,ba.acnt_yy
                    ,ba.biz_cd
                    ,ba.acnt_cd
                    ,ba.budg_org_id
                    ,ba.bal_div
                    ,ba.budg_yymm
                    ,(SELECT ISNULL(max(ba1.budg_seq),'0')+1
                        FROM BG_ASGN ba1 WITH(NOLOCK)
                       WHERE ba1.acnt_unt    = ba.acnt_unt
                         AND ba1.acnt_yy     = ba.acnt_yy
                         AND ba1.budg_org_id = ba.budg_org_id
                         AND ba1.biz_cd      = ba.biz_cd
                         AND ba1.acnt_cd     = ba.acnt_cd
                         AND ba1.bal_div     = ba.bal_div
                         AND ba1.budg_yymm   = ba.budg_yymm ) as budg_seq
                    ,#budgCd#                  
                    ,#adjOrdCd#
                    ,isnull( ( select sum(isnull(budg_amt * -1,0))
                                                    from bg_asgn ba1
                                                   where ba1.acnt_unt    = ba.acnt_unt
													 AND ba1.acnt_yy     = ba.acnt_yy
													 and ba1.BIZ_CD      = ba.BIZ_CD
													 and ba1.ACNT_CD     = ba.ACNT_CD
													 and ba1.BUDG_ORG_ID = ba.BUDG_ORG_ID
													 and ba1.bal_div     = ba.bal_div
													 and ba1.BUDG_YYMM   = ba.budg_yymm )
													 
                                                 ,0) as budg_amt                    
                    ,#cfmDt#
                    ,0 as chg_seq       
                    ,#insertId#                  
                    ,#insertIp#  
                    ,GETDATE()                                     
                    ,#insertPgm#                                                               
                from (SELECT acnt_unt
							, acnt_yy
							, biz_cd
							, acnt_cd
							, budg_org_id
							, bal_div
							, budg_yymm
						 FROM BG_ASGN
						WHERE ACNT_UNT = #acntUnt#
						  AND ACNT_YY = #acntYy#
						  AND BAL_DIV = #balDiv#
					   EXCEPT
                       SELECT acnt_unt
							, acnt_yy
							, biz_cd
							, acnt_cd
							, budg_org_id
							, bal_div
							, budg_yymm
						 FROM BG_FRMN_SCHED
						WHERE ACNT_UNT = #acntUnt#
						  AND ACNT_YY = #acntYy#
						  AND BAL_DIV = #balDiv#
						  AND BUDG_CD = #budgCd#
						  AND ADJ_ORD_CD = #adjOrdCd# ) BA
		       where isnull( ( select sum(isnull(budg_amt * -1,0))
                                 from bg_asgn ba1
                                where ba1.acnt_unt    = ba.acnt_unt
							 	  AND ba1.acnt_yy     = ba.acnt_yy
								  and ba1.BIZ_CD      = ba.BIZ_CD
								  and ba1.ACNT_CD     = ba.ACNT_CD
								  and ba1.BUDG_ORG_ID = ba.BUDG_ORG_ID
								  and ba1.bal_div     = ba.bal_div
								  and ba1.BUDG_YYMM   = ba.budg_yymm ) ,0) != 0  
		END
	</insert>
	
	<insert id="admiDAO.insertBgChgAsgnFixed" parameterClass="java.util.HashMap">
			/* admiDAO.insertBgChgAsgnFixed 예산변경확정입력 */
			INSERT INTO BG_ASGN (
                        acnt_unt           /* 회계단위ID */
                       ,acnt_yy               /* 회계연도 */
                       ,biz_cd                 /* 사업코드 */
                       ,acnt_cd            /* 계정과목코드 */
                       ,budg_org_id             /* 예산조직ID */
                       ,bal_div           /* 수지구분코드 */
                       ,budg_yymm              /* 편성년월 */
                       ,budg_seq               /* 확정순번 */
                       ,budg_cd            /* 예산구분코드 */
                       ,adj_ord_cd               /* 조정차수 */
                       ,budg_amt               /* 예산액 */
                       ,cfm_dt				/* 확정일자 */
                       ,aply_org_id
                       ,chg_seq            /* 변경신청순번 */
                       ,insert_id              /* 입력사용자ID */
                       ,insert_ip               /* 입력IP */
                       ,insert_dt               /* 입력일시 */
                       ,insert_pgm               /* 입력PGM */
                       )
              select bch.acnt_unt
                    ,bch.acnt_yy
                    ,bch.biz_cd
                    ,bch.acnt_cd
                    ,bch.budg_org_id
                    ,bch.bal_div
                    ,SUBSTRING(#cfmDt#,1,6) as budg_yymm
                    ,(SELECT ISNULL(max(ba1.budg_seq),'0')+1
                        FROM BG_ASGN ba1 WITH(NOLOCK)
                       WHERE ba1.acnt_unt    = bch.acnt_unt
                         AND ba1.acnt_yy     = bch.acnt_yy
                         AND ba1.budg_org_id = bch.budg_org_id
                         AND ba1.biz_cd      = bch.biz_cd
                         AND ba1.acnt_cd     = bch.acnt_cd
                         AND ba1.bal_div     = bch.bal_div
                         AND ba1.budg_yymm   = SUBSTRING(#cfmDt#,1,6) ) as budg_seq
                    ,'' as budg_cd                   
                    ,bch.adj_ord_cd                    
                    ,sum(bch.budg_amt) as budg_amt                    
                    ,#cfmDt#
                    ,bch.aply_org_id
                    ,bch.chg_seq                 
                    ,#insertId#                  
                    ,#insertIp#  
                    ,GETDATE()                                     
                    ,#insertPgm#                  
                from BG_CHG bch WITH(NOLOCK)
               where bch.acnt_unt    = #acntUnt#
                 AND bch.acnt_yy     = #acntYy#
                 AND bch.chg_seq     = CONVERT(INT,#chgSeq#)
                 AND bch.adj_ord_cd  = #adjOrdCd#
                 AND bch.aply_org_id = #aplyOrgId#
            GROUP BY bch.acnt_unt
                    ,bch.acnt_yy
                    ,bch.biz_cd
                    ,bch.acnt_cd
                    ,bch.budg_org_id
                    ,bch.bal_div
                    ,bch.aply_org_id
                    ,bch.chg_seq                   
                    ,bch.adj_ord_cd
			
	</insert>
	
	<delete id="admiDAO.deleteBgFrmnAsgnCancel" parameterClass="java.util.HashMap">
			/* admiDAO.deleteBgFrmnAsgnFixed 예산확정취소 */
			DELETE
	          FROM BG_ASGN
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND bal_div     = #balDiv#
	           AND budg_cd     = #budgCd#
			
	</delete>
	
	<delete id="admiDAO.deleteBgChgAsgnCancel" parameterClass="java.util.HashMap">
			/* admiDAO.deleteBgChgAsgnCancel 예산변경확정취소 */
			DELETE
	          FROM BG_ASGN
	         WHERE acnt_unt    = #acntUnt#
	           AND acnt_yy     = #acntYy#
	           AND aply_org_id = #aplyOrgId#
	           AND chg_seq     = CONVERT(INT, #chgSeq#)
	           AND adj_ord_cd  = #adjOrdCd#
			
	</delete>
	
	<select id="admiDAO.selectBudgOrgIdCombo" parameterClass="java.util.HashMap" resultClass="egovMap">
			/* admiDAO.selectBudgOrgIdCombo 접속자 소속부서,관리부서 콤보호출 */			 
			 SELECT a.dept_cd, case when c.dept_nm_kor is not null and c.dept_nm_kor != '' then c.dept_nm_kor + ' - ' else '' end + a.dept_nm_kor as dept_nm_kor
			  FROM VW_COMM_DEPT a WITH(NOLOCK)
			   inner join ( SELECT dept_cd
			           FROM VW_USER_LIST
			          WHERE MEMBER_NO = #memberNo#

			          UNION 
			          
					 SELECT dept_cd
			           FROM VW_USER_ADD_DEPT
			          WHERE EMP_ID = #memberNo#

			          UNION 

			         SELECT distinct org_id dept_cd
			           FROM BG_ORG_PERM WITH(NOLOCK)
			          WHERE acnt_unt = #acntUnt#
			            AND work_div = '10'
			            AND mgt_org_id IN ( SELECT dept_cd
									          FROM VW_USER_LIST
									         WHERE MEMBER_NO = #memberNo#
						
									          UNION 
									          
											 SELECT dept_cd
									           FROM VW_USER_ADD_DEPT
									          WHERE EMP_ID = #memberNo#)	 

			            ) b
			     on a.dept_cd = b.dept_cd
			   left outer join  VW_COMM_DEPT c WITH(NOLOCK)
			     on a.up_dept_cd = c.dept_cd

			 ORDER BY (case a.dept_cd 
                       when (SELECT MAX(dept_cd)
					           FROM VW_USER_LIST
					          WHERE MEMBER_NO = #memberNo#) then 1
                       when a.dept_cd  then 2
                       else 3
                       end ), c.dept_nm_kor, a.dept_nm_kor, a.dept_cd
	</select>
	
	<select id="admiDAO.selectBudgBizCombo" parameterClass="java.util.HashMap" resultClass="egovMap">
			/* admiDAO.selectBudgBizCombo 접속자 소속부서,관리부서의 사업 콤보호출 */			 
			 SELECT a.biz_cd, a.biz_nm
			  FROM BG_BIZ a WITH(NOLOCK)
			 WHERE a.mgt_org_id in (     SELECT dept_cd
								           FROM VW_USER_LIST
								          WHERE MEMBER_NO = #memberNo#
					
								          UNION 
								          
										 SELECT dept_cd
								           FROM VW_USER_ADD_DEPT
								          WHERE EMP_ID = #memberNo#
					
								          UNION 
					
								         SELECT distinct org_id dept_cd
								           FROM BG_ORG_PERM WITH(NOLOCK)
								          WHERE acnt_unt = #acntUnt#
								            AND work_div = '30'
								            AND mgt_org_id IN ( SELECT dept_cd
												              FROM VW_USER_LIST
													         WHERE MEMBER_NO = #memberNo#
											
													          UNION 
														          
															 SELECT dept_cd
													           FROM VW_USER_ADD_DEPT
													          WHERE EMP_ID = #memberNo#)	 
					
								            )
			 ORDER BY a.biz_cd
	</select>
	
	<update id="admiDAO.updateBgStaCdAdjCopy" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgStaCdAdjCopy 전차수복사 상태코드 조정으로 변경 */		
		UPDATE BG_ORG_BIZ
           SET sta_cd        = #staCd#      /* 예산진행코드 */
         WHERE acnt_yy       = #acntYy#
           AND budg_cd       = #budgCd#
           AND sta_cd       != '10'
           AND sta_cd       != '30'
	
	</update>
	
	<update id="admiDAO.updateBgChgStaCdAdjCopy" parameterClass="java.util.HashMap">
		/* admiDAO.updateBgChgStaCdAdjCopy 전차수복사(변경) 상태코드 조정으로 변경 */		
		UPDATE BG_CHG_APLY
           SET sta_cd        = #staCd#      /* 예산진행코드 */
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND budg_cd       = #budgCd#
	
	</update>
	
	<delete id="admiDAO.deleteBgFrmnAdjOrdCopy" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnAdjOrdCopy 전차수복사 계정기본목록 삭제 */
		DELETE
          FROM BG_FRMN
         WHERE acnt_yy    = #acntYy#
           AND budg_cd    = #budgCd#
           AND adj_ord_cd = #adjOrdCd#
	</delete>
	
	<delete id="admiDAO.deleteBgFrmnDetAdjOrdCopy" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnDetAdjOrdCopy 전차수복사 계정상세목록 삭제 */		
		DELETE
          FROM BG_FRMN_DET
         WHERE acnt_yy    = #acntYy#
           AND budg_cd    = #budgCd#
           AND adj_ord_cd = #adjOrdCd#
	</delete>
	
	<delete id="admiDAO.deleteBgFrmnSchedAdjOrdCopy" parameterClass="java.util.HashMap">
		/* admiDAO.deleteBgFrmnSchedAdjOrdCopy 전차수복사 월별계획목록 삭제 */
		DELETE
          FROM BG_FRMN_SCHED
         WHERE acnt_yy    = #acntYy#
           AND budg_cd    = #budgCd#
           AND adj_ord_cd = #adjOrdCd#
	</delete>
	
	<insert id="admiDAO.insertBgFrmnAdjOrdCopy" parameterClass="java.util.HashMap">
			INSERT INTO BG_FRMN (
	                    acnt_unt       /* 회계단위ID */
	                   ,acnt_yy           /* 회계년도 */
	                   ,budg_cd        /* 예산구분코드 */
	                   ,bal_div       /* 수지구분코드 */
	                   ,adj_ord_cd           /* 조정차수 */
	                   ,budg_org_id         /* 예산조직ID */
	                   ,acnt_cd        /* 계정과목코드 */
	                   ,biz_cd             /* 사업코드 */
	                   ,budg_amt           /* 예산액 */
	                   ,budg_cfm_dt       /* 예산확정일 */
	                   ,insert_id          /* 입력사용자ID */
	                   ,insert_dt           /* 입력일시 */
	                   ,insert_ip           /* 입력IP */
	                   )
	                   SELECT  bfr.acnt_unt             /* 회계단위ID */
	                          ,bfr.acnt_yy                 /* 회계년도 */
	                          ,bfr.budg_cd              /* 예산구분코드 */
	                          ,bfr.bal_div             /* 수지구분코드 */
	                          ,#adjOrdCd# as adj_ord_cd  /* 조정차수 */
	                          ,bfr.budg_org_id               /* 예산조직ID */
	                          ,bfr.acnt_cd              /* 계정과목코드 */
	                          ,bfr.biz_cd                   /* 사업코드 */
	                          ,bfr.budg_amt                 /* 예산액 */
	                          ,bfr.budg_cfm_dt             /* 예산확정일 */
	                          ,#insertId#               /* 입력사용자ID */
	                          ,GETDATE()                      /* 입력일시 */
	                          ,#insertIp#                /* 입력IP */
	                     FROM  BG_FRMN bfr WITH(NOLOCK)
	                      <isEqual property = "adjOrdCd" compareValue="201">
	                      	   inner join bg_org_biz bob with(nolock)
	                      	    on  bob.acnt_unt = bfr.acnt_unt
	                      	    and bob.acnt_yy  = bfr.acnt_yy
	                      	    and bob.budg_org_id = bfr.budg_org_id
	                      	    and bob.budg_cd  = bfr.budg_cd
	                      	    and bob.bal_div  = bfr.bal_div
	                      	    and bob.biz_cd   = bfr.biz_cd
	                      </isEqual>
	                    WHERE  bfr.acnt_yy    = #acntYy#
	                      AND  bfr.budg_cd    = #budgCd#
	                      <isEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfr.adj_ord_cd = '101'
	                      AND  bob.sta_cd     != '10'
	                      AND  bob.sta_cd     != '30'
	                      </isEqual>
	                      <isNotEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfr.adj_ord_cd = CONVERT(VARCHAR,CONVERT(INT,#adjOrdCd#)-1)
	                      </isNotEqual>
	</insert>
	
	<insert id="admiDAO.insertBgFrmnDetAdjOrdCopy" parameterClass="java.util.HashMap">
			INSERT INTO BG_FRMN_DET (
                        acnt_unt        /* 회계단위IDzz */
                       ,acnt_yy            /* 회계년도 */
                       ,budg_cd         /* 예산구분코드 */
                       ,bal_div        /* 수지구분코드 */
                       ,adj_ord_cd            /* 조정차수 */
                       ,budg_org_id          /* 예산조직ID */
                       ,acnt_cd         /* 계정과목코드 */
                       ,biz_cd              /* 사업코드 */
                       ,itm_seq             /* 품목순번 */
                       ,seq                 /* 세세목 */
                       ,new_biz_yn			/* 신규사업여부 */
                       ,itm_nm              /* 품목명 */
                       ,calc_bss        /* 산출근거명 */
                       ,budg_amt            /* 예산액 */
                       ,pre_budg_amt        /* 본예산액,1차추경액 */
                       ,chg_desc            /* 변경사유 */
                       ,insert_id          /* 입력사용자ID */
	                   ,insert_dt           /* 입력일시 */
	                   ,insert_ip           /* 입력IP */
                       )
                       SELECT  bfd.acnt_unt              /* 회계단위IDzz */
                              ,bfd.acnt_yy                  /* 회계년도 */
                              ,bfd.budg_cd               /* 예산구분코드 */
                              ,bfd.bal_div              /* 수지구분코드 */
	                          ,#adjOrdCd# as adj_ord_cd  /* 조정차수 */
                              ,bfd.budg_org_id                /* 예산조직ID */
                              ,bfd.acnt_cd               /* 계정과목코드 */
                              ,bfd.biz_cd                    /* 사업코드 */
                              ,bfd.itm_seq                   /* 품목순번 */
                              ,bfd.seq                 /* 세세목 */
                              ,bfd.new_biz_yn			/* 신규사업여부 */
                              ,bfd.itm_nm                    /* 품목명 */
                              ,bfd.calc_bss              /* 산출근거명 */
                              ,bfd.budg_amt                  /* 예산액 */
                              ,bfd.pre_budg_amt        /* 본예산액,1차추경액 */
                       		  ,bfd.chg_desc            /* 변경사유 */
                              ,#insertId#                /* 입력사용자ID */
                              ,GETDATE()                       /* 입력일시 */
                              ,#insertIp#                 /* 입력IP */
                         FROM  BG_FRMN_DET bfd WITH(NOLOCK)
                          <isEqual property = "adjOrdCd" compareValue="201">
	                      	   inner join bg_org_biz bob with(nolock)
	                      	    on  bob.acnt_unt = bfd.acnt_unt
	                      	    and bob.acnt_yy  = bfd.acnt_yy
	                      	    and bob.budg_org_id = bfd.budg_org_id
	                      	    and bob.budg_cd  = bfd.budg_cd
	                      	    and bob.bal_div  = bfd.bal_div
	                      	    and bob.biz_cd   = bfd.biz_cd
	                      </isEqual>
                        WHERE  bfd.acnt_yy    = #acntYy#
                          AND  bfd.budg_cd    = #budgCd#
                          <isEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfd.adj_ord_cd = '101'
	                      AND  bob.sta_cd     != '10'
	                      AND  bob.sta_cd     != '30'
	                      </isEqual>
	                      <isNotEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfd.adj_ord_cd = CONVERT(VARCHAR, CONVERT(INT, #adjOrdCd#) -1)
	                      </isNotEqual>
	</insert>
	
	<insert id="admiDAO.insertBgFrmnSchedAdjOrdCopy" parameterClass="java.util.HashMap">
			INSERT INTO BG_FRMN_SCHED (
                        acnt_unt              /* 회계단위ID */
                       ,acnt_yy                  /* 회계년도 */
                       ,budg_cd               /* 예산구분코드 */
                       ,bal_div              /* 수지구분코드 */
                       ,adj_ord_cd                  /* 조정차수 */
                       ,budg_org_id                /* 예산조직ID */
                       ,acnt_cd               /* 계정과목코드 */
                       ,biz_cd                    /* 사업코드 */
                       ,seq                 /* 세세목 */
                       ,budg_yymm                 /* 편성년월 */
                       ,budg_amt                  /* 편성액 */
                       ,insert_id          /* 입력사용자ID */
	                   ,insert_dt           /* 입력일시 */
	                   ,insert_ip           /* 입력IP */
                       )
                       SELECT  bfs.acnt_unt              /* 회계단위ID */
                              ,bfs.acnt_yy                  /* 회계년도 */
                              ,bfs.budg_cd               /* 예산구분코드 */
                              ,bfs.bal_div              /* 수지구분코드 */
	                          ,#adjOrdCd# as adj_ord_cd  /* 조정차수 */
                              ,bfs.budg_org_id                /* 예산조직ID */
                              ,bfs.acnt_cd               /* 계정과목코드 */
                              ,bfs.biz_cd                    /* 사업코드 */
                              ,bfs.seq                 /* 세세목 */
                              ,bfs.budg_yymm                 /* 편성년월 */
                              ,bfs.budg_amt                  /* 편성액 */
                              ,#insertId#                /* 입력사용자ID */
                              ,GETDATE()                       /* 입력일시 */
                              ,#insertIp#                 /* 입력IP */
                         FROM  BG_FRMN_SCHED bfs WITH(NOLOCK)
	                      <isEqual property = "adjOrdCd" compareValue="201">
	                      	   inner join bg_org_biz bob with(nolock)
	                      	    on  bob.acnt_unt = bfs.acnt_unt
	                      	    and bob.acnt_yy  = bfs.acnt_yy
	                      	    and bob.budg_org_id = bfs.budg_org_id
	                      	    and bob.budg_cd  = bfs.budg_cd
	                      	    and bob.bal_div  = bfs.bal_div
	                      	    and bob.biz_cd   = bfs.biz_cd
	                      </isEqual>
                        WHERE  bfs.acnt_yy    = #acntYy#
                          AND  bfs.budg_cd    = #budgCd#
                          <isEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfs.adj_ord_cd = '101'
	                      AND  bob.sta_cd     != '10'
	                      AND  bob.sta_cd     != '30'
	                      </isEqual>
	                      <isNotEqual property = "adjOrdCd" compareValue="201">
	                      AND  bfs.adj_ord_cd = CONVERT(VARCHAR, CONVERT(INT, #adjOrdCd#) -1)
	                      </isNotEqual>
	</insert>
	
	<parameterMap id="bg02040" class="java.util.HashMap">
        <parameter property="I_BF_ACNT_UNT"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_BF_ORG_ID"        jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" /> 
        <parameter property="I_BF_BIZ_CD"        jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" /> 
        <parameter property="I_BF_ACNT_CD"       jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_AF_ACNT_UNT"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_AF_ORG_ID"        jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_AF_BIZ_CD"        jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_AF_ACNT_CD"       jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_ACNT_YY"          jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_BAL_DIV"          jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_BUDG_CD"          jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_ADJ_ORD_CD"       jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_ENTRY_NO"         jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="I_ENTRY_IP"         jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_RTN"          jdbcType="INTEGER"          javaType="java.lang.Integer"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveBgAcntChgSP" parameterMap = "bg02040"> 
           {call dbo.SP_BG_FRMN_CHG(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)}              
    </procedure>
    
    <select id="admiDAO.selectBgApplyBizChk" parameterClass="java.util.HashMap" resultClass="egovMap" >
	    	/* admiDAO.selectBgApplyBizChk - 예산편성신청 - 미신청된 사업 확인 */
	    	SELECT bob.acnt_yy
			      ,bob.acnt_unt
			      ,(SELECT bu.acnt_unt_nm
			          FROM BG_UNT bu
			         WHERE bu.acnt_unt = bob.acnt_unt ) AS acnt_unt_nm
			      ,bob.budg_org_id
			      ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm
			      ,bob.bal_div
			      ,bob.biz_cd
			      ,bb1.biz_nm
			      ,bob.budg_cd
			      ,ISNULL((SELECT sum(bfr.budg_amt)
				          FROM BG_FRMN bfr WITH(NOLOCK)
				         WHERE bfr.acnt_yy = bob.acnt_yy
				           and bfr.acnt_unt = bob.acnt_unt
				           and bfr.budg_org_id = bob.budg_org_id
				           and bfr.bal_div = bob.bal_div
				           and bfr.biz_cd = bob.biz_cd
				           and bfr.budg_cd = budg_cd
				           and bfr.adj_ord_cd = '101'
				          ),0) AS bfr_budg_amt
			  FROM BG_ORG_BIZ bob WITH(NOLOCK)
			       JOIN BG_BIZ bb1 WITH(NOLOCK)
			         ON     bob.acnt_unt    = bb1.acnt_unt
		                AND bob.biz_cd      = bb1.biz_cd
			 WHERE bob.acnt_yy     = #acntYy#
			   <isNotEmpty property = "acntUnt">
			   AND bob.acnt_unt    = #acntUnt# 
			   </isNotEmpty>
			   AND bob.budg_org_id = #budgOrgId#
			   AND bob.bal_div     = #balDiv#
			   AND bob.budg_cd     = #budgCd#
			   AND bob.sta_cd      = #staCd#
			 ORDER BY bob.acnt_yy
			         ,bob.acnt_unt
			         ,bob.budg_org_id
			         ,bob.bal_div
			         ,bob.biz_cd
			         ,bob.budg_cd
    </select>
    
    <select id="admiDAO.selectBgApplyAcntChk" parameterClass="java.util.HashMap" resultClass="egovMap" >
	    	/* admiDAO.selectBgApplyAcntChk 예산신청중 빈계정과목 확인 */
	    	SELECT bob.acnt_yy
			      ,bob.acnt_unt
			      ,(SELECT bu.acnt_unt_nm
			          FROM BG_UNT bu
			         WHERE bu.acnt_unt = bob.acnt_unt ) AS acnt_unt_nm
			      ,bob.budg_org_id
			      ,(SELECT dbo.F_COM_DEPT_NM(bob.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm
			      ,bob.bal_div
			      ,bob.biz_cd
			      ,bb1.biz_nm
			      ,bob.budg_cd
			      ,bfr.bfr_acnt_cd
			      ,CASE WHEN #balDiv# = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END AS bfr_acnt_nm  
			      ,ISNULL(bfr.bfr_budg_amt,-1) AS bfr_budg_amt
			  FROM BG_ORG_BIZ bob WITH(NOLOCK)
			       JOIN BG_BIZ bb1 WITH(NOLOCK)
			         ON     bob.acnt_unt    = bb1.acnt_unt
		                AND bob.biz_cd      = bb1.biz_cd
			       LEFT OUTER JOIN (SELECT bfr.acnt_yy
							              ,bfr.acnt_unt
							              ,bfr.budg_org_id
							              ,bfr.bal_div
							              ,bfr.biz_cd
							              ,bfr.budg_cd
							              ,bfr.acnt_cd as bfr_acnt_cd
							              ,sum(bfr.budg_amt) as bfr_budg_amt
							          FROM BG_FRMN bfr WITH(NOLOCK)
							          GROUP BY bfr.acnt_yy
							                  ,bfr.acnt_unt
							                  ,bfr.budg_org_id
							                  ,bfr.bal_div
							                  ,bfr.biz_cd
							                  ,bfr.budg_cd
							                  ,bfr.acnt_cd ) bfr
					  ON bob.acnt_yy     = bfr.acnt_yy
					   AND bob.acnt_unt    = bfr.acnt_unt
					   AND bob.budg_org_id = bfr.budg_org_id
					   AND bob.bal_div     = bfr.bal_div
					   AND bob.biz_cd      = bfr.biz_cd
					   AND bob.budg_cd     = bfr.budg_cd	                  	                  
			        LEFT OUTER JOIN BG_ACNT_CD bac1 WITH(NOLOCK)
					  ON bfr.acnt_unt    = bac1.acnt_unt
					   AND bfr.acnt_yy     = bac1.acnt_yy
					   AND bfr.bfr_acnt_cd = bac1.acnt_cd	        
			 WHERE bob.acnt_yy     = #acntYy#
			   <isNotEmpty property = "acntUnt">
			   AND bob.acnt_unt    = #acntUnt# 
			   </isNotEmpty>
			   <isNotEmpty property = "bizCd">	
			   AND bob.biz_cd    = #bizCd# 
			   </isNotEmpty>
			   AND bob.budg_org_id = #budgOrgId#
			   AND bob.bal_div     = #balDiv#
			   AND bob.budg_cd     = #budgCd#
			   AND bob.sta_cd      = #staCd#
			 ORDER BY bob.acnt_yy
			         ,bob.acnt_unt
			         ,bob.budg_org_id
			         ,bob.bal_div
			         ,bob.biz_cd
			         ,bob.budg_cd
			         ,bfr.bfr_acnt_cd
    </select>
    
    <select id="admiDAO.selectBgChgApplyAcntChk" parameterClass="java.util.HashMap" resultClass="egovMap" >
	    	/* admiDAO.selectBgChgApplyAcntChk 예산변경신청중 빈계정과목 확인 */
	    	SELECT bca.acnt_yy
			      ,bca.acnt_unt
			      ,(SELECT bu.acnt_unt_nm
			          FROM BG_UNT bu
			         WHERE bu.acnt_unt = bca.acnt_unt ) AS acnt_unt_nm
			      ,bca.budg_org_id
			      ,(SELECT dbo.F_COM_DEPT_NM(bca.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm
			      ,bca.bal_div
			      ,bca.biz_cd
			      ,bca.biz_nm
			      ,bca.budg_cd
			      ,bch.bch_acnt_cd
			      ,CASE WHEN #balDiv# = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END AS bch_acnt_nm  
			      ,ISNULL(bch.bch_budg_amt,0) AS bch_budg_amt
			  FROM BG_CHG_APLY bca WITH(NOLOCK)
			       JOIN BG_BIZ bb1 WITH(NOLOCK)
			         ON    bca.acnt_unt    = bb1.acnt_unt
		               AND bca.biz_cd      = bb1.biz_cd
			       LEFT OUTER JOIN (SELECT bch.acnt_yy
							              ,bch.acnt_unt
							              ,bch.budg_org_id
							              ,bch.bal_div
							              ,bch.biz_cd
							              ,bch.chg_seq
							              ,bch.acnt_cd as bch_acnt_cd
							              ,sum(bch.budg_amt) as bch_budg_amt
							          FROM BG_CHG bch WITH(NOLOCK)
							          GROUP BY bch.acnt_yy
							                  ,bch.acnt_unt
							                  ,bch.budg_org_id
							                  ,bch.bal_div
							                  ,bch.biz_cd
							                  ,bch.chg_seq
							                  ,bch.acnt_cd ) bch
				      ON   bca.acnt_yy     = bch.acnt_yy
						 AND bca.acnt_unt    = bch.acnt_unt
						 AND bca.budg_org_id = bch.budg_org_id
						 AND bca.bal_div     = bch.bal_div
						 AND bca.biz_cd      = bch.biz_cd
						 AND bca.chg_seq     = bch.chg_seq
			       LEFT OUTER JOIN BG_ACNT_CD bac1 WITH(NOLOCK)
				      ON   bch.acnt_unt    = bac1.acnt_unt
					   AND bch.acnt_yy     = bac1.acnt_yy
					   AND bch.bfr_acnt_cd = bac1.acnt_cd

			 WHERE bca.acnt_yy     = #acntYy#
			   <isNotEmpty property = "acntUnt">
			   AND bca.acnt_unt    = #acntUnt# 
			   </isNotEmpty>
			   AND bca.budg_org_id = #budgOrgId#
			   AND bca.bal_div     = #balDiv#
			   AND bca.chg_seq     = CONVERT(INT, #chgSeq#)
			   AND bca.sta_cd      = #staCd#
			 ORDER BY bca.acnt_yy
			         ,bca.acnt_unt
			         ,bca.budg_org_id
			         ,bca.bal_div
			         ,bca.biz_cd
			         ,bca.chg_seq
			         ,bch.bch_acnt_cd
    </select>
    
    <update id="admiDAO.updateBgStaCdReca" parameterClass="java.util.HashMap">
    	/* admiDAO.updateBgStaCdReca 편성된 예산을 반려한다.  */
    	UPDATE BG_ORG_BIZ
           SET sta_cd        = #staCd#                       /* 진행상태코드 */
              ,rcl_dt        = CONVERT(CHAR(10),GETDATE(),112)         /* 반려일자 */
              ,rcl_rsn       = #rclRsn#                           /* 반려사유 */
              ,update_id     = #updateId#                     /* 최근수정사용자ID */
              ,update_dt     = GETDATE()                             /* 최근수정일시 */
              ,update_ip     = #updateIp#                       /* 최근수정IP */
              ,update_pgm    = #updatePgm#
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND biz_cd        = #bizCd#
           AND budg_org_id   = #budgOrgId#
           AND bal_div       = #balDiv#
           AND budg_cd       = #budgCd#
    </update>
    
    <update id="admiDAO.updateBgChgStaCdReca" parameterClass="java.util.HashMap">
    	/* admiDAO.updateBgChgStaCdReca 편성된 변경예산을 반려한다.  */
    	UPDATE BG_CHG_APLY
           SET sta_cd        = #staCd#                       /* 진행상태코드 */
              ,rcl_dt        = CONVERT(CHAR(10),GETDATE(),112)         /* 반려일자 */
              ,rcl_rsn       = #rclRsn#                           /* 반려사유 */
              ,update_id     = #updateId#                     /* 최근수정사용자ID */
              ,update_dt     = GETDATE()                             /* 최근수정일시 */
              ,update_ip     = #updateIp#                       /* 최근수정IP */
              ,update_pgm    = #updatePgm#
         WHERE acnt_unt      = #acntUnt#
           AND acnt_yy       = #acntYy#
           AND chg_seq       = CONVERT(INT, #chgSeq#)
           AND aply_org_id   = #aplyOrgId#
           AND chg_div       = #chgDiv#
    </update>
    
    <select id="admiDAO.selectBgFrmnFixedExcelTotal" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelTotal 예산편성관리 - 예산확정된 데이터중 전체로 엑셀내려받기  */
    		
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR BUDG_ORG_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , A.BIZ_CD
			     , G.BIZ_NM
			     , B.ACNT_CD
			     , ISNULL(CASE WHEN A.BAL_DIV = '10' THEN H.ACNT_INC_NM ELSE H.ACNT_EXP_NM END,H.ACNT_NM) ACNT_NM
			     , C.SEQ
			     , C.ITM_SEQ
			     , I.ITM_SEQ_NM SESEMOK_NM
			     , C.ITM_NM
			     , C.CALC_BSS
			     , C.BUDG_AMT
			     , J.NM USER_NM
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
			       JOIN BG_FRMN_DET C WITH(NOLOCK)
			         ON    B.ACNT_UNT = C.ACNT_UNT
					   AND B.ACNT_YY = C.ACNT_YY
					   AND B.BUDG_ORG_ID = C.BUDG_ORG_ID
					   AND B.BAL_DIV = C.BAL_DIV
					   AND B.BIZ_CD = C.BIZ_CD
					   AND B.BUDG_CD = C.BUDG_CD
					   AND B.ACNT_CD = C.ACNT_CD
					   AND B.ADJ_ORD_CD = C.ADJ_ORD_CD  
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			         ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
				           FROM COM_COD WITH(NOLOCK)
				          WHERE COM_CD_DIV = 'BG007')  F
				     ON    A.BAL_DIV = F.COM_CD    
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON    B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD
			       LEFT OUTER JOIN BG_ITM_SEQ I WITH(NOLOCK)
			         ON    C.ACNT_UNT = I.ACNT_UNT
					   AND C.ACNT_YY = I.ACNT_YY
					   AND C.ACNT_CD = I.ACNT_CD
					   AND C.BAL_DIV = I.BAL_DIV
					   AND C.ITM_SEQ = I.ITM_SEQ 
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON    A.APLY_USER_ID = J.MEMBER_NO
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual> 
			 ORDER BY B.BUDG_ORG_ID
			     , B.ACNT_UNT
			     , B.BAL_DIV
			     , B.BIZ_CD
			     , B.ACNT_CD
			     , C.SEQ 
    </select>
    
    <select id="admiDAO.selectBgFrmnFixedExcelAcntUnt" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelAcntUnt 예산편성관리 - 예산확정된 데이터중 회계단위로 엑셀내려받기  */
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , SUM(B.BUDG_AMT) BUDG_AMT
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
					   AND B.ADJ_ORD_CD = B.ADJ_ORD_CD
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			         ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
							          FROM COM_COD WITH(NOLOCK)
							         WHERE COM_CD_DIV = 'BG007')  F
				     ON    A.BAL_DIV = F.COM_CD
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON    B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON    A.APLY_USER_ID = J.MEMBER_NO
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual>
			 GROUP BY A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM
			 ORDER BY A.ACNT_UNT
			     , A.BAL_DIV
    </select>
    
    <select id="admiDAO.selectBgFrmnFixedExcelAcntCd" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelAcntCd 예산편성관리 - 예산확정된 데이터중 계정과목별로 엑셀내려받기  */
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR BUDG_ORG_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , A.BIZ_CD
			     , G.BIZ_NM
			     , B.ACNT_CD
			     , ISNULL(CASE WHEN A.BAL_DIV = '10' THEN H.ACNT_INC_NM ELSE H.ACNT_EXP_NM END,H.ACNT_NM) ACNT_NM
			     , B.BUDG_AMT
			     , J.NM USER_NM
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
					   AND B.ADJ_ORD_CD = B.ADJ_ORD_CD
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			         ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
							          FROM COM_COD WITH(NOLOCK)
							         WHERE COM_CD_DIV = 'BG007')  F
			         ON    A.BAL_DIV = F.COM_CD
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD 
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON    B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD   
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON    A.APLY_USER_ID = J.MEMBER_NO 
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual> 
			 ORDER BY B.BUDG_ORG_ID
			     , B.ACNT_UNT
			     , B.BAL_DIV
			     , B.BIZ_CD
			     , B.ACNT_CD
    </select>
    
    <select id="admiDAO.selectBgFrmnFixedExcelBizCd" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelBizCd 예산편성관리 - 예산확정된 데이터중 사업별로 엑셀내려받기  */
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR BUDG_ORG_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , A.BIZ_CD
			     , G.BIZ_NM
			     , SUM(B.BUDG_AMT) BUDG_AMT
			     , J.NM USER_NM
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
					   AND B.ADJ_ORD_CD = B.ADJ_ORD_CD
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			       	 ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
							          FROM COM_COD WITH(NOLOCK)
							         WHERE COM_CD_DIV = 'BG007')  F
				     ON    A.BAL_DIV = F.COM_CD
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON   B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD 
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON   A.APLY_USER_ID = J.MEMBER_NO
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual> 
			 GROUP BY A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR
			     , A.BAL_DIV
			     , F.COM_CD_NM
			     , A.BIZ_CD
			     , G.BIZ_NM
			     , J.NM
			 ORDER BY A.BUDG_ORG_ID
			     , A.ACNT_UNT
			     , A.BAL_DIV
			     , A.BIZ_CD
    </select>
    
    <select id="admiDAO.selectBgFrmnFixedExcelBudgOrgId" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelBudgOrgId 예산편성관리 - 예산확정된 데이터중 부서별로 엑셀내려받기  */
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR BUDG_ORG_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , SUM(B.BUDG_AMT) BUDG_AMT
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       INNER JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
					   AND B.ADJ_ORD_CD = B.ADJ_ORD_CD
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			       	 ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
							          FROM COM_COD WITH(NOLOCK)
							         WHERE COM_CD_DIV = 'BG007')  F
				     ON    A.BAL_DIV = F.COM_CD
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON   B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD 
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON   A.APLY_USER_ID = J.MEMBER_NO
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual> 
			 GROUP BY A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR
			     , A.BAL_DIV
			     , F.COM_CD_NM
			 ORDER BY A.BUDG_ORG_ID
			     , A.ACNT_UNT
			     , A.BAL_DIV
    </select>
    
    <select id="admiDAO.selectBgFrmnFixedExcelBudgCd" parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgFrmnFixedExcelBudgCd  */
    		SELECT A.ACNT_UNT
			     , D.ACNT_UNT_NM
			     , A.BUDG_ORG_ID
			     , E.DEPT_NM_KOR BUDG_ORG_NM
			     , A.BAL_DIV
			     , F.COM_CD_NM BAL_DIV_NM
			     , A.BIZ_CD
			     , G.BIZ_NM
			     , B.ACNT_CD
			     , ISNULL(CASE WHEN A.BAL_DIV = '10' THEN H.ACNT_INC_NM ELSE H.ACNT_EXP_NM END,H.ACNT_NM) ACNT_NM
			     , C.SEQ
			     , C.ITM_SEQ
			     , I.ITM_SEQ_NM SESEMOK_NM
			     , C.ITM_NM
			     , C.CALC_BSS
			     , C.BUDG_AMT
			     , C.PRE_BUDG_AMT
			     , C.CHG_DESC
			     , ISNULL(C.BUDG_AMT, 0) - ISNULL(C.PRE_BUDG_AMT, 0) as chg_amt
			     , J.NM USER_NM
			  FROM BG_ORG_BIZ A WITH(NOLOCK)
			       JOIN BG_FRMN B WITH(NOLOCK)
			         ON    A.ACNT_UNT = B.ACNT_UNT
					   AND A.ACNT_YY = B.ACNT_YY
					   AND A.BUDG_ORG_ID = B.BUDG_ORG_ID
					   AND A.BAL_DIV = B.BAL_DIV
					   AND A.BIZ_CD = B.BIZ_CD
					   AND A.BUDG_CD = B.BUDG_CD
			       JOIN BG_FRMN_DET C WITH(NOLOCK)
			         ON    B.ACNT_UNT = C.ACNT_UNT
					   AND B.ACNT_YY = C.ACNT_YY
					   AND B.BUDG_ORG_ID = C.BUDG_ORG_ID
					   AND B.BAL_DIV = C.BAL_DIV
					   AND B.BIZ_CD = C.BIZ_CD
					   AND B.BUDG_CD = C.BUDG_CD
					   AND B.ACNT_CD = C.ACNT_CD
					   AND B.ADJ_ORD_CD = C.ADJ_ORD_CD  
			       LEFT OUTER JOIN BG_UNT D WITH(NOLOCK)
			         ON    A.ACNT_UNT = D.ACNT_UNT
			       LEFT OUTER JOIN VW_COMM_DEPT E WITH(NOLOCK)
			         ON    A.BUDG_ORG_ID = E.DEPT_CD
			       LEFT OUTER JOIN (SELECT *
				           FROM COM_COD WITH(NOLOCK)
				          WHERE COM_CD_DIV = 'BG007')  F
				     ON    A.BAL_DIV = F.COM_CD    
			       LEFT OUTER JOIN BG_BIZ G WITH(NOLOCK)
			         ON    A.ACNT_UNT = G.ACNT_UNT
			           AND A.BIZ_CD = G.BIZ_CD
			       LEFT OUTER JOIN BG_ACNT_CD H WITH(NOLOCK)
			         ON    B.ACNT_UNT = H.ACNT_UNT
					   AND B.ACNT_YY = H.ACNT_YY
					   AND B.ACNT_CD = H.ACNT_CD
			       LEFT OUTER JOIN BG_ITM_SEQ I WITH(NOLOCK)
			         ON    C.ACNT_UNT = I.ACNT_UNT
					   AND C.ACNT_YY = I.ACNT_YY
					   AND C.ACNT_CD = I.ACNT_CD
					   AND C.BAL_DIV = I.BAL_DIV
					   AND C.ITM_SEQ = I.ITM_SEQ 
			       LEFT OUTER JOIN VW_USER_LIST J
			         ON    A.APLY_USER_ID = J.MEMBER_NO
			 WHERE A.ACNT_YY = #acntYy#
			   AND A.BUDG_CD = #budgCd#
			   <isNotEmpty property = "staCd">
			   AND A.STA_CD = #staCd#
			   </isNotEmpty>
			   <isEqual property = "staCd" compareValue = "50">
			   AND A.CFM_ORD_CD = B.ADJ_ORD_CD
			   </isEqual>
			   <isNotEqual property = "staCd" compareValue = "50">
			   AND B.ADJ_ORD_CD = #adjOrdCd#
			   </isNotEqual>
			 ORDER BY B.BUDG_ORG_ID
			     , B.ACNT_UNT
			     , B.BAL_DIV
			     , B.BIZ_CD
			     , B.ACNT_CD
			     , C.SEQ 
    </select>
    
    <select id="admiDAO.selectBgChgAplyList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgChgAplyList 변경예산계획조회한다. */
    		SELECT '0' AS chk
		          ,'' AS row_status
    		      ,bca.acnt_unt
		          ,bca.acnt_yy
		          ,bca.aply_org_id
		          ,VCD.DEPT_NM_KOR AS APLY_ORG_NM
		          ,bca.bal_div
		          ,bca.chg_seq
		          ,bca.sta_cd
		          ,bca.chg_div
		          ,bca.chg_dsc
		          ,bca.aply_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.aply_user_id) as aply_user_nm
		          ,bca.aply_dt
		          ,bca.appro_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.appro_user_id) as appro_user_nm
		          ,bca.appro_dt
		          ,bca.cfm_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.cfm_user_id) as cfm_user_nm
		          ,bca.cfm_dt
		          ,bca.file_id
		          ,bca.rcl_rsn
		          ,bca.rcl_dt
				  ,ISNULL(bch2.plus_budg_amt,0)as trans_budg_amt   /* 전용신청금액 */
                  ,ISNULL(bch3.plus_budg_amt,0)as plus_budg_amt   /* 추가신청금액 */
                  ,CASE WHEN #chgDiv# = '10' THEN ISNULL(bch2.plus_budg_amt,0) ELSE ISNULL(bch3.plus_budg_amt,0) END as tot_amt
                  ,bca.elec_id
                  ,bca.form_id
                  ,bca.approval_div
                  ,bca.approval_userid
                  ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.approval_userid) as approval_usernm
                  ,bca.approval_dt
		      FROM BG_CHG_APLY bca WITH(NOLOCK)
		           LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
					                      ,sum(bch1.budg_amt) as all_budg_amt /* 신청금액 */
					                      ,sum(case when bch1.budg_amt > 0 
					                                then bch1.budg_amt 
					                                else 0
					                                end) as plus_budg_amt /* 전용,추가,신청금액 */
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch2
					  ON   bca.acnt_unt     = bch2.acnt_unt
			           AND bca.acnt_yy      = bch2.acnt_yy
			           AND bca.aply_org_id  = bch2.aply_org_id
			           AND bca.chg_seq      = bch2.chg_seq
	               LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
				                         ,sum(bch1.budg_amt) as plus_budg_amt
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch3 
					  ON   bca.acnt_unt     = bch3.acnt_unt
			           AND bca.acnt_yy      = bch3.acnt_yy
			           AND bca.aply_org_id  = bch3.aply_org_id
			           AND bca.chg_seq      = bch3.chg_seq
			       LEFT OUTER JOIN VW_COMM_DEPT_ALL VCD
			         ON VCD.DEPT_CD = BCA.APLY_ORG_ID
		     WHERE bca.acnt_yy      = #acntYy#
		       AND bca.acnt_unt     = #acntUnt#
		       AND bca.aply_org_id  = #aplyOrgId#
		       AND bca.chg_div      = #chgDiv#
		       <isNotEmpty property="staCd">
		       AND bca.sta_cd    = #staCd#
		       </isNotEmpty>
		       
		     ORDER BY bca.acnt_unt
			          ,bca.acnt_yy
			          ,bca.aply_org_id
			          ,bca.chg_seq
		       
    </select>
    
    <select id="admiDAO.selectBgChgAplyDetList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgChgAplyDetList 변경예산계획상세조회한다. */
    		SELECT '0' AS chk
		          ,'' AS row_status
    		      ,bc.acnt_unt           /* 회계단위ID D*/
	              ,bc.acnt_yy            /* 회계년도 */
	              ,bc.bal_div            /* 수지구분코드 */
	              ,bc.budg_org_id        /* 요구조직ID */
	              ,(SELECT dbo.F_COM_DEPT_NM(bc.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm /* 조직명 */  
	              ,bc.chg_seq            /* 변경신청순번 */
	              ,bc.biz_cd             /* 사업코드 */
	              ,bb.biz_nm
	              ,bc.acnt_cd            /* 계정과목코드 */
	              ,bac1.acnt_nm           /* 계정과목명 세목명 */
	              ,bac2.acnt_nm as mok_nm /* 계정과목명 목명 */
	              ,bc.adj_ord_cd          /* 조정차수 */
	              ,bc.budg_amt            /* 예산액 */
	              ,bc.budg_cfm_dt         /* 예산확정일 */
	              ,bca.cfm_user_id        /* 확정자 */
	              ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.cfm_user_id) as cfm_user_nm
	              ,bca.budg_cd            /* 예산구분코드 */
	          FROM BG_CHG bc WITH(NOLOCK)
	              ,BG_CHG_APLY bca WITH(NOLOCK)
	              ,BG_BIZ bb WITH(NOLOCK)
	              ,BG_ACNT_CD bac1 WITH(NOLOCK)
	              ,BG_ACNT_CD bac2 WITH(NOLOCK)
	         WHERE bc.acnt_unt      = bca.acnt_unt
	           AND bc.acnt_yy       = bca.acnt_yy 
	           AND bc.aply_org_id   = bca.aply_org_id
	           AND bc.chg_seq       = bca.chg_seq
	           AND bc.acnt_unt      = bb.acnt_unt
	           AND bc.biz_cd        = bb.biz_cd 
	           AND bc.acnt_unt      = bac1.acnt_unt
	           AND bc.acnt_yy       = bac1.acnt_yy
	           AND bc.acnt_cd       = bac1.acnt_cd
	           AND bac1.acnt_unt    = bac2.acnt_unt
	           AND bac1.acnt_yy     = bac2.acnt_yy
	           AND bac1.upr_acnt_cd = bac2.acnt_cd
	           AND bc.acnt_unt      = #acntUnt#
	           AND bc.acnt_yy       = #acntYy#
	           AND bc.aply_org_id   = #aplyOrgId#
	           AND bc.chg_seq       = CONVERT(INT, #chgSeq#)
	           AND bc.adj_ord_cd    = #adjOrdCd#
	           AND bca.chg_div      = #chgDiv#
	         ORDER BY bc.acnt_unt        
		             ,bc.acnt_yy               
		             ,bc.bal_div  
		             ,(case bc.budg_org_id 
                       when '02000' then 1
                       when bc.budg_org_id  then 2
                       else 3
                       end )
    </select>
    
    <select id="admiDAO.selectBgChgAplyFixedList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgChgAplyFixedList 변경예산계획확정조회한다. */
    		
    		SELECT '0' AS chk
		          ,'' AS row_status
    		      ,bca.acnt_unt
		          ,bca.acnt_yy
		          ,bca.aply_org_id
		          ,dbo.F_COM_DEPT_NM(bca.aply_org_id, 'DEPT_NM_KOR') AS aply_org_nm
		          ,bca.bal_div
		          ,bca.chg_seq
		          ,bca.budg_cd
		          ,bca.sta_cd
		          ,bca.chg_div
		          ,bca.chg_dsc
		          ,bca.aply_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.aply_user_id) as aply_user_nm
		          ,bca.aply_dt
		          ,bca.appro_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.appro_user_id) as appro_user_nm
		          ,bca.appro_dt
		          ,bca.cfm_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.cfm_user_id) as cfm_user_nm
		          ,bca.cfm_dt
		          ,bca.file_id
		          ,bca.rcl_rsn
		          ,bca.rcl_dt
				  ,ISNULL(bch2.plus_budg_amt,0)as trans_budg_amt   /* 전용신청금액 */
                  ,ISNULL(bch3.plus_budg_amt,0)as plus_budg_amt   /* 추가신청금액 */
                  ,CASE WHEN bca.chg_div = '10' THEN ISNULL(bch2.plus_budg_amt,0) ELSE ISNULL(bch3.plus_budg_amt,0) END as tot_amt
                  ,APPROVAL_DOCID
		      FROM BG_CHG_APLY bca WITH(NOLOCK)
		           LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
					                      ,sum(bch1.budg_amt) as all_budg_amt /* 신청금액 */
					                      ,sum(case when bch1.budg_amt > 0 
					                                then bch1.budg_amt 
					                                else 0
					                                end) as plus_budg_amt /* 전용,추가,신청금액 */
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch2
				      ON  bca.acnt_unt     = bch2.acnt_unt
			           AND bca.acnt_yy      = bch2.acnt_yy
			           AND bca.aply_org_id  = bch2.aply_org_id
			           AND bca.chg_seq      = bch2.chg_seq
	                LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
				                         ,sum(bch1.budg_amt) as plus_budg_amt
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch3 
				      ON  bca.acnt_unt     = bch3.acnt_unt
			           AND bca.acnt_yy      = bch3.acnt_yy
			           AND bca.aply_org_id  = bch3.aply_org_id
			           AND bca.chg_seq      = bch3.chg_seq		                         
		     WHERE bca.acnt_yy      = #acntYy#
		       AND bca.acnt_unt     = #acntUnt#
		       <isNotEmpty property = "aplyOrgId">
		       AND bca.aply_org_id = #aplyOrgId#
		       </isNotEmpty>
		       <isNotEmpty property = "chgDiv">
		       AND bca.chg_div = #chgDiv#
		       </isNotEmpty>
		       AND bca.chg_div in ('10', '20')
		       <isNotEmpty property = "staCd">
		       AND bca.sta_cd = #staCd#
		       </isNotEmpty>
		       AND bca.sta_cd IN ('50', '60')
		     ORDER BY bca.acnt_unt
			          ,bca.acnt_yy
			          ,bca.aply_org_id
			          ,bca.chg_seq
			          
		       
    </select>
    
    <select id="admiDAO.selectBgChgAplyFixedListManager"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgChgAplyFixedListManager 변경예산계획확정조회한다. */
    		SELECT '0' AS chk
		          ,'' AS row_status
    		      ,bca.acnt_unt
		          ,bca.acnt_yy
		          ,bca.aply_org_id
		          ,dbo.F_COM_DEPT_NM(bca.aply_org_id, 'DEPT_NM_KOR') AS aply_org_nm
		          ,bca.bal_div
		          ,bca.chg_seq
		          ,bca.budg_cd
		          ,bca.sta_cd
		          ,bca.chg_div
		          ,bca.chg_dsc
		          ,bca.aply_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.aply_user_id) as aply_user_nm
		          ,bca.aply_dt
		          ,bca.appro_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.appro_user_id) as appro_user_nm
		          ,bca.appro_dt
		          ,bca.cfm_user_id
		          ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.cfm_user_id) as cfm_user_nm
		          ,bca.cfm_dt
		          ,bca.file_id
		          ,bca.rcl_rsn
		          ,bca.rcl_dt
				  ,ISNULL(bch2.plus_budg_amt,0)as trans_budg_amt   /* 전용신청금액 */
                  ,ISNULL(bch3.plus_budg_amt,0)as plus_budg_amt   /* 추가신청금액 */
                  ,CASE WHEN #chgDiv# = '10' THEN ISNULL(bch2.plus_budg_amt,0) ELSE ISNULL(bch3.plus_budg_amt,0) END as tot_amt
		      FROM BG_CHG_APLY bca WITH(NOLOCK)
		           LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
					                      ,sum(bch1.budg_amt) as all_budg_amt /* 신청금액 */
					                      ,sum(case when bch1.budg_amt > 0 
					                                then bch1.budg_amt 
					                                else 0
					                                end) as plus_budg_amt /* 전용,추가,신청금액 */
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch2
				      ON  bca.acnt_unt     = bch2.acnt_unt
			           AND bca.acnt_yy      = bch2.acnt_yy
			           AND bca.aply_org_id  = bch2.aply_org_id
			           AND bca.chg_seq      = bch2.chg_seq
	                LEFT OUTER JOIN (SELECT bch1.acnt_unt 
					                      ,bch1.acnt_yy    
					                      ,bch1.aply_org_id
					                      ,bch1.chg_seq
					                      ,bch1.adj_ord_cd
				                         ,sum(bch1.budg_amt) as plus_budg_amt
					                  FROM BG_CHG bch1 WITH(NOLOCK)
					                 WHERE bch1.adj_ord_cd = #adjOrdCd#
					                 GROUP BY bch1.acnt_unt 
					                         ,bch1.acnt_yy    
					                         ,bch1.aply_org_id
					                         ,bch1.adj_ord_cd
					                         ,bch1.chg_seq) bch3 
				      ON  bca.acnt_unt     = bch3.acnt_unt
			           AND bca.acnt_yy      = bch3.acnt_yy
			           AND bca.aply_org_id  = bch3.aply_org_id
			           AND bca.chg_seq      = bch3.chg_seq		                         
		     WHERE bca.acnt_yy      = #acntYy#
		       AND bca.acnt_unt     = #acntUnt#
		       <isNotEmpty property = "aplyOrgId">
		       AND bca.aply_org_id = #aplyOrgId#
		       </isNotEmpty>
		       AND bca.chg_div = #chgDiv#
		       <isNotEmpty property = "staCd">
		       AND bca.sta_cd = #staCd#
		       </isNotEmpty>
		     ORDER BY bca.acnt_unt
			          ,bca.acnt_yy
			          ,bca.aply_org_id
			          ,bca.chg_seq
			          
		       
    </select>
    
    <select id="admiDAO.selectBgChgAplyDetFixedList"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBgChgAplyDetFixedList 변경예산계획상세확정조회한다. */
    		SELECT '0' AS chk
		          ,'' AS row_status
    		      ,bc.acnt_unt           /* 회계단위ID D*/
	              ,bc.acnt_yy               /* 회계년도 */
	              ,bc.bal_div           /* 수지구분코드 */
	              ,bc.budg_org_id             /* 요구조직ID */
	              ,(SELECT dbo.F_COM_DEPT_NM(bc.budg_org_id, 'DEPT_NM_KOR')) AS budg_org_nm /* 조직명 */  
	              ,bc.chg_seq            /* 변경신청순번 */
	              ,bc.biz_cd                 /* 사업코드 */
	              ,bb.biz_nm
	              ,bc.acnt_cd            /* 계정과목코드 */
	              ,bac1.acnt_nm             /* 계정과목명 세목명 */
	              ,bac2.acnt_nm as mok_nm   /* 계정과목명 목명 */
	              ,bc.adj_ord_cd               /* 조정차수 */
	              ,bc.budg_amt               /* 예산액 */
	              ,bc.budg_cfm_dt           /* 예산확정일 */
	              ,bca.cfm_user_id          /* 확정자 */
	              ,(SELECT cu.nm 
		              FROM VW_USER_LIST cu
		             WHERE cu.member_no = bca.cfm_user_id) as cfm_user_nm
	              ,bca.budg_cd            /* 예산구분코드 */
	          FROM BG_CHG bc WITH(NOLOCK)
	              ,BG_CHG_APLY bca WITH(NOLOCK)
	              ,BG_BIZ bb WITH(NOLOCK)
	              ,BG_ACNT_CD bac1 WITH(NOLOCK)
	              ,BG_ACNT_CD bac2 WITH(NOLOCK)
	         WHERE bc.acnt_unt      = bca.acnt_unt
	           AND bc.acnt_yy       = bca.acnt_yy 
	           AND bc.aply_org_id   = bca.aply_org_id
	           AND bc.chg_seq       = bca.chg_seq
	           AND bc.acnt_unt      = bb.acnt_unt
	           AND bc.biz_cd        = bb.biz_cd 
	           AND bc.acnt_unt      = bac1.acnt_unt
	           AND bc.acnt_yy       = bac1.acnt_yy
	           AND bc.acnt_cd       = bac1.acnt_cd
	           AND bac1.acnt_unt    = bac2.acnt_unt
	           AND bac1.acnt_yy     = bac2.acnt_yy
	           AND bac1.upr_acnt_cd = bac2.acnt_cd
	           AND bc.acnt_unt      = #acntUnt#
	           AND bc.acnt_yy       = #acntYy#
	           AND bc.aply_org_id   = #aplyOrgId#
	           AND bc.chg_seq       = CONVERT(INT, #chgSeq#)
	           AND bc.adj_ord_cd    = #adjOrdCd#
	           AND bca.chg_div       = #chgDiv#
	         ORDER BY(case bc.budg_org_id 
                      when '02000' then 1
                      when bc.budg_org_id  then 2
                      else 3
                      end )
                     , bc.budg_org_id 
                     , bc.acnt_unt          
	              	 ,bc.acnt_yy               
	                 ,bc.bal_div 
	                 
    </select>
    
    
    <insert id="admiDAO.insertBgChgAply" parameterClass="java.util.HashMap">
    		/* admiDAO.insertBgChgAply 변경예산계획 등록한다. */
    		INSERT INTO BG_CHG_APLY
                   (
                     acnt_unt
                    ,acnt_yy
                    ,aply_org_id
                    ,bal_div
                    ,chg_seq
                    ,budg_cd
                    ,sta_cd
                    ,chg_div
                    ,chg_dsc
                    ,aply_user_id
                    ,aply_dt
                    ,appro_user_id
                    ,appro_dt
                    ,cfm_user_id
                    ,cfm_dt
                    ,rcl_dt
                    ,rcl_rsn
                    ,elec_id
                    ,form_id
                    ,approval_div
                    ,approval_userid
                    ,approval_dt
                    ,insert_dt
                    ,insert_id
                    ,insert_ip
                    ,insert_pgm
                    )VALUES(
                     #acntUnt#
                    ,#acntYy#
                    ,#aplyOrgId#
                    ,#balDiv#
                    ,(SELECT ISNULL(max(chg_seq),'0')+1 
				        FROM BG_CHG_APLY WITH(NOLOCK)
				       WHERE acnt_yy     = #acntYy#
				         AND acnt_unt    = #acntUnt#
				         AND aply_org_id = #aplyOrgId# )
                    ,#budgCd#
                    ,#staCd#
                    ,#chgDiv#
                    ,#chgDsc#
                    ,#aplyUserId#
                    ,#aplyDt#
                    ,#approUserId#
                    ,#approDt#
                    ,#cfmUserId#
                    ,#cfmDt#
                    ,#rclDt#
                    ,#rclRsn#
                    ,#elecId#
                    ,#formId#
                    ,''
                    ,''
                    ,''
                    ,GETDATE()
                    ,#insertId#
                    ,#insertIp#
                    ,#insertPgm#
                    )
    </insert>
    
    
    <update id="admiDAO.updateBgChgAply" parameterClass="java.util.HashMap">
    		/* admiDAO.updateBgChgAply 변경예산계획 수정한다. */
    		UPDATE BG_CHG_APLY
	           SET budg_cd    = #budgCd#
	              ,chg_dsc    = #chgDsc#
	        WHERE acnt_unt    = #acntUnt#
	          AND acnt_yy     = #acntYy#
	          AND aply_org_id = #aplyOrgId#
	          AND chg_seq     = CONVERT(INT, #chgSeq#)
    
    </update>
    
    <update id="admiDAO.updateBgChgAplyApprovalCancel" parameterClass="java.util.HashMap">
    		/* admiDAO.updateBgChgAplyApprovalCancel 변경예산계획 전자결재 취소 */
    		BEGIN
    		
	    		UPDATE BG_CHG_APLY
		           SET sta_cd     = '10'
		              ,aply_user_id = ''
		              ,aply_dt    = ''
		              ,elec_id    = ''
		        WHERE acnt_unt    = #acntUnt#
		          AND acnt_yy     = #acntYy#
		          AND aply_org_id = #aplyOrgId#
		          AND chg_seq     = CONVERT(INT, #chgSeq#)

	    		UPDATE ADMI.dbo.GW_APPROVAL_MST
		           SET approval_div = '2'
		         WHERE id         = #elecId#
		           AND FORM_ID    = '2016000010'
		          
		    END
	    
    </update>
    
    
    <delete id="admiDAO.deleteBgChgAply" parameterClass="java.util.HashMap">
    		/* admiDAO.deleteBgChgAply 변경예산계획 삭제한다. */
    		BEGIN

	    		DELETE 
	    		  FROM BG_CHG
	    		 WHERE acnt_unt    = #acntUnt#
		           AND acnt_yy     = #acntYy#
		           AND aply_org_id = #aplyOrgId#
		           AND chg_seq     = CONVERT(INT, #chgSeq#)
    		
	    		DELETE 
	    		  FROM BG_CHG_APLY
	    		 WHERE acnt_unt    = #acntUnt#
		           AND acnt_yy     = #acntYy#
		           AND aply_org_id = #aplyOrgId#
		           AND chg_seq     = CONVERT(INT, #chgSeq#)
		           
		    END
    </delete>
	
    <update id="admiDAO.copyBgChgAply" parameterClass="java.util.HashMap">

		BEGIN
		
			DECLARE @V_CHG_SEQ INT;
			
			SELECT @V_CHG_SEQ = ISNULL(max(chg_seq),'0')+1 
		      FROM BG_CHG_APLY
		     WHERE acnt_yy     = #acntYy#
		       AND acnt_unt    = #acntUnt#
		       AND aply_org_id = #aplyOrgId#
			
    		INSERT INTO BG_CHG_APLY
                   (
                     acnt_unt
                    ,acnt_yy
                    ,aply_org_id
                    ,bal_div
                    ,chg_seq
                    ,budg_cd
                    ,sta_cd
                    ,chg_div
                    ,chg_dsc
                    ,insert_dt
                    ,insert_id
                    ,insert_ip
                    ,insert_pgm
                    )
             SELECT ACNT_UNT
                  , ACNT_YY
                  , APLY_ORG_ID
                  , BAL_DIV
                  , @V_CHG_SEQ
                  , BUDG_CD
                  , '10'
                  , CHG_DIV
                  , CHG_DSC
                  , GETDATE()
                  , #updateId#
                  , #updateIp#
                  , 'COPY'
			   FROM BG_CHG_APLY
              WHERE acnt_unt    = #acntUnt#
	            AND acnt_yy     = #acntYy#
	            AND aply_org_id = #aplyOrgId#
	            AND chg_seq     = CONVERT(INT, #chgSeq#)
	            

			INSERT INTO BG_CHG 
			       ( ACNT_UNT
				    , ACNT_YY
					, APLY_ORG_ID
					, CHG_SEQ
					, BUDG_ORG_ID
					, BIZ_CD
					, ACNT_CD
					, ADJ_ORD_CD
					, BAL_DIV
					, BUDG_AMT
				   )
			   SELECT ACNT_UNT
				    , ACNT_YY
					, APLY_ORG_ID
					, @V_CHG_SEQ
					, BUDG_ORG_ID
					, BIZ_CD
					, ACNT_CD
					, ADJ_ORD_CD
					, BAL_DIV
					, BUDG_AMT
			     FROM BG_CHG
		        WHERE acnt_unt    = #acntUnt#
		          AND acnt_yy     = #acntYy#
		          AND aply_org_id = #aplyOrgId#
		          AND chg_seq     = CONVERT(INT, #chgSeq#)  
    		
    	END
    	
    </update>
	
	<select id="admiDAO.selectBgChgAdminList"  parameterClass="java.util.HashMap" resultClass="egovMap">
		 /* admiDAO.selectBgChgList 예산변경계정기본(관리자용) 조회한다 */
		    SELECT '0' AS chk
				  ,'' AS row_status
				  ,bch.acnt_unt           /* 회계단위ID A*/
	              ,bch.acnt_yy               /* 회계년도 */
	              ,bch.bal_div           /* 수지구분코드 */
	              ,bch.bal_div as key_bal_div  /* 수지구분코드(업데이트용) */
	              ,bch.aply_org_id
	              ,bch.budg_org_id             /* 예산조직ID */
	              ,bch.budg_org_id as key_budg_org_id  /* 예산조직ID(업데이트용) */
	              ,(SELECT dbo.F_COM_DEPT_NM(bch.budg_org_id, 'DEPT_NM_KOR')) as budg_org_nm /* 예산조직명 */
	              ,(SELECT dbo.F_COM_DEPT_NM(vcd.up_dept_cd, 'DEPT_NM_KOR')) as up_dept_nm /* 예산조직명 */  
	              ,bch.acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
	              ,ISNULL(CASE WHEN bch.bal_div = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END, bac1.acnt_nm) acnt_nm  /* 계정과목명 세목명 */    
	              ,ISNULL(CASE WHEN bch.bal_div = '10' THEN bac2.acnt_inc_nm ELSE bac2.acnt_exp_nm END, bac2.acnt_nm) mok_nm   /* 계정과목명 목명 */
	              ,bch.chg_seq            /* 변경신청순번 */
	              ,bch.biz_cd                 /* 사업코드 */
	              ,bch.biz_cd as key_biz_cd  /* 사업코드(업데이트용) */
	              ,bb.biz_nm                   /* 사업명 */
	              ,bch.acnt_cd            /* 계정과목코드 */
	              ,bch.adj_ord_cd               /* 조정차수 */
	              ,bch.budg_amt               /* 예산액 */
	              ,bch.budg_cfm_dt           /* 예산확정일 */
	              ,bca.budg_cd            /* 예산구분코드 */
	              ,dbo.F_AC_ASGN_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, '') as total_budg_amt /* 총예산액 */
	              ,ISNULL(dbo.F_AC_EXEC_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, ''),0) as exec_amt               /* 집행액 */
	              ,ISNULL((dbo.F_AC_ASGN_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, '')),0) 
	               -
	               ISNULL((dbo.F_AC_EXEC_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, '')),0) as baln_amt               /* 잔액 */
	              ,bca.chg_div  
	          FROM BG_CHG bch WITH(NOLOCK)
	              ,BG_CHG_APLY bca WITH(NOLOCK)
	              ,BG_BIZ bb WITH(NOLOCK)
	              ,BG_ACNT_CD bac1 WITH(NOLOCK)
	              ,BG_ACNT_CD bac2 WITH(NOLOCK)
	              ,VW_COMM_DEPT_ALL vcd WITH(NOLOCK)
	         WHERE bch.acnt_unt     = bca.acnt_unt
	           AND bch.acnt_yy      = bca.acnt_yy 
	           AND bch.chg_seq      = bca.chg_seq
	           AND bch.aply_org_id  = bca.aply_org_id
	           AND bch.acnt_unt     = bb.acnt_unt
	           AND bch.biz_cd       = bb.biz_cd 
	           AND bch.acnt_unt     = bac1.acnt_unt
	           AND bch.acnt_yy      = bac1.acnt_yy
	           AND bch.acnt_cd      = bac1.acnt_cd
	           AND bac1.acnt_unt    = bac2.acnt_unt
	           AND bac1.acnt_yy     = bac2.acnt_yy
	           AND bac1.upr_acnt_cd = bac2.acnt_cd
	           AND bch.acnt_unt     = #acntUnt#
	           AND bch.acnt_yy      = #acntYy#
	           AND bch.aply_org_id  = #aplyOrgId#
	           AND bch.chg_seq      = CONVERT(INT,#chgSeq#)
	           AND bch.adj_ord_cd   = #adjOrdCd#
	           AND bca.chg_div      = #chgDiv#
	           AND bch.budg_org_id  = vcd.dept_cd
	           ORDER BY (case bch.budg_org_id 
                         when '02000' then 1
                         when bch.budg_org_id  then 2
                         else 3
                         end ),bch.budg_org_id, bch.acnt_unt, bch.acnt_yy, bch.bal_div, bch.biz_cd, bch.acnt_cd
																		            
		</select>
	
	 <select id="admiDAO.selectBgChgList"  parameterClass="java.util.HashMap" resultClass="egovMap">
		 /* admiDAO.selectBgChgList 예산변경계정기본 조회한다 */
		    SELECT '0' AS chk
				  ,'' AS row_status
				  ,bch.acnt_unt           /* 회계단위ID A*/
	              ,bch.acnt_yy               /* 회계년도 */
	              ,bch.bal_div           /* 수지구분코드 */
	              ,bch.bal_div as key_bal_div  /* 수지구분코드(업데이트용) */
	              ,bch.aply_org_id
	              ,bch.budg_org_id             /* 예산조직ID */
	              ,bch.budg_org_id as key_budg_org_id  /* 예산조직ID(업데이트용) */
	              ,(SELECT dbo.F_COM_DEPT_NM(bch.budg_org_id, 'DEPT_NM_KOR')) as budg_org_nm /* 예산조직명 */ 
	              ,bch.acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
	              ,ISNULL(CASE WHEN bch.bal_div = '10' THEN bac1.acnt_inc_nm ELSE bac1.acnt_exp_nm END, bac1.acnt_nm) acnt_nm  /* 계정과목명 세목명 */    
	              ,ISNULL(CASE WHEN bch.bal_div = '10' THEN bac2.acnt_inc_nm ELSE bac2.acnt_exp_nm END, bac2.acnt_nm) mok_nm   /* 계정과목명 목명 */
	              ,bch.chg_seq            /* 변경신청순번 */
	              ,bch.biz_cd                 /* 사업코드 */
	              ,bch.biz_cd as key_biz_cd  /* 사업코드(업데이트용) */
	              ,bb.biz_nm                   /* 사업명 */
	              ,bch.acnt_cd            /* 계정과목코드 */
	              ,bch.adj_ord_cd               /* 조정차수 */
	              ,bch.budg_amt               /* 예산액 */
	              ,bch.budg_cfm_dt           /* 예산확정일 */
	              ,bca.budg_cd            /* 예산구분코드 */
	              ,ISNULL(dbo.F_AC_ASGN_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, ''),0) as total_budg_amt /* 총예산액 */
	              ,ISNULL(dbo.F_AC_EXEC_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, ''),0) as exec_amt               /* 집행액 */
	              ,ISNULL((dbo.F_AC_ASGN_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, '')),0) 
	               -
	               ISNULL((dbo.F_AC_EXEC_AMT_SUM(bch.acnt_yy, bch.acnt_unt, bch.budg_org_id, bch.biz_cd, bch.acnt_cd, bch.bal_div, '')),0) as baln_amt               /* 잔액 */
	              ,bca.chg_div  
	          FROM BG_CHG bch
	              ,BG_CHG_APLY bca
	              ,BG_BIZ bb
	              ,BG_ACNT_CD bac1
	              ,BG_ACNT_CD bac2
	         WHERE bch.acnt_unt     = bca.acnt_unt
	           AND bch.acnt_yy      = bca.acnt_yy 
	           AND bch.chg_seq      = bca.chg_seq
	           AND bch.aply_org_id  = bca.aply_org_id
	           AND bch.acnt_unt     = bb.acnt_unt
	           AND bch.biz_cd       = bb.biz_cd 
	           AND bch.acnt_unt     = bac1.acnt_unt
	           AND bch.acnt_yy      = bac1.acnt_yy
	           AND bch.acnt_cd      = bac1.acnt_cd
	           AND bac1.acnt_unt    = bac2.acnt_unt
	           AND bac1.acnt_yy     = bac2.acnt_yy
	           AND bac1.upr_acnt_cd = bac2.acnt_cd
	           AND bch.acnt_unt     = #acntUnt#
	           AND bch.acnt_yy      = #acntYy#
	           AND bch.aply_org_id  = #aplyOrgId#
	           AND bch.chg_seq      = CONVERT(INT, #chgSeq#)
	           AND bch.adj_ord_cd   = #adjOrdCd#
	           AND bca.chg_div      = #chgDiv#
	           ORDER BY bch.acnt_unt, bch.acnt_yy, bch.bal_div, bch.biz_cd, bch.acnt_cd
	            
		</select>
		
		<select id="admiDAO.selectBgChgDetList"  parameterClass="java.util.HashMap" resultClass="egovMap">
				/* admiDAO.selectBgChgDetList 예산변경신청상세를 조회한다 */
				SELECT '0' AS chk
				      ,'' AS row_status
				      ,acnt_unt    		/* 회계단위ID */
		              ,acnt_yy     		/* 회계년도 */
		              ,chg_seq     		/* 변경신청순번 */
		              ,bal_div    		/* 수지구분코드 */
		              ,bal_div as key_bal_div 		/* 수지구분코드(업데이트용) */
		              ,adj_ord_cd       /* 조정차수 */
		              ,budg_org_id      /* 예산조직ID */
		              ,budg_org_id as key_budg_org_id      /* 예산조직ID (업데이트용)*/
		              ,acnt_cd     		/* 계정과목코드 */
		              ,acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
		              ,biz_cd          	/* 사업코드 */
		              ,biz_cd as key_biz_cd          	/* 사업코드(업데이트용) */
		              ,seq         	    /* 품목순번 */
		              ,itm_nm          	/* 품목명 */
		              ,itm_seq         	/* 세세목 */
		              ,calc_bss    		/* 산출근거명 */
		              ,budg_amt       	/* 예산액 */
		          FROM BG_CHG_DET WITH(NOLOCK)
		         WHERE acnt_unt    = #acntUnt#
		           AND acnt_yy     = #acntYy#
		           AND chg_seq     = CONVERT(INT, #chgSeq#)
		           AND adj_ord_cd  = #adjOrdCd#
		           AND acnt_cd     = #acntCd#
		           AND budg_org_id = #budgOrgId#
		           AND biz_cd      = #bizCd#
		           AND bal_div     = #balDiv#
		         ORDER BY acnt_unt,acnt_yy,acnt_cd,biz_cd ,seq   
		</select>
		
		<select id="admiDAO.selectBgChgSchedList"  parameterClass="java.util.HashMap" resultClass="egovMap">   
				/* admiDAO.selectBgChgSchedList 변경예산계획정보 조회한다. */
				SELECT '0' AS chk
				      ,'' AS row_status
				      ,acnt_unt    /* 회계단위ID */
		              ,acnt_yy        /* 회계년도 */
		              ,chg_seq     		/* 변경신청순번 */
		              ,adj_ord_cd        /* 조정차수 */
		              ,budg_org_id      /* 예산조직ID */
		              ,budg_org_id as key_budg_org_id      /* 예산조직ID (업데이트용)*/
		              ,acnt_cd          /* 계정과목코드 */
		              ,acnt_cd as key_acnt_cd  /* 계정과목코드(업데이트용) */
		              ,biz_cd          /* 사업코드 */
		              ,biz_cd as key_biz_cd          	/* 사업코드(업데이트용) */
		              ,budg_yymm       /* 편성년월 */
		              ,budg_amt        /* 편성액 */
		              ,bal_div    /* 수지구분코드 */
		              ,bal_div as key_bal_div 		/* 수지구분코드(업데이트용) */
		              ,seq			/* 품목순번 */
		          FROM BG_CHG_SCHED WITH(NOLOCK)
		         WHERE acnt_unt    = #acntUnt#
		           AND acnt_yy     = #acntYy#
		           AND chg_seq     = CONVERT(INT, #chgSeq#)
		           AND adj_ord_cd  = #adjOrdCd#
		           AND acnt_cd     = #acntCd#
		           AND budg_org_id = #budgOrgId#
		           AND biz_cd      = #bizCd#
		           AND bal_div     = #balDiv#
		           AND seq         = CONVERT(INT, #seq#)
		         ORDER BY budg_yymm
		
		</select>
		
		<select id="admiDAO.selectDoGetLogout"  parameterClass="java.util.HashMap" resultClass="egovMap">   
				SELECT '로그아웃 되었습니다.' AS log
		</select>
		
		<insert id="admiDAO.insertGwApprovalMst" parameterClass="java.util.HashMap">
    		/* admiDAO.insertGwApprovalMst 전자결재연동테이블(MSSQL)에 저장한다 */
			INSERT INTO ADMI.dbo.GW_APPROVAL_MST
			           (ID
			           ,FORM_ID
			           ,TITLE
			           ,SUBJ_ID
			           ,SUBTITLE
			           ,BODY
			           ,APPROVAL_DIV
			           ,APPROVAL_DT
			           ,APPROVAL_DOCID
			           ,USER_ID
			           ,UPD_DT
			           ,VOU_NO
			           ,BIZ_NM
			           ,ACC_DEPT
			           )
			     VALUES
			           (#id#
			           ,#formId#
			           ,#title#
			           ,#subjId#
			           ,#subTitle#
			           ,#body#
			           ,''
			           ,''
			           ,''
			           ,#userId#
			           ,getdate()
			           ,#vouNoElec#
			           ,#bizNm#
			           ,dbo.F_GET_AD_DEPT(#accDept#)
			           )
    	</insert>
    	
		<select id="admiDAO.selectBgChgApproDiv10List"  parameterClass="java.util.HashMap" resultClass="egovMap">   
			/* admiDAO.selectBgChgApproDiv10List 변경예산계획정보(전자결재본문내용/전용) 조회한다. */
			SELECT BCH.BAL_DIV
		          ,(SELECT dbo.F_COM_CODE_NM('BG007', BCH.BAL_DIV, 'KOR')) AS BAL_DIV_NM
		          ,BCH.BIZ_CD
		          ,(SELECT dbo.F_AC_GET_BIZ_NM(BCH.ACNT_UNT, BCH.BIZ_CD, 'BIZ_NM')) AS BIZ_NM
		          ,BCH.ACNT_CD
		          ,(SELECT dbo.F_BUDG_ACNT_NM(BCH.ACNT_YY,BCH.ACNT_UNT,BCH.ACNT_CD,'50',BCH.BAL_DIV)) AS ACNT_NM
		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, ''),0)), 1), '.00', '') AS BUDG_AMT1
				  ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(BCH.BUDG_AMT,0)), 1), '.00', '') AS BUDG_AMT2
              	  ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, ''),0)
                                 +
                                 ISNULL(BCH.BUDG_AMT,0)), 1), '.00', '') AS BUDG_AMT3
			      ,'' as remark
			      ,BCH.BUDG_ORG_ID
			      ,(SELECT dbo.F_COM_DEPT_NM(BCH.BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
			      ,(SELECT ACNT_UNT_NM
			          FROM BG_UNT
			         WHERE ACNT_UNT = #acntUnt# ) AS ACNT_UNT_NM
			  FROM BG_CHG BCH WITH(NOLOCK)
			 WHERE BCH.ACNT_UNT     = #acntUnt#
			   AND BCH.ACNT_YY      = #acntYy#
			   AND BCH.CHG_SEQ      = CONVERT(INT, #chgSeq#)
			   AND BCH.APLY_ORG_ID  = #aplyOrgId#	
			 ORDER BY BCH.BAL_DIV,(CASE BCH.BUDG_ORG_ID 
			                       WHEN '02000' THEN 1
			                       WHEN BCH.BUDG_ORG_ID  THEN 2
			                       ELSE 3
			                       END )
		</select>	
		
		<select id="admiDAO.selectBgChgApproDiv20List"  parameterClass="java.util.HashMap" resultClass="egovMap">   
			/* admiDAO.selectBgChgApproDiv20List 변경예산계획정보(전자결재본문내용/추가) 조회한다. */
			SELECT BCH.BAL_DIV
		          ,(SELECT dbo.F_COM_CODE_NM('BG007', BCH.BAL_DIV, 'KOR')) AS BAL_DIV_NM
		          ,BCH.BIZ_CD
		          ,(SELECT dbo.F_AC_GET_BIZ_NM(BCH.ACNT_UNT, BCH.BIZ_CD, 'BIZ_NM')) AS BIZ_NM
		          ,BCH.ACNT_CD
		          ,(SELECT dbo.F_BUDG_ACNT_NM(BCH.ACNT_YY,BCH.ACNT_UNT,BCH.ACNT_CD,'50',BCH.BAL_DIV)) AS ACNT_NM
		          		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(dbo.F_AC_ASGN_AMT_SUM(BCH.ACNT_YY, BCH.ACNT_UNT, BCH.BUDG_ORG_ID, BCH.BIZ_CD, BCH.ACNT_CD, BCH.BAL_DIV, ''),0)), 1), '.00', '') AS BUDG_AMT
		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(BCH.BUDG_AMT,0)), 1), '.00', '') AS BUDG_AMT1
		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(dbo.F_AC_ASGN_AMT_SUM(BCH.ACNT_YY, BCH.ACNT_UNT, BCH.BUDG_ORG_ID, BCH.BIZ_CD, BCH.ACNT_CD, BCH.BAL_DIV, ''),0)+ISNULL(BCH.BUDG_AMT,0)), 1), '.00', '') AS BUDG_AMT_SUM
		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(SUM(CASE WHEN BCH.BAL_DIV = '10' THEN BCH.BUDG_AMT ELSE 0 END) OVER(),0)), 1), '.00', '') AS BUDG_AMT2
		          ,REPLACE(CONVERT(varchar, CONVERT(money, ISNULL(SUM(CASE WHEN BCH.BAL_DIV = '20' THEN BCH.BUDG_AMT ELSE 0 END) OVER(),0)), 1), '.00', '') AS BUDG_AMT3
			      ,'' as remark
			      ,BCH.BUDG_ORG_ID
			      ,(SELECT dbo.F_COM_DEPT_NM(BCH.BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
			      ,(SELECT ACNT_UNT_NM
			          FROM BG_UNT
			         WHERE ACNT_UNT = #acntUnt# ) AS ACNT_UNT_NM
			  FROM BG_CHG BCH WITH(NOLOCK)
			 WHERE BCH.ACNT_UNT     = #acntUnt#
			   AND BCH.ACNT_YY      = #acntYy#
			   AND BCH.CHG_SEQ      = CONVERT(INT, #chgSeq#)
			   AND BCH.APLY_ORG_ID  = #aplyOrgId#	
			 ORDER BY BCH.BAL_DIV,(CASE BCH.BUDG_ORG_ID 
			                       WHEN '02000' THEN 1
			                       WHEN BCH.BUDG_ORG_ID  THEN 2
			                       ELSE 3
			                       END )
		</select>		
		
		<select id="admiDAO.selectGwApprovalMstList"  parameterClass="java.util.HashMap" resultClass="egovMap">   
			/* admiDAO.selectGwApprovalMstList 전자결재연동테이블(MSSQL) 조회한다. */
			SELECT ID
			      ,FORM_ID
				  ,TITLE
				  ,SUBJ_ID
				  ,SUBTITLE
				  ,BODY
				  ,APPROVAL_DIV
				  ,APPROVAL_DT
				  ,APPROVAL_DOCID
				  ,USER_ID
				  ,UPD_DT
			  FROM GW_APPROVAL_MST WITH(NOLOCK)
			 WHERE UPD_DT = getdate()
		</select>	
		
		<insert id="admiDAO.insertGwApprovalMstOra" parameterClass="java.util.HashMap">
    		/* admiDAO.insertGwApprovalMstOra 전자결재연동테이블(ORACLE)에 저장한다 */
			
			INSERT INTO GW_APPROVAL_MST
			           (
			            ID
			           ,FORM_ID
			           ,TITLE
			           ,SUBJ_ID
			           ,SUBTITLE
			           ,BODY
			           ,APPROVAL_DIV
			           ,APPROVAL_DT
			           ,APPROVAL_DOCID
			           ,USER_ID
			           ,UPD_DT
			         ) VALUES (
			            #id#
			           ,#formId#
			           ,#title#
			           ,#subjId#
			           ,#subTitle#
			           ,#body#
			           ,''
			           ,''
			           ,''
			           ,#userId#
			           ,GETDATE()
			           )
    	</insert>
    	
    	<update id="admiDAO.updateBgChgAplyGwApprovalMstOra" parameterClass="java.util.HashMap">
    		/* admiDAO.updateBgChgAplyGwApprovalMstOra 변경예산계획 수정한다. */
    		UPDATE BG_CHG_APLY
	           SET elec_id         = #id#
	              ,form_id         = #formId#
	        WHERE acnt_unt         = #acntUnt#
	          AND acnt_yy          = #acntYy#
	          AND aply_org_id      = #aplyOrgId#
	          AND chg_seq          = CONVERT(INT,#chgSeq#)
    	</update>
    	
    	<select id="admiDAO.selectGwApprovalMstApprovalDiv"  parameterClass="java.util.HashMap" resultClass="String">   
			/* admiDAO.selectGwApprovalMstApprovalDiv 전자결재연동테이블  ApprovalDiv 조회 */
			select CASE WHEN APPROVAL_DIV IS NULL OR APPROVAL_DIV = '' THEN '0'
			            ELSE APPROVAL_DIV END AS APPROVAL_DIV
			  from ADMI.dbo.GW_APPROVAL_MST WITH(NOLOCK)
			 where ID = #elecId#
		</select>
    	
    	<select id="admiDAO.selectGwApprovalMstElecId"  parameterClass="java.util.HashMap" resultClass="egovMap">   
			/* admiDAO.selectGwApprovalMstElecId 전자결재연동테이블(MSSQL) 전자결재ID 조회한다. */

			select CASE WHEN #strElecId# IS NULL OR #strElecId# = '' THEN 'AFA' ELSE #strElecId# END
			       +SUBSTRING(CASE WHEN #strAcntYy# IS NULL OR #strAcntYy# = '' THEN '2016' ELSE #strAcntYy# END,3,2)
			       +dbo.FN_LPAD(ISNULL(MAX(SUBSTRING(ID,6,6))+1 , 0),6,'0') as elec_id
			  from ADMI.dbo.GW_APPROVAL_MST WITH(NOLOCK)
			 where SUBSTRING(ID,1,3) = 'AFA'
		</select>
		
		<select id="admiDAO.selectBgChgDeptAdddList"  parameterClass="java.util.HashMap" resultClass="egovMap">   
			/* admiDAO.selectBgChgDeptAdddList 예산변경관리(관리자용) 학부, 학과 조회 */
		     SELECT '' as chk
			       ,A.DEPT_CD
			       ,B.DEPT_NM_KOR AS UP_DEPT_NM
			       ,A.DEPT_NM_KOR AS DEPT_NM_KOR
			       ,A.DEPT_GB
			   FROM VW_COMM_DEPT A WITH(NOLOCK)
			        LEFT OUTER JOIN VW_COMM_DEPT B WITH(NOLOCK)
			          ON A.UP_DEPT_CD = B.DEPT_CD
			  WHERE 1=1
			  <isEqual property="gb" compareValue="03">
			  	   AND A.DEPT_GB IN ( '03', '04', '11')
			  </isEqual>
			  <isNotEqual property="gb" compareValue="03">
			  	   AND A.DEPT_GB = #gb#
			  </isNotEqual> 
			  
			  ORDER BY A.DEPT_CD
		</select>
		
		<select id="admiDAO.selectAddrDeptCombo"  parameterClass="java.util.HashMap" resultClass="egovMap"> 
				SELECT DEPT_CD AS COM_CD
				      ,DEPT_NM_KOR AS COM_CD_NM
				  FROM VW_COMM_DEPT WITH(NOLOCK)
				 WHERE DEPT_CD IN ('02150','00992','02190')
				 ORDER BY DEPT_NM_KOR
		</select>
		
		<select id="admiDAO.selectPrivateAddrDeptCombo"  parameterClass="java.util.HashMap" resultClass="egovMap"> 
			SELECT TA.DEPT_CD AS CODE
			     , TB.DEPT_NM_KOR AS NM
			  FROM (
			  		<isEqual property="memberNo" compareValue="dev1">
			  		SELECT '02150' AS DEPT_CD
			  		UNION
			  		SELECT '00992'
			  		UNION
			  		SELECT '02190'
			  		</isEqual>
			  		<isNotEqual property="memberNo" compareValue="dev1">
					SELECT DEPT_CD
					  FROM VW_USER_LIST
					 WHERE MEMBER_NO = #memberNo#
		
					UNION
		
					SELECT DEPT_CD
					  FROM VW_USER_ADD_DEPT
					 WHERE EMP_ID = #memberNo#
					</isNotEqual>
				   ) TA
			   INNER JOIN VW_COMM_DEPT TB
			   ON TA.DEPT_CD = TB.DEPT_CD
			 WHERE TA.DEPT_CD IN ( '02150','00992','02190' )
			 ORDER BY DEPT_NM_KOR
		</select>
		
		<select id="admiDAO.selectDcDept"  parameterClass="java.util.HashMap" resultClass="egovMap"> 
				SELECT DEPT_CD
				  FROM AC_DC_DEPT 
				 ORDER BY DEPT_CD
		</select>
		
		<select id="admiDAO.selectBg03050"  parameterClass="java.util.HashMap" resultClass="egovMap">
		    /* admiDAO.selectBg03050 실험실습비관리 - bg03050.xfdl */
		    SELECT '0' as chk
		         , '' as row_status
		         , A.DEPT_CD
			     , D.DEPT_NM_KOR AS UP_DEPT_NM
			     , C.DEPT_NM_KOR AS DEPT_NM
			     , ( SELECT ISNULL(SUM(APLY_AMT),0)
			           FROM BG_CTRL BC
			          WHERE BC.ACNT_UNT = #acntUnt#
			            AND BC.ACNT_YY  = #acntYy#
			            AND BC.ACNT_CD = '432301'
			            AND BC.BUDG_ORG_ID = A.DEPT_CD ) AS EXEC_AMT
			     , ISNULL(B.BUDG_AMT,0) AS REAL_BUDG_AMT
			     , ( SELECT ISNULL(SUM(BUDG_AMT),0)
			           FROM BG_ASGN BC
			          WHERE BC.ACNT_UNT = #acntUnt#
			            AND BC.ACNT_YY  = #acntYy#
			            AND BC.ACNT_CD = '432301'
			            AND BC.BUDG_ORG_ID = A.DEPT_CD ) AS ASGN_AMT
			     , #acntYy# AS ACNT_YY
			     , #acntUnt# AS ACNT_UNT
			  FROM ( SELECT DEPT_CD
			           FROM VW_COMM_DEPT
			          WHERE DEPT_GB IN ( '03','04','11')
			          UNION
			         SELECT BUDG_ORG_ID
			           FROM BG_ASGN
			          WHERE ACNT_YY = #acntYy#
			            AND ACNT_UNT = #acntUnt#
			            AND ACNT_CD = '432301'
			          UNION
			         SELECT DEPT_CD
			           FROM BG_EXPERI
			          WHERE ACNT_YY = #acntYy#
			            AND ACNT_UNT = #acntUnt#
			        ) A
			   LEFT OUTER JOIN ( SELECT ACNT_UNT
			                          , ACNT_YY
			                          , DEPT_CD
			                          , BUDG_AMT
			                       FROM BG_EXPERI
			                      WHERE ACNT_YY = #acntYy#
			                        AND ACNT_UNT = #acntUnt#  ) B
			     ON A.DEPT_CD = B.DEPT_CD 
			   LEFT OUTER JOIN VW_COMM_DEPT_ALL C
			     ON A.DEPT_CD = C.DEPT_CD
			   LEFT OUTER JOIN VW_COMM_DEPT_ALL D
			     ON C.UP_DEPT_CD = D.DEPT_CD
			ORDER BY CASE WHEN A.DEPT_CD = '02000' THEN 1 ELSE 2 END, D.DEPT_CD, A.DEPT_CD
    	</select>
    	
		<update id="admiDAO.updateBg3050"  parameterClass="java.util.HashMap">
		 MERGE INTO BG_EXPERI A
	          USING (SELECT #acntYy# AS ACNT_YY
	                      , #acntUnt# AS ACNT_UNT
	                      , #deptCd# AS DEPT_CD ) B
	             ON  A.ACNT_YY = B.ACNT_YY
	             AND A.ACNT_UNT = B.ACNT_UNT
	             AND A.DEPT_CD = B.DEPT_CD
	           WHEN MATCHED THEN
		     UPDATE 
		        SET BUDG_AMT = #realBudgAmt#
			   WHEN NOT MATCHED THEN
			 INSERT ( ACNT_YY
			        , ACNT_UNT
			        , DEPT_CD
			        , BUDG_AMT
			        )
		            VALUES
		            (#acntYy#
		            , #acntUnt#
		            , #deptCd#
		            , #realBudgAmt#
		            );
    	</update>
		
		<select id="admiDAO.selectBg04020"  parameterClass="java.util.HashMap" resultClass="egovMap">
		    /* admiDAO.selectBg04020 사업별예산목록 - bg04020.xfdl */
		    SELECT ISNULL(TA.ACNT_YY, TB.ACNT_YY) AS ACNT_YY
			     , ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) AS ACNT_UNT
			     , ISNULL(TA.BAL_DIV, TB.BAL_DIV) AS BAL_DIV
			     , ISNULL(TA.BIZ_CD, TB.BIZ_CD) AS BIZ_CD
			     , ISNULL(TA.BIZ_CD_NM, TB.BIZ_CD_NM) AS BIZ_CD_NM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) AS ASGN_AMT_SUM
			     , ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS EXEC_AMT_SUM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) - ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS BUDG_BAL
			     , CASE WHEN TA.ACNT_YY IS NULL THEN '1' ELSE '0' END AS GB
		    FROM (
			    SELECT BA.ACNT_YY
				     , BA.ACNT_UNT
				     , BA.BAL_DIV
				     , BA.BIZ_CD
				     , BB.BIZ_NM AS BIZ_CD_NM		     
				     , ISNULL(SUM(BA.BUDG_AMT),0) AS BUDG_AMT				     
				     , ISNULL((SELECT SUM(APLY_AMT)
				     	  FROM BG_CTRL BC
				     	 WHERE BC.ACNT_YY = BA.ACNT_YY
				     	   AND BC.ACNT_UNT = BA.ACNT_UNT
				     	   AND BC.BAL_DIV = BA.BAL_DIV
				     	   AND BC.BIZ_CD = BA.BIZ_CD 
				     	    <isNotEmpty property="acntCd">
						   AND BC.ACNT_CD = #acntCd#
						   </isNotEmpty>
				     	   ),0) AS APLY_AMT
				  FROM BG_ASGN BA WITH(NOLOCK)
				   LEFT OUTER JOIN BG_BIZ BB
				     ON   BA.ACNT_UNT = BB.ACNT_UNT
				      AND BA.BIZ_CD = BB.BIZ_CD
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   <isNotEmpty property="bizNm">
				   AND (   BA.BIZ_CD LIKE '%' + #bizNm# + '%'
				        OR BB.BIZ_NM LIKE '%' + #bizNm# + '%' )
				   </isNotEmpty>
				   <isNotEmpty property="bizCd">
				   AND BA.BIZ_CD = #bizCd#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BB.BIZ_NM, BA.BAL_DIV
		   	  ) TA
		   	 FULL OUTER JOIN
		   	  (
			    SELECT BC.ACNT_YY
				     , BC.ACNT_UNT
				     , BC.BAL_DIV
				     , BC.BIZ_CD
				     , BB.BIZ_NM AS BIZ_CD_NM				     
				     , 0 AS BUDG_AMT
				     , ISNULL(SUM(BC.APLY_AMT),0) AS APLY_AMT		
				  FROM BG_CTRL BC WITH(NOLOCK)
				   LEFT OUTER JOIN BG_BIZ BB
				     ON   BC.ACNT_UNT = BB.ACNT_UNT
				      AND BC.BIZ_CD = BB.BIZ_CD
				 WHERE 1=1
				   AND BC.ACNT_YY = #acntYy#
				   AND BC.ACNT_UNT = #acntUnt#
				   <isNotEmpty property="bizNm">
				   AND (   BC.BIZ_CD LIKE '%' + #bizNm# + '%'
				        OR BB.BIZ_NM LIKE '%' + #bizNm# + '%' )
				   </isNotEmpty>
				   <isNotEmpty property="bizCd">
				   AND BC.BIZ_CD = #bizCd#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BC.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BC.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BC.ACNT_YY, BC.ACNT_UNT, BC.BIZ_CD, BB.BIZ_NM, BC.BAL_DIV
		   	  ) TB
		   	  ON TA.ACNT_YY = TB.ACNT_YY
	   		  AND TA.ACNT_UNT = TB.ACNT_UNT
	   		  AND TA.BAL_DIV = TB.BAL_DIV
	   		  AND TA.BIZ_CD = TB.BIZ_CD
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD
   		  
    	</select>
    	
    	<select id="admiDAO.selectBg04020Tab0"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab0 사업별예산목록TAB0 - bg04020.xfdl */
		    SELECT ISNULL(TA.ACNT_YY, TB.ACNT_YY) AS ACNT_YY
			     , ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) AS ACNT_UNT
			     , ISNULL(TA.BAL_DIV, TB.BAL_DIV) AS BAL_DIV
			     , ISNULL(TA.BIZ_CD, TB.BIZ_CD) AS BIZ_CD
			     , ISNULL(TA.BIZ_CD_NM, TB.BIZ_CD_NM) AS BIZ_CD_NM
			     , ISNULL(TA.BUDG_ORG_ID, TB.BUDG_ORG_ID) AS BUDG_ORG_ID
			     , ISNULL(TA.BUDG_ORG_NM, TB.BUDG_ORG_NM) AS BUDG_ORG_NM
			     , ISNULL(TA.ACNT_CD_MOK_NM, TB.ACNT_CD_MOK_NM) AS ACNT_CD_MOK_NM
			     , ISNULL(TA.ACNT_CD, TB.ACNT_CD) AS ACNT_CD
			     , ISNULL(TA.ACNT_CD_NM, TB.ACNT_CD_NM) AS ACNT_CD_NM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) AS ASGN_AMT_SUM
			     , ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS EXEC_AMT_SUM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) - ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS BUDG_BAL
			     , CASE WHEN TA.ACNT_YY IS NULL THEN '1' ELSE '0' END AS GB
		    FROM (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , ISNULL(SUM(BUDG_AMT),0) AS BUDG_AMT				     
				     , ISNULL((SELECT SUM(APLY_AMT)
						    	  FROM BG_CTRL BC
						     	 WHERE BC.ACNT_YY = BA.ACNT_YY
						     	   AND BC.ACNT_UNT = BA.ACNT_UNT
						     	   AND BC.BAL_DIV = BA.BAL_DIV
						     	   AND BC.BIZ_CD = BA.BIZ_CD
						     	   AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
		                           AND BC.ACNT_CD = BA.ACNT_CD ),0) AS APLY_AMT
				  FROM BG_ASGN BA WITH(NOLOCK)
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.BUDG_ORG_ID, BA.ACNT_CD, BA.BAL_DIV
		   	  ) TA
		   	 FULL OUTER JOIN
		   	  (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , 0 AS BUDG_AMT
				     , ISNULL(SUM(APLY_AMT),0) AS APLY_AMT
				  FROM BG_CTRL WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   AND BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, BUDG_ORG_ID, ACNT_CD, BAL_DIV
		   	  ) TB
		   	  ON TA.ACNT_YY = TB.ACNT_YY
	   		  AND TA.ACNT_UNT = TB.ACNT_UNT
	   		  AND TA.BAL_DIV = TB.BAL_DIV
	   		  AND TA.BIZ_CD = TB.BIZ_CD
	   		  AND TA.BUDG_ORG_ID = TB.BUDG_ORG_ID
	   		  AND TA.ACNT_CD = TB.ACNT_CD
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.BUDG_ORG_ID, TA.ACNT_CD
    	</select>
    	
    	<select id="admiDAO.selectBg04020Tab1"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab1 사업별예산목록TAB1 - bg04020.xfdl */
		    SELECT ISNULL(TA.ACNT_YY, TB.ACNT_YY) AS ACNT_YY
			     , ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) AS ACNT_UNT
			     , ISNULL(TA.BAL_DIV, TB.BAL_DIV) AS BAL_DIV
			     , ISNULL(TA.BIZ_CD, TB.BIZ_CD) AS BIZ_CD
			     , ISNULL(TA.BIZ_CD_NM, TB.BIZ_CD_NM) AS BIZ_CD_NM
			     , ISNULL(TA.ACNT_CD_MOK_NM, TB.ACNT_CD_MOK_NM) AS ACNT_CD_MOK_NM
			     , ISNULL(TA.ACNT_CD, TB.ACNT_CD) AS ACNT_CD
			     , ISNULL(TA.ACNT_CD_NM, TB.ACNT_CD_NM) AS ACNT_CD_NM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) AS ASGN_AMT_SUM
			     , ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS EXEC_AMT_SUM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) - ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS BUDG_BAL
			     , CASE WHEN TA.ACNT_YY IS NULL THEN '1' ELSE '0' END AS GB
		    FROM (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , ISNULL(SUM(BUDG_AMT),0) AS BUDG_AMT				     
				     , ISNULL((SELECT SUM(APLY_AMT)
						     	  FROM BG_CTRL BC
						     	 WHERE BC.ACNT_YY = BA.ACNT_YY
						     	   AND BC.ACNT_UNT = BA.ACNT_UNT
						     	   AND BC.BIZ_CD = BA.BIZ_CD
						     	   AND BC.BAL_DIV = BA.BAL_DIV
		                           AND BC.ACNT_CD = BA.ACNT_CD
								    ),0) AS APLY_AMT
				  FROM BG_ASGN BA WITH(NOLOCK)
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   AND BA.BAL_DIV = #balDiv#
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.ACNT_CD, BA.BAL_DIV
		   	  ) TA
		   	 FULL OUTER JOIN
		   	  (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , 0 AS BUDG_AMT
				     , ISNULL(SUM(APLY_AMT),0) AS APLY_AMT
				  FROM BG_CTRL WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   AND BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   AND BAL_DIV = #balDiv#
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, ACNT_CD, BAL_DIV
		   	  ) TB
		   	  ON TA.ACNT_YY = TB.ACNT_YY
	   		  AND TA.ACNT_UNT = TB.ACNT_UNT
	   		  AND TA.BAL_DIV = TB.BAL_DIV
	   		  AND TA.BIZ_CD = TB.BIZ_CD
	   		  AND TA.ACNT_CD = TB.ACNT_CD
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.ACNT_CD
    	</select>
    	
    	<select id="admiDAO.selectBg04020Tab2"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab1 사업별예산목록TAB1 - bg04020.xfdl */
		    SELECT ISNULL(TA.ACNT_YY, TB.ACNT_YY) AS ACNT_YY
			     , ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) AS ACNT_UNT
			     , ISNULL(TA.BAL_DIV, TB.BAL_DIV) AS BAL_DIV
			     , ISNULL(TA.BIZ_CD, TB.BIZ_CD) AS BIZ_CD
			     , ISNULL(TA.BIZ_CD_NM, TB.BIZ_CD_NM) AS BIZ_CD_NM
			     , ISNULL(TA.BUDG_ORG_ID, TB.BUDG_ORG_ID) AS BUDG_ORG_ID
			     , ISNULL(TA.BUDG_ORG_NM, TB.BUDG_ORG_NM) AS BUDG_ORG_NM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) AS ASGN_AMT_SUM
			     , ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS EXEC_AMT_SUM
			     , ISNULL(TA.BUDG_AMT, ISNULL(TB.BUDG_AMT, 0)) - ISNULL(TA.APLY_AMT, ISNULL(TB.APLY_AMT, 0)) AS BUDG_BAL
			     , CASE WHEN TA.ACNT_YY IS NULL THEN '1' ELSE '0' END AS GB
		    FROM (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , ISNULL(SUM(BUDG_AMT),0) AS BUDG_AMT				     
				     , ISNULL((SELECT SUM(APLY_AMT)
				     	  FROM BG_CTRL BC
				     	 WHERE BC.ACNT_YY = BA.ACNT_YY
				     	   AND BC.ACNT_UNT = BA.ACNT_UNT
				     	   AND BC.BIZ_CD = BA.BIZ_CD
				     	   AND BC.BAL_DIV = BA.BAL_DIV
                           AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
                           <isNotEmpty property="acntCd">
						   AND BC.ACNT_CD = #acntCd#
						   </isNotEmpty>
						    ),0) AS APLY_AMT
				  FROM BG_ASGN BA WITH(NOLOCK)
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.BUDG_ORG_ID, BA.BAL_DIV
		   	  ) TA
		   	 FULL OUTER JOIN
		   	  (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , 0 AS BUDG_AMT
				     , ISNULL(SUM(APLY_AMT),0) AS APLY_AMT
				  FROM BG_CTRL WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   AND BIZ_CD = #bizCd#
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, BUDG_ORG_ID, BAL_DIV
		   	  ) TB
		   	  ON TA.ACNT_YY = TB.ACNT_YY
	   		  AND TA.ACNT_UNT = TB.ACNT_UNT
	   		  AND TA.BAL_DIV = TB.BAL_DIV
	   		  AND TA.BIZ_CD = TB.BIZ_CD
	   		  AND TA.BUDG_ORG_ID = TB.BUDG_ORG_ID
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.BUDG_ORG_ID
    	</select>
		
		<select id="admiDAO.selectBg04030"  parameterClass="java.util.HashMap" resultClass="egovMap">
		    /* admiDAO.selectBg04030 부서별예산목록 - bg04030.xfdl */
		    SELECT ISNULL(TA.ACNT_YY, TB.ACNT_YY) AS ACNT_YY
			     , ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) AS ACNT_UNT
			     , ISNULL(TA.BAL_DIV, TB.BAL_DIV) AS BAL_DIV
			     , ISNULL(TA.BUDG_ORG_ID, TB.BUDG_ORG_ID) AS BUDG_ORG_ID
			     , ISNULL(TA.BUDG_ORG_NM, TB.BUDG_ORG_NM) AS BUDG_ORG_NM
			     , ISNULL(TA.BIZ_CD, TB.BIZ_CD) AS BIZ_CD
			     , ISNULL(TA.BIZ_CD_NM, TB.BIZ_CD_NM) AS BIZ_CD_NM
			     , ISNULL(TA.ACNT_CD_MOK_NM, TB.ACNT_CD_MOK_NM) AS ACNT_CD_MOK_NM
			     , ISNULL(TA.ACNT_CD, TB.ACNT_CD) AS ACNT_CD
			     , ISNULL(TA.ACNT_CD_NM, TB.ACNT_CD_NM) AS ACNT_CD_NM
			     , ISNULL(TA.ASGN_AMT_SUM, ISNULL(TB.ASGN_AMT_SUM, 0)) AS ASGN_AMT_SUM
			     , ISNULL(TA.EXEC_AMT_SUM, ISNULL(TB.EXEC_AMT_SUM, 0)) AS EXEC_AMT_SUM
			     , ISNULL(TA.BUDG_BAL, TB.BUDG_BAL) AS BUDG_BAL
			     , ISNULL(TC.SLIP_AMT_SUM, 0) AS SLIP_AMT_SUM
			     , CASE WHEN TA.ACNT_YY IS NULL THEN '1' ELSE '0' END AS GB
		    FROM (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     
				     , CONVERT(BIGINT, dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')) AS ASGN_AMT_SUM
				     
				     , ISNULL(CONVERT(BIGINT, dbo.F_AC_EXEC_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0) AS EXEC_AMT_SUM
				     
				     , ISNULL((dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0)
				        -
				       ISNULL((dbo.F_AC_EXEC_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0) AS BUDG_BAL
				  FROM BG_ASGN WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
				   <isNotEmpty property="biz">
				   AND EXISTS ( SELECT 1
				                  FROM BG_BIZ
				                 WHERE BG_BIZ.BIZ_CD = BG_ASGN.BIZ_CD
				                   AND BG_BIZ.ACNT_UNT = BG_ASGN.ACNT_UNT
				                   AND ( BG_BIZ.BIZ_CD LIKE '%' + #biz# + '%'
				                        OR  BG_BIZ.BIZ_NM LIKE '%' + #biz# + '%' ) )
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, ACNT_CD, BUDG_ORG_ID, BAL_DIV
		   	  ) TA
		   	 FULL OUTER JOIN
		   	  (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(ACNT_UNT, BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '40', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(ACNT_YY, ACNT_UNT, ACNT_CD, '50', CASE WHEN BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     
				     , CONVERT(BIGINT, dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')) AS ASGN_AMT_SUM
				     
				     , ISNULL(CONVERT(BIGINT, dbo.F_AC_EXEC_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0) AS EXEC_AMT_SUM
				     
				     , ISNULL((dbo.F_AC_ASGN_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0)
				        -
				       ISNULL((dbo.F_AC_EXEC_AMT_SUM(ACNT_YY, ACNT_UNT, BUDG_ORG_ID, BIZ_CD, ACNT_CD, BAL_DIV, '')),0) AS BUDG_BAL
				  FROM BG_CTRL WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
				   <isNotEmpty property="biz">
				   AND EXISTS ( SELECT 1
				                  FROM BG_BIZ
				                 WHERE BG_BIZ.BIZ_CD = BG_CTRL.BIZ_CD
				                   AND BG_BIZ.ACNT_UNT = BG_CTRL.ACNT_UNT
				                   AND ( BG_BIZ.BIZ_CD LIKE '%' + #biz# + '%'
				                        OR  BG_BIZ.BIZ_NM LIKE '%' + #biz# + '%' ) )
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, ACNT_CD, BUDG_ORG_ID, BAL_DIV
		   	  ) TB
		   	  ON TA.ACNT_YY = TB.ACNT_YY
	   		  AND TA.ACNT_UNT = TB.ACNT_UNT
	   		  AND TA.BAL_DIV = TB.BAL_DIV
	   		  AND TA.BUDG_ORG_ID = TB.BUDG_ORG_ID
	   		  AND TA.BIZ_CD = TB.BIZ_CD
	   		  AND TA.ACNT_CD = TB.ACNT_CD
		   	 LEFT OUTER JOIN
		   	  (
			    SELECT ACNT_YY
				     , ACNT_UNT
				     , BAL_DIV
				     , BUDG_ORG_ID
				     , BIZ_CD
				     , ACNT_CD
				     , SUM(SLIP_AMT) AS SLIP_AMT_SUM
				  FROM AC_SLIP_DET WITH(NOLOCK)
				 WHERE 1=1
				   AND ACNT_YY = #acntYy#
				   AND ACNT_UNT = #acntUnt#
				   AND SLIP_CFM_DT IS NOT NULL
				   AND SLIP_CFM_DT != ''
				   <isNotEmpty property="budgOrgId">
				   AND BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND ACNT_CD = #acntCd#
				   </isNotEmpty>
				   <isNotEmpty property="biz">
				   AND EXISTS ( SELECT 1
				                  FROM BG_BIZ
				                 WHERE BG_BIZ.BIZ_CD = AC_SLIP_DET.BIZ_CD
				                   AND BG_BIZ.ACNT_UNT = AC_SLIP_DET.ACNT_UNT
				                   AND ( BG_BIZ.BIZ_CD LIKE '%' + #biz# + '%'
				                        OR  BG_BIZ.BIZ_NM LIKE '%' + #biz# + '%' ) )
				   </isNotEmpty>
		   		  GROUP BY ACNT_YY, ACNT_UNT, BIZ_CD, ACNT_CD, BUDG_ORG_ID, BAL_DIV
		   	  ) TC
		   	  ON ISNULL(TA.ACNT_YY, TB.ACNT_YY) = TC.ACNT_YY
	   		  AND ISNULL(TA.ACNT_UNT, TB.ACNT_UNT) = TC.ACNT_UNT
	   		  AND ISNULL(TA.BAL_DIV, TB.BAL_DIV) = TC.BAL_DIV
	   		  AND ISNULL(TA.BUDG_ORG_ID, TB.BUDG_ORG_ID) = TC.BUDG_ORG_ID
	   		  AND ISNULL(TA.BIZ_CD, TB.BIZ_CD) = TC.BIZ_CD
	   		  AND ISNULL(TA.ACNT_CD, TB.ACNT_CD) = TC.ACNT_CD
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.BUDG_ORG_ID, TA.ACNT_CD
   		  
    	</select>
    	
		<select id="admiDAO.selectBg04040"  parameterClass="java.util.HashMap" resultClass="egovMap">
		    /* admiDAO.selectBg04040 예산별관리부서 - bg04040.xfdl */
			    SELECT A.ACNT_YY
				     , A.ACNT_UNT
				     , A.BAL_DIV
				     , A.BUDG_ORG_ID
				     , MAX(B.DEPT_NM_KOR) AS BUDG_ORG_NM
				     , MAX(C.DEPT_NM_KOR) AS UP_DEPT_NM
				     , A.BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(A.ACNT_UNT, A.BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(A.ACNT_YY, A.ACNT_UNT, A.ACNT_CD, '40', CASE WHEN A.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , A.ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(A.ACNT_YY, A.ACNT_UNT, A.ACNT_CD, '50', CASE WHEN A.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , CONVERT(BIGINT, dbo.F_AC_ASGN_AMT_SUM(A.ACNT_YY, A.ACNT_UNT, A.BUDG_ORG_ID, A.BIZ_CD, A.ACNT_CD, A.BAL_DIV, '')) AS ASGN_AMT_SUM
				     , ISNULL(CONVERT(BIGINT, dbo.F_AC_EXEC_AMT_SUM(A.ACNT_YY, A.ACNT_UNT, A.BUDG_ORG_ID, A.BIZ_CD, A.ACNT_CD, A.BAL_DIV, '')),0) AS EXEC_AMT_SUM
				     , ISNULL((dbo.F_AC_ASGN_AMT_SUM(A.ACNT_YY, A.ACNT_UNT, A.BUDG_ORG_ID, A.BIZ_CD, A.ACNT_CD, A.BAL_DIV, '')),0)
				        -
				       ISNULL((dbo.F_AC_EXEC_AMT_SUM(A.ACNT_YY, A.ACNT_UNT, A.BUDG_ORG_ID, A.BIZ_CD, A.ACNT_CD, A.BAL_DIV, '')),0) AS BUDG_BAL
				  FROM BG_ASGN A WITH(NOLOCK)
				    LEFT OUTER JOIN VW_COMM_DEPT_ALL B
				     ON A.BUDG_ORG_ID = B.DEPT_CD
				    LEFT OUTER JOIN VW_COMM_DEPT_ALL C
				     ON B.UP_DEPT_CD = C.DEPT_CD
				 WHERE 1=1
				   AND A.ACNT_YY = #acntYy#
				   AND A.ACNT_UNT = #acntUnt#
				   <isNotEmpty property="budgOrgId">
				   AND A.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND A.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND A.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY A.ACNT_YY, A.ACNT_UNT, A.BIZ_CD, A.ACNT_CD, A.BUDG_ORG_ID, A.BAL_DIV
		   	  
	   		  ORDER BY A.BAL_DIV, A.BIZ_CD, A.BUDG_ORG_ID, A.ACNT_CD
   		  
    	</select>
    	
    	
    	<select id="admiDAO.selectBg04030Tab0"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04030Tab0 부서별예산목록TAB0 - bg04030.xfdl */
    		  SELECT ACNT_UNT
		            ,ACNT_YY
		            ,BIZ_CD
		            ,ACNT_CD
		            ,BUDG_ORG_ID
		            ,BAL_DIV
		            ,BUDG_YYMM
		            ,BUDG_SEQ
		            ,BUDG_CD
		            ,ADJ_ORD_CD
		            ,BUDG_AMT
		            ,ITM_SEQ
		            ,CFM_DT
		            ,CHG_SEQ
			    FROM BG_ASGN WITH(NOLOCK)
			   WHERE ACNT_UNT    = #acntUnt#
		         AND ACNT_YY     = #acntYy#
		         AND BIZ_CD      = #bizCd#
		         AND ACNT_CD     = #acntCd#
		         AND BUDG_ORG_ID = #budgOrgId#
		         AND BAL_DIV     = #balDiv#
		         ORDER BY ACNT_YY
		            ,ACNT_UNT
		            ,BIZ_CD
		            ,ACNT_CD
		            ,BUDG_ORG_ID
		            ,BAL_DIV
		            ,BUDG_SEQ
		            ,BUDG_YYMM
		            ,CHG_SEQ
    	</select>
    	
    	<select id="admiDAO.selectBg04030Tab1"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04030Tab1 부서별예산목록TAB1 - bg04030.xfdl */
    		SELECT A.ACNT_UNT
			      ,A.ACNT_YY
			      ,A.BIZ_CD
			      ,A.ACNT_CD
			      ,A.BUDG_ORG_ID
			      ,A.BAL_DIV
			      ,A.CTRL_SEQ
			      ,A.VOU_NO
			      ,A.VOU_SEQ
			      ,A.APLY_AMT
			      ,A.CTRL_YN
			      ,A.CTRL_DT
			      ,A.WORK_DIV
			      ,CASE WHEN A.WORK_DIV = '1' THEN '일반기안'
			            WHEN A.WORK_DIV = '2' THEN '물품구매'
			            WHEN A.WORK_DIV = '3' THEN '수리 및 업그레이드'
			            WHEN A.WORK_DIV = '4' THEN '실험실습비'
			            WHEN A.WORK_DIV = '5' THEN '여비지출'
			            ELSE ''
			            END AS WORK_DIV_NM
			      ,A.CTRL_DESC
			      ,dbo.F_COM_CODE_NM('AC002', B.STA_CD, '') AS STA_NM
			      ,A.INIT_AMT
			 FROM BG_CTRL A WITH(NOLOCK)
			 LEFT OUTER JOIN AC_VOU B
			   ON A.ACNT_UNT = B.ACNT_UNT
			   AND A.ACNT_YY = B.ACNT_YY
			   AND A.VOU_NO = B.VOU_NO
			 WHERE A.ACNT_UNT    = #acntUnt#
		       AND A.ACNT_YY     = #acntYy#
		       AND A.BIZ_CD      = #bizCd#
		       AND A.ACNT_CD     = #acntCd#
		       AND A.BUDG_ORG_ID = #budgOrgId#
		       AND A.BAL_DIV     = #balDiv#
			 ORDER BY A.ACNT_UNT
		             ,A.ACNT_YY
		             ,A.BIZ_CD
		             ,A.ACNT_CD
		             ,A.BUDG_ORG_ID
		             ,A.BAL_DIV
		             ,A.CTRL_SEQ
    	</select>
    
		<select id="admiDAO.selectBg04050"  parameterClass="java.util.HashMap" resultClass="egovMap">
		    /* admiDAO.selectBg04050 사업별예산신청목록 - bg04050.xfdl */
		    SELECT TA.ACNT_YY AS ACNT_YY
			     , TA.ACNT_UNT AS ACNT_UNT
			     , TA.BUDG_CD AS BUDG_CD
			     , TA.BAL_DIV AS BAL_DIV
			     , TA.BIZ_CD AS BIZ_CD
			     , TA.BIZ_CD_NM AS BIZ_CD_NM
			     , TA.BUDG_AMT AS ASGN_AMT_SUM
		    FROM (
			    SELECT BA.ACNT_YY
				     , BA.ACNT_UNT
				     , BA.BUDG_CD
				     , BA.BAL_DIV
				     , BA.BIZ_CD
				     , BB.BIZ_NM AS BIZ_CD_NM		     
				     , ISNULL(SUM(BA.BUDG_AMT),0) AS BUDG_AMT				     
				  FROM BG_FRMN_DET BA WITH(NOLOCK)
				   LEFT OUTER JOIN BG_BIZ BB
				     ON   BA.ACNT_UNT = BB.ACNT_UNT
				      AND BA.BIZ_CD = BB.BIZ_CD
				   LEFT OUTER JOIN BG_ORG_BIZ BC
				     ON BC.ACNT_UNT = BA.ACNT_UNT
					AND BC.ACNT_YY = BA.ACNT_YY
					AND BC.BAL_DIV = BA.BAL_DIV
					AND BC.BIZ_CD = BA.BIZ_CD
					AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BUDG_CD = #budgCd#
				   <isNotEmpty property="bizNm">
				   AND (   BA.BIZ_CD LIKE '%' + #bizNm# + '%'
				        OR BB.BIZ_NM LIKE '%' + #bizNm# + '%' )
				   </isNotEmpty>
				   <isNotEmpty property="bizCd">
				   AND BA.BIZ_CD = #bizCd#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
				   AND BA.ADJ_ORD_CD = '101'
				   AND BC.STA_CD != '10'
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BUDG_CD, BA.BIZ_CD, BB.BIZ_NM, BA.BAL_DIV
		   	  ) TA   
		   	  ORDER BY TA.BIZ_CD, TA.BAL_DIV 		  
    	</select>
    	
    	<select id="admiDAO.selectBg04050Tab0"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab0 사업별예산목록TAB0 - bg04020.xfdl */
		    SELECT TA.ACNT_YY AS ACNT_YY
			     , TA.ACNT_UNT AS ACNT_UNT
			     , TA.BAL_DIV AS BAL_DIV
			     , TA.BIZ_CD AS BIZ_CD
			     , TA.BIZ_CD_NM AS BIZ_CD_NM
			     , TA.BUDG_ORG_ID AS BUDG_ORG_ID
			     , TA.BUDG_ORG_NM AS BUDG_ORG_NM
			     , TA.ACNT_CD_MOK_NM AS ACNT_CD_MOK_NM
			     , TA.ACNT_CD AS ACNT_CD
			     , TA.ACNT_CD_NM AS ACNT_CD_NM
			     , TA.BUDG_AMT
		    FROM (
			    SELECT BA.ACNT_YY
				     , BA.ACNT_UNT
				     , BA.BAL_DIV
				     , BA.BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(BA.ACNT_UNT, BA.BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , BA.BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BA.BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , dbo.F_AC_GET_ACNT_INFO(BA.ACNT_YY, BA.ACNT_UNT, BA.ACNT_CD, '40', CASE WHEN BA.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , BA.ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(BA.ACNT_YY, BA.ACNT_UNT, BA.ACNT_CD, '50', CASE WHEN BA.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , ISNULL(SUM(BA.BUDG_AMT),0) AS BUDG_AMT
				  FROM BG_FRMN_DET BA WITH(NOLOCK)
				  LEFT OUTER JOIN BG_ORG_BIZ BC
				     ON BC.ACNT_UNT = BA.ACNT_UNT
					AND BC.ACNT_YY = BA.ACNT_YY
					AND BC.BAL_DIV = BA.BAL_DIV
					AND BC.BIZ_CD = BA.BIZ_CD
					AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   AND BA.BUDG_CD = #budgCd#
				   AND BA.ADJ_ORD_CD = '101'
				   AND BC.STA_CD != '10'
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.BUDG_ORG_ID, BA.ACNT_CD, BA.BAL_DIV
		   	  ) TA
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.BUDG_ORG_ID, TA.ACNT_CD
    	</select>
    	
    	<select id="admiDAO.selectBg04050Tab1"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab1 사업별예산목록TAB1 - bg04020.xfdl */
		    SELECT TA.ACNT_YY AS ACNT_YY
			     , TA.ACNT_UNT AS ACNT_UNT
			     , TA.BAL_DIV AS BAL_DIV
			     , TA.BIZ_CD AS BIZ_CD
			     , TA.BIZ_CD_NM AS BIZ_CD_NM
			     , TA.ACNT_CD_MOK_NM AS ACNT_CD_MOK_NM
			     , TA.ACNT_CD AS ACNT_CD
			     , TA.ACNT_CD_NM AS ACNT_CD_NM
			     , TA.BUDG_AMT
		    FROM (
			    SELECT BA.ACNT_YY
				     , BA.ACNT_UNT
				     , BA.BAL_DIV
				     , BA.BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(BA.ACNT_UNT, BA.BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , dbo.F_AC_GET_ACNT_INFO(BA.ACNT_YY, BA.ACNT_UNT, BA.ACNT_CD, '40', CASE WHEN BA.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_MOK_NM
				     , BA.ACNT_CD
				     , dbo.F_AC_GET_ACNT_INFO(BA.ACNT_YY, BA.ACNT_UNT, BA.ACNT_CD, '50', CASE WHEN BA.BAL_DIV = '10' THEN 'ACNT_INC_NM' ELSE 'ACNT_EXP_NM' END) AS ACNT_CD_NM
				     , ISNULL(SUM(BA.BUDG_AMT),0) AS BUDG_AMT
				  FROM BG_FRMN_DET BA WITH(NOLOCK)
				  LEFT OUTER JOIN BG_ORG_BIZ BC
				     ON BC.ACNT_UNT = BA.ACNT_UNT
					AND BC.ACNT_YY = BA.ACNT_YY
					AND BC.BAL_DIV = BA.BAL_DIV
					AND BC.BIZ_CD = BA.BIZ_CD
					AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   AND BA.BUDG_CD = #budgCd#
				   AND BA.ADJ_ORD_CD = '101'
				   AND BC.STA_CD != '10'
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   AND BA.BAL_DIV = #balDiv#
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.ACNT_CD, BA.BAL_DIV
		   	  ) TA
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.ACNT_CD
    	</select>
    	
    	<select id="admiDAO.selectBg04050Tab2"  parameterClass="java.util.HashMap" resultClass="egovMap">
    		/* admiDAO.selectBg04020Tab1 사업별예산목록TAB1 - bg04020.xfdl */
		    SELECT TA.ACNT_YY AS ACNT_YY
			     , TA.ACNT_UNT AS ACNT_UNT
			     , TA.BAL_DIV AS BAL_DIV
			     , TA.BIZ_CD AS BIZ_CD
			     , TA.BIZ_CD_NM AS BIZ_CD_NM
			     , TA.BUDG_ORG_ID AS BUDG_ORG_ID
			     , TA.BUDG_ORG_NM AS BUDG_ORG_NM
			     , TA.BUDG_AMT
		    FROM (
			    SELECT BA.ACNT_YY
				     , BA.ACNT_UNT
				     , BA.BAL_DIV
				     , BA.BUDG_ORG_ID
				     ,(SELECT dbo.F_COM_DEPT_NM(BA.BUDG_ORG_ID, 'DEPT_NM_KOR')) AS BUDG_ORG_NM
				     , BA.BIZ_CD
				     , dbo.F_AC_GET_BIZ_NM(BA.ACNT_UNT, BA.BIZ_CD, 'BIZ_NM') AS BIZ_CD_NM
				     , ISNULL(SUM(BA.BUDG_AMT),0) AS BUDG_AMT
				  FROM BG_FRMN_DET BA WITH(NOLOCK)
				  LEFT OUTER JOIN BG_ORG_BIZ BC
				     ON BC.ACNT_UNT = BA.ACNT_UNT
					AND BC.ACNT_YY = BA.ACNT_YY
					AND BC.BAL_DIV = BA.BAL_DIV
					AND BC.BIZ_CD = BA.BIZ_CD
					AND BC.BUDG_ORG_ID = BA.BUDG_ORG_ID
				 WHERE BA.ACNT_YY = #acntYy#
				   AND BA.ACNT_UNT = #acntUnt#
				   AND BA.BIZ_CD = #bizCd#
				   AND BA.BUDG_CD = #budgCd#
				   AND BA.ADJ_ORD_CD = '101'
				   AND BC.STA_CD != '10'
				   <isNotEmpty property="budgOrgId">
				   AND BA.BUDG_ORG_ID = #budgOrgId#
				   </isNotEmpty>
				   <isNotEmpty property="balDiv">
				   AND BA.BAL_DIV = #balDiv#
				   </isNotEmpty>
				   <isNotEmpty property="acntCd">
				   AND BA.ACNT_CD = #acntCd#
				   </isNotEmpty>
		   		  GROUP BY BA.ACNT_YY, BA.ACNT_UNT, BA.BIZ_CD, BA.BUDG_ORG_ID, BA.BAL_DIV
		   	  ) TA
	   		  ORDER BY TA.BAL_DIV, TA.BIZ_CD, TA.BUDG_ORG_ID
    	</select>
    
    <select id="admiDAO.selectBgAcntDeptList"  parameterClass="java.util.HashMap" resultClass="egovMap">
		/* admiDAO.selectBgAcntDeptList 부서별예산관리부서등록 조회 */
        SELECT '' AS CHK
              ,'' AS ROW_STATUS
              ,A.ACNT_UNT
		      ,A.ACNT_YY
		      ,A.BUDG_ORG_ID
		      ,A.BAL_DIV
		      ,A.BIZ_CD
		      ,A.ACNT_CD
		      ,A.MGT_ORG_ID
		      ,A.MGT_ORG_ID AS MGT_ORG_ID_KEY
		      ,B.DEPT_NM_KOR AS MGT_ORG_NM
		      ,C.DEPT_NM_KOR AS UP_DEPT_NM
		  FROM BG_ACNT_DEPT A WITH(NOLOCK)
		     LEFT OUTER JOIN VW_COMM_DEPT_ALL B 
		       ON A.MGT_ORG_ID = B.DEPT_CD
		     LEFT OUTER JOIN VW_COMM_DEPT_ALL C
		       ON B.UP_DEPT_CD = C.DEPT_CD 
		 WHERE ACNT_UNT		= #acntUnt#
		   AND ACNT_YY      = #acntYy#
		   AND BUDG_ORG_ID  = #budgOrgId#
		   AND BAL_DIV      = #balDiv#
		   AND BIZ_CD       = #bizCd#
		   AND ACNT_CD      = #acntCd#
    </select>
    
    <insert id="admiDAO.insertBgAcntDeptList" parameterClass="java.util.HashMap">
    	/* admiDAO.insertBgAcntDeptList  부서별예산관리부서등록 저장 */
    	INSERT INTO BG_ACNT_DEPT
    				(
    				 ACNT_UNT
					,ACNT_YY
					,BUDG_ORG_ID
					,BAL_DIV
					,BIZ_CD
					,ACNT_CD
					,MGT_ORG_ID
					,INSERT_DT
					,INSERT_ID
					,INSERT_IP
					,INSERT_PGM
    				)
    				VALUES
    				(
    				 #acntUnt#
					,#acntYy#
					,#budgOrgId#
					,#balDiv#
					,#bizCd#
					,#acntCd#
					,#mgtOrgId#
					,GETDATE()
					,#insertId#
					,#insertIp#
					,#insertPgm#
    				)
    
    </insert>
    
    <update id="admiDAO.updateBgAcntDeptList" parameterClass="java.util.HashMap">
    	/* admiDAO.updateBgAcntDeptList 부서별예산관리부서등록 수정 */
    	UPDATE BG_ACNT_DEPT
    	   SET MGT_ORG_ID   = #mgtOrgId#
    	 WHERE ACNT_UNT		= #acntUnt#
		   AND ACNT_YY      = #acntYy#
		   AND BUDG_ORG_ID  = #budgOrgId#
		   AND BAL_DIV      = #balDiv#
		   AND BIZ_CD       = #bizCd#
		   AND ACNT_CD      = #acntCd# 
		   AND MGT_ORG_ID   = #mgtOrgIdKey# 
    </update>
    
    <delete id="admiDAO.deleteBgAcntDeptList" parameterClass="java.util.HashMap">
    	/* admiDAO.deleteBgAcntDeptList 부서별예산관리부서등록 삭제 */
    	DELETE
    	  FROM BG_ACNT_DEPT
    	 WHERE ACNT_UNT		= #acntUnt#
		   AND ACNT_YY      = #acntYy#
		   AND BUDG_ORG_ID  = #budgOrgId#
		   AND BAL_DIV      = #balDiv#
		   AND BIZ_CD       = #bizCd#
		   AND ACNT_CD      = #acntCd# 
		   AND MGT_ORG_ID   = #mgtOrgId# 
    </delete>
    
    <insert id="admiDAO.insertBgBudgCdCopy" parameterClass="java.util.HashMap">
    	/* admiDAO.insertBgBudgCdCopy 편성예산관리 선택된 예산구분을 다음 예산변경으로 복사  */
    	
    	BEGIN
    	
    	DELETE 
    	  FROM BG_FRMN_SCHED
    	 WHERE ACNT_YY  = #acntYy#
		   AND BUDG_CD  = #budgCd#

	    DELETE 
    	  FROM BG_FRMN_DET
    	 WHERE ACNT_YY  = #acntYy#
		   AND BUDG_CD  = #budgCd#                      
    	
    	DELETE 
    	  FROM BG_FRMN
    	 WHERE ACNT_YY  = #acntYy#
		   AND BUDG_CD  = #budgCd#
    	
    	DELETE 
    	  FROM BG_ORG_BIZ
    	 WHERE ACNT_YY  = #acntYy#
		   AND BUDG_CD  = #budgCd#
    	
    	INSERT INTO BG_ORG_BIZ
    	       	    (
    	       	     ACNT_UNT
				    ,ACNT_YY
				    ,BUDG_ORG_ID
				    ,BAL_DIV
				    ,BIZ_CD
				    ,BUDG_CD
				    ,STA_CD
    	       	    )
    	       	    SELECT ACNT_UNT
						  ,ACNT_YY
						  ,BUDG_ORG_ID
						  ,BAL_DIV
						  ,BIZ_CD
						  ,#budgCd# AS BUDG_CD
						  ,'10' AS STA_CD
					 FROM BG_ORG_BIZ WITH(NOLOCK)
					WHERE ACNT_YY  = #acntYy#
					  AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END
		
			INSERT INTO BG_FRMN
						(
						ACNT_UNT
				       ,ACNT_YY
				       ,BUDG_ORG_ID
				       ,BAL_DIV
				       ,BIZ_CD
				       ,BUDG_CD
				       ,ACNT_CD
				       ,ADJ_ORD_CD
				       ,BUDG_AMT
						)
						SELECT ACNT_UNT
						      ,ACNT_YY
						      ,BUDG_ORG_ID
						      ,BAL_DIV
						      ,BIZ_CD
						      ,#budgCd# AS BUDG_CD
						      ,ACNT_CD
						      ,'101' AS ADJ_ORD_CD
						      ,BUDG_AMT
						 FROM BG_FRMN WITH(NOLOCK)
					    WHERE ACNT_YY  = #acntYy#
					      AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END
					      AND ADJ_ORD_CD = (SELECT MAX(ADJ_ORD_CD) 
					                          FROM BG_FRMN WITH(NOLOCK)
					                         WHERE ACNT_YY  = #acntYy#
					                           AND ACNT_UNT = #acntUnt#
					                           AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END )
				   
			INSERT INTO BG_FRMN_DET
						(
						ACNT_UNT
				       ,ACNT_YY
				       ,BUDG_ORG_ID
				       ,BAL_DIV
				       ,BIZ_CD
				       ,BUDG_CD
				       ,ACNT_CD
				       ,ADJ_ORD_CD
				       ,SEQ
				       ,ITM_SEQ
				       ,BUDG_AMT
				       ,ITM_NM
				       ,CALC_BSS
				       ,PRE_BUDG_AMT
						)
						SELECT ACNT_UNT
						      ,ACNT_YY
						      ,BUDG_ORG_ID
						      ,BAL_DIV
						      ,BIZ_CD
						      ,#budgCd# AS BUDG_CD
						      ,ACNT_CD
						      ,'101' AS ADJ_ORD_CD
						      ,SEQ
						      ,ITM_SEQ
						      ,BUDG_AMT
						      ,ITM_NM
						      ,CALC_BSS
						      ,BUDG_AMT
						 FROM BG_FRMN_DET WITH(NOLOCK)
					    WHERE ACNT_YY  = #acntYy#
					      AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END
					      AND ADJ_ORD_CD = (SELECT MAX(ADJ_ORD_CD) 
					                          FROM BG_FRMN_DET WITH(NOLOCK)
					                         WHERE ACNT_YY  = #acntYy#
					                           AND ACNT_UNT = #acntUnt#
					                           AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END )
			INSERT INTO BG_FRMN_SCHED
						(
						ACNT_UNT
				       ,ACNT_YY
				       ,BUDG_ORG_ID
				       ,BAL_DIV
				       ,BIZ_CD
				       ,BUDG_CD
				       ,ACNT_CD
				       ,ADJ_ORD_CD
				       ,SEQ
				       ,BUDG_YYMM
				       ,BUDG_AMT
						)
						SELECT ACNT_UNT
						      ,ACNT_YY
						      ,BUDG_ORG_ID
						      ,BAL_DIV
						      ,BIZ_CD
						      ,#budgCd# AS BUDG_CD
						      ,ACNT_CD
						      ,'101' AS ADJ_ORD_CD
						      ,SEQ
						      ,BUDG_YYMM
						      ,BUDG_AMT
						 FROM BG_FRMN_SCHED WITH(NOLOCK)
					    WHERE ACNT_YY  = #acntYy#
					      AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END
					      AND ADJ_ORD_CD = (SELECT MAX(ADJ_ORD_CD) 
					                          FROM BG_FRMN_SCHED WITH(NOLOCK)
					                         WHERE ACNT_YY  = #acntYy#
					                           AND ACNT_UNT = #acntUnt#
					                           AND BUDG_CD  = CASE WHEN #budgCd# = '20' THEN '10' ELSE '20' END )
			END				                           					                           						  		  
    	
    	
    </insert>
    
    
    <parameterMap id="SP_BG_CREATE_param" class="java.util.HashMap">
        <parameter property="acntYy"  jdbcType="VARCHAR" javaType="java.lang.String" mode="IN" /> 
        <parameter property="OUT_CNT" jdbcType="INTEGER" javaType="java.lang.Integer" resultMap="result" mode="OUT" /> 
        <parameter property="OUT_MSG" jdbcType="VARCHAR" javaType="java.lang.String" resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.SP_BG_CREATE" parameterMap = "SP_BG_CREATE_param"> 
           {call dbo.SP_BG_CREATE(?, ?, ?)}              
    </procedure>
    
    
    <parameterMap id="spAcPurcBudgParam" class="java.util.HashMap">
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcPurcBudg" parameterMap = "spAcPurcBudgParam"> 
           {call dbo.SP_AC_PURC_BUDG(?, ?)}              
    </procedure>
    
    <parameterMap id="spDeuOraMssqlChgChk" class="java.util.HashMap">
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpDeuOraMssqlChgChk" parameterMap = "spDeuOraMssqlChgChk"> 
           {call dbo.SP_DEU_ORA_MSSQL_CHG_CHK(?,?)}  
    </procedure>
    
    <parameterMap id="saveSpAcPurcVouCreateParam" class="java.util.HashMap">
		<parameter property="IN_ID"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
		<parameter property="IN_WORK_DIV"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
		<parameter property="IN_ORDER_YN"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="IN_USER_ID"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="IN_IP"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcPurcVouCreate" parameterMap = "saveSpAcPurcVouCreateParam"> 
           {call dbo.SP_AC_PURC_VOU_CREATE(?, ?, ?, ?, ?, ?, ?)}              
    </procedure>
    
    <parameterMap id="saveSpAcPurcVouCancelParam" class="java.util.HashMap">
		<parameter property="IN_LINK_ID"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
		<parameter property="IN_WORK_DIV"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcPurcVouCancel" parameterMap = "saveSpAcPurcVouCancelParam"> 
           {call dbo.SP_AC_PURC_VOU_CANCEL(?, ?, ?, ?)}              
    </procedure>
    
    <parameterMap id="saveSpAcPurcBudgDeptParam" class="java.util.HashMap">
		<parameter property="IN_DEPT_CD"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcPurcBudgDept" parameterMap = "saveSpAcPurcBudgDeptParam"> 
           {call dbo.SP_AC_PURC_BUDG_DEPT(?, ?, ?)}              
    </procedure>
    
    <parameterMap id="saveSpAcPurcBudgDeptParam_recv" class="java.util.HashMap">
		<parameter property="IN_DEPT_CD"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcPurcBudgDept_recv" parameterMap = "saveSpAcPurcBudgDeptParam_recv"> 
           {call dbo.SP_AC_PURC_BUDG_DEPT(?, ?, ?)}              
    </procedure>
    
    <parameterMap id="saveSpAcTripVouCreateParam" class="java.util.HashMap">
		<parameter property="IN_ID"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="IN_USER_ID"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="IN_IP"      jdbcType="VARCHAR"          javaType="java.lang.String" mode="IN" />
        <parameter property="V_OUT_CNT"          jdbcType="VARCHAR"          javaType="java.lang.String"    resultMap="result" mode="OUT" /> 
        <parameter property="V_OUT_MSG"          jdbcType="VARCHAR"          javaType="java.lang.String"     resultMap="result" mode="OUT" />
   </parameterMap>
   
    <procedure id="admiDAO.saveSpAcTripVouCreate" parameterMap = "saveSpAcTripVouCreateParam"> 
           {call dbo.SP_AC_TRIP_VOU_CREATE(?, ?, ?, ?, ?)}              
    </procedure>
		
		
    <select id="admiDAO.selectBudgChgAplyCnt"  parameterClass="java.util.HashMap" resultClass="egovMap">
        SELECT COUNT(1) AS CNT
             , SUM(CASE WHEN A.ACNT_UNT = '10' AND A.CHG_DIV = '10' THEN 1 ELSE 0 END) AS T1
             , SUM(CASE WHEN A.ACNT_UNT = '10' AND A.CHG_DIV = '20' THEN 1 ELSE 0 END) AS T2
             , SUM(CASE WHEN A.ACNT_UNT = '20' AND A.CHG_DIV = '10' THEN 1 ELSE 0 END) AS T3
             , SUM(CASE WHEN A.ACNT_UNT = '20' AND A.CHG_DIV = '20' THEN 1 ELSE 0 END) AS T4
		  FROM BG_CHG_APLY A WITH(NOLOCK)
		 WHERE A.STA_CD = '50' 
    </select>
</sqlMap>